(self["webpackChunk_zoom_client_email_desktop"]=self["webpackChunk_zoom_client_email_desktop"]||[]).push([[841,667,465,168,280,915],{44280:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return d}});var n=function(){var e=this,t=e._self._c;return t("zm-dialog",{ref:"dialog",attrs:{visible:e.isVisible,title:e.title,"close-on-click-modal":!0,"append-to-body":!0,"close-on-press-escape":!0},on:{"update:visible":function(t){e.isVisible=t},close:e.onCancel}},[t("zm-form",{ref:"expirationForm",attrs:{inline:"","label-width":"100px","label-position":"top"}},[t("p",[e._v(" "+e._s(e.$t("editor.expirationFormTip"))+" ")]),t("div",{staticClass:"dialog-body"},[t("label",{attrs:{id:"set-expiration"}},[e._v(e._s(e.$t("expiration.setExpiration")))]),t("zm-select",{staticClass:"select-self-dark-mode size zm-select",attrs:{label:e.$t("expiration.setExpiration"),size:"large",popperClass:"select-dark-mode","label-by":"set-expiration","zm-ta":"password-protection-expiration-select"},model:{value:e.expiration,callback:function(t){e.expiration=t},expression:"expiration"}},e._l(e.durationOptions,(function(i){return t("zm-option",{key:i.value,attrs:{label:i.label,value:i.value,disabled:i.disabled,"zm-ta":"password-protection-expiration-select"+i.value},nativeOn:{click:function(t){return e.reportMetric(i)}}})})),1)],1)]),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"footer-left"},[e.ruleActive?t("zm-button",{attrs:{plain:"","zm-ta":"password-protection-remove"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onRemove.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("operation.remove"))+" ")]):e._e()],1),t("div",[t("zm-button",{attrs:{type:"secondary","zm-ta":"password-protection-cancel"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onCancel.apply(null,arguments)}}},[e._v(" "+e._s(e.cancelText||e.$t("operation.cancel"))+" ")]),t("zm-button",{attrs:{type:"primary","zm-ta":"password-protection-save"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.submitForm.apply(null,arguments)}}},[e._v(e._s(e.okText||e.$t("operation.save"))+" ")])],1)])],1)},s=[],a=i(37761),r={name:"ExpirationDialog",props:{title:String,defaultExpiration:{type:Number,default:2592e3},okText:{type:String,default:""},cancelText:{type:String,default:""},show:{type:Boolean,default:!1},ruleActive:{type:Boolean,default:!1}},data:function(){return{expiration:this.defaultExpiration,isVisible:!1,durationOptions:[{label:this.$t("time.oneDay"),value:86400},{label:this.$t("time.oneWeek"),value:604800},{label:this.$t("time.oneMonth"),value:2592e3}]}},computed:{header:function(){return(0,a.upperFirst)(this.title||"")}},watch:{show:function(e){this.isVisible=e,this.expiration=this.defaultExpiration}},methods:{reset:function(){this.expiration=this.defaultExpiration},onRemove:function(){this.$emit("onRemove"),this.$metric.report("remove_password_protection")},onCancel:function(){this.reset(),this.$emit("onCancel"),this.$metric.report("cancel_password_protection")},submitForm:function(){this.$emit("onOk",this.expiration),this.$metric.report("create_password_protection")},reportMetric:function(e){86400===e.value?this.$metric.report("password_protection_one_day"):604800===e.value?this.$metric.report("password_protection_one_week"):2592e3===e.value&&this.$metric.report("password_protection_one_month")}}},o=r,l=i(93483),c=(0,l.Z)(o,n,s,!1,null,"06911bf8",null),d=c.exports},42915:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return u}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"expiration-alert-container"},[t("zm-alert",{directives:[{name:"show",rawName:"v-show",value:e.showExpirationBanner,expression:"showExpirationBanner"}],class:["alert",{"alert-subitems":e.hasComposeSubItems}],attrs:{center:""},on:{close:e.emitClosed}},[t("div",{staticClass:"alert-body"},[t("svg-icon",{staticClass:"alert-icon",attrs:{"aria-hidden":!0,iconClass:"locked-outlined"}}),t("div",{staticClass:"alert-body-content"},[e._v(" "+e._s(e.$t("editor.expirationBanner",[e.getExpDate(e.expirationSeconds)]))+" "),t("zm-button",{staticClass:"edit-button",attrs:{"aria-label":e.$t("accessibility.editPasswordProtection"),type:"link",tabindex:"0"},on:{click:function(t){return t.preventDefault(),e.emitEdit.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("operation.edit"))+" ")])],1)],1)])],1)},s=[],a=i(34948),r=i(29648),o={name:"ExpirationBanner",props:{showExpirationBanner:{type:Boolean,default:!1},expirationSeconds:{type:Number,default:2592e3},hasComposeSubItems:{type:Boolean,default:!1}},data:function(){return{durationOptions:{86400:this.$t("time.oneDay"),604800:this.$t("time.oneWeek"),2592e3:this.$t("time.oneMonth")}}},computed:(0,a.Z)({},(0,r.rn)({userTimeZone:function(e){return e.userProfile.userTimeZone}})),methods:{getExpDate:function(e){return this.durationOptions[e]},emitEdit:function(){this.$emit("edit"),this.$metric.report("edit_password_protection")},emitClosed:function(){this.$emit("closed"),this.$metric.report("remove_password_protection")}}},l=o,c=i(93483),d=(0,c.Z)(l,n,s,!1,null,"7a1f9f2e",null),u=d.exports},40547:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return da}});var n,s=function(){var e=this,t=e._self._c;return t("div",[e.showBanner?t("vacation-responder-banner"):e._e(),t("div",{staticClass:"tab-focus",attrs:{id:"newUI"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.handleTab.apply(null,arguments)}}},[t("div",{staticClass:"mail"},[t("ThreadDragImage"),t("div",{class:["mail-left",e.isMinimized&&"minimized",e.showBanner&&"has-banner"],style:{width:e.sidebarMenuWidth+"px"},on:{contextmenu:e.closeInboxContextMenu}},[t("div",{class:["mail-left-container",{tabed:e.tabed}]},[t("div",{staticClass:"mail-left-header"},[t("mail-logo",{directives:[{name:"show",rawName:"v-show",value:!e.isMinimized,expression:"!isMinimized"}]}),t("shortcut-reminder",{attrs:{preTooltip:e.$t("compose.compose"),shortcutKey:"compose"}},[t("zm-button",{staticClass:"mail-left-compose",attrs:{"aria-label":e.$t("compose.compose"),"zm-ta":"sidebar-open-compose",tabindex:"0"},on:{click:e.openCompose}},[t("svg-icon",{attrs:{iconClass:"edit"}})],1)],1)],1),t("div",{staticClass:"mail-left-label-wrap",attrs:{role:"navigation"}},[t("system-labels",{attrs:{isMinimized:e.isMinimized},on:{handleSelectLabel:e.handleSelectLabel}}),t("div",{staticClass:"mail-left-label-divider"}),t("user-labels",{attrs:{isMinimized:e.isMinimized},on:{handleSelectLabel:e.handleSelectLabel}})],1)])]),t("div",{staticClass:"mail-divider"},[t("div",{staticClass:"mail-divider-container"},[t("zm-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.isMinimized,expression:"isMinimized"}],attrs:{disabled:!e.isMinimized,content:e.$t("common.expand"),placement:"right",enterable:!1}},[t("span",{class:["toggle-minimize-action","tab-focus"],attrs:{tabindex:"0","zm-ta":"sidebar-toggle-min",role:"button","aria-label":e.$t("common.expand")},on:{click:e.toggleMinimize,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.toggleMinimize.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.toggleMinimize.apply(null,arguments)}]}},[t("svg-icon",{attrs:{iconClass:"maximize-triangle"}})],1)]),t("zm-tooltip",{directives:[{name:"show",rawName:"v-show",value:!e.isMinimized,expression:"!isMinimized"}],attrs:{disabled:e.isMinimized,content:e.$t("common.minimize"),placement:"right",enterable:!1}},[t("span",{class:["toggle-minimize-action","tab-focus"],attrs:{tabindex:"0","zm-ta":"sidebar-toggle-max",role:"button","aria-label":e.$t("common.minimize")},on:{click:e.toggleMinimize,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.toggleMinimize.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.toggleMinimize.apply(null,arguments)}]}},[t("svg-icon",{attrs:{iconClass:"minimize-triangle"}})],1)])],1)]),t("div",{class:["mail-right",e.showBanner&&"has-banner"],attrs:{id:"mail-right"}},[t("inbox",{ref:"inboxRef",on:{resetInstantDraftsMsgIdByThreadIds:e.resetInstantDraftsMsgIdByThreadIds}})],1),t("compose-container",{ref:"composeContainer"})],1)])],1)},a=[],r=i(70021),o=i(56706),l=i(34948),c=(i(6710),i(3346)),d=i(63012),u=i(29648),h=function(){var e=this,t=e._self._c;return t("div",{class:["label-list",e.isMinimized&&"label-list__minimized"]},[t("LabelList",{attrs:{labels:e.systemLabels,isMinimized:e.isMinimized,isUserLabel:!1,selection:e.selectMailLabel},on:{itemCommand:e.handleItemCommand,select:e.handleSelectLabel}}),e.totalSystemLabels.length>e.mailLabelsLength?t("zm-tooltip",{attrs:{content:e.showAllSystemLabels?e.$t("label.less"):e.$t("label.more"),placement:"right"}},[t("div",{class:["more-wrapper",e.isMinimized&&"more-wrapper__minimized","tab-focus"],attrs:{"zm-ta":"sidebar-sys-label-toggle-min-max",role:"button",tabindex:"0"},on:{click:e.handleToggleLabels,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.handleToggleLabels.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleToggleLabels.apply(null,arguments)}]}},[t("svg-icon",{class:[e.isMinimized&&"more__minimized","svg-icon","system-icon"],attrs:{iconClass:e.showAllSystemLabels?"minus":"more"}}),e.isMinimized?e._e():t("span",{staticClass:"much-hidden"},[e._v(" "+e._s(e.showAllSystemLabels?e.$t("label.less"):e.$t("label.more"))+" ")])],1)]):e._e()],1)},m=[],p=function(){var e=this,t=e._self._c;return t("zm-tree",{ref:"tree",class:["tab-focus zm-tree",{labels__minimized:e.isMinimized}],attrs:{data:e.labels,"node-key":"id","auto-expand-parent":!1,"default-expanded-keys":e.expandKeys,"empty-text":"","expand-on-click-node":!1,role:"list"},on:{"node-click":function(t){return e.$emit("select",t)},"node-expand":e.handleNodeExpand,"node-collapse":e.handleNodeCollapse,keydown:[function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.stopPropagation()},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.stopPropagation()}]},scopedSlots:e._u([{key:"default",fn:function(i){var n,s=i.data;return t("ShortcutReminder",{attrs:{shortcutKey:s.isSystem?"go-to-".concat(null===(n=e.getLabelContent(s))||void 0===n?void 0:n.toLowerCase()):"",placement:"right",preTooltip:e.isMinimized||!s.isSystem?e.getLabelContent(s):"",alwaysShowTooltip:e.isMinimized||s.isSystem,disabled:e.isDecryptFailed(s)}},[t("LabelItem",{directives:[{name:"metric",rawName:"v-metric:sidebar_custom_label",value:!s.isSystem,expression:"!data.isSystem",arg:"sidebar_custom_label"},{name:"metric",rawName:"v-metric:sidebar_label",value:{labelId:s.id},expression:"{ labelId: data.id }",arg:"sidebar_label"}],attrs:{noDropDownAction:!e.isUserLabel,selectMailLabel:e.selection,item:s,isMinimized:e.isMinimized,isBolded:!s.isSystem&&e.boldLabelIDs.includes(s.id),"zm-ta":e.getZmTaTag(s),"aria-label":e.getAriaLabelForSystemLabel(s),tabindex:"-1"},on:{handleCommand:function(t){return e.$emit("itemCommand",t)}}})],1)}}])})},f=[],v=function(){var e=this,t=e._self._c;return t("div",{class:["label-item",{"label-item__selected":e.getIsSelectedLabel(e.item),"label-item__minimized":e.isMinimized,"label-item__bolded":e.isBolded}],attrs:{tabindex:"-1","aria-label":e.getLabelContent(e.item)},on:{click:function(t){return e.handleClick(e.item)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleClick(e.item)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.handleClick(e.item)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),t.preventDefault(),e.handleKeyDown.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.handleKeyUp.apply(null,arguments))}],dragover:e.validateDrop,dragenter:e.validateDrop,dragleave:e.handleDragLeave,drop:function(t){return t.target!==t.currentTarget?null:e.handleDrop.apply(null,arguments)}}},[e.isMoving?t("i",{staticClass:"zm-icon-loading small",attrs:{tabindex:"-1"}}):e.item.isSystem?t("svg-icon",{class:["svg-icon"],attrs:{"aria-hidden":"true",isSelected:e.selectMailLabel.id===e.item.id,iconClass:e.getFolderIconClass(e.item)}}):e.isDecryptFailed?t("svg-icon",{staticClass:"locked-label",attrs:{"aria-hidden":"true",iconClass:"triangle-alert-filled"}}):t("svg-label",{attrs:{labelClass:e.labelIcon,"aria-hidden":"true",labelColor:e.getIsSelectedLabel(e.item)?"var(--button-primary-font-color)":e.item.backgroundColor}}),e.isMinimized?e._e():t("div",{staticClass:"label-item-content"},[t("span",{class:["label-name",!e.item.isSystem&&e.isDecryptFailed?"locked-label":""],attrs:{tabindex:"-1"}},[e._v(" "+e._s(e.getLabelContent(e.item))+" ")]),e.noDropDownAction?e._e():t("zm-dropdown",{attrs:{trigger:"click",placement:"bottom",tabindex:"-1"},on:{command:e.handleCommand}},[t("span",{staticClass:"zm-dropdown-selfdefine",on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.focusTreeNode.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.focusTreeNode.apply(null,arguments))}]}},[t("svg-icon",{staticClass:"dropdown-btn",attrs:{iconClass:"more-horizontal",tabindex:"0"}})],1),t("zm-dropdown-menu",{attrs:{slot:"dropdown","zm-ta":"label-decrypt"},slot:"dropdown"},[e.isDecryptFailed?t("zm-dropdown-item",{staticClass:"clearfix",attrs:{command:e.labelActions.RETRYDECRYPT}},[t("span",[e._v(e._s(e.$t("common.decrypt")))])]):e._e(),t("zm-dropdown-item",{staticClass:"clearfix",attrs:{command:e.labelActions.EDIT,"zm-ta":"label-edit"}},[t("span",[e._v(e._s(e.$t("operation.edit")))])]),t("zm-dropdown-item",{staticClass:"clearfix",attrs:{command:e.labelActions.DELETE,"zm-ta":"label-delete"}},[t("span",[e._v(e._s(e.$t("operation.delete")))])]),t("zm-dropdown-item",{staticClass:"clearfix",attrs:{command:e.labelActions.ADDSUB,"zm-ta":"label-add-sub-label"}},[t("span",[e._v(e._s(e.isOutlook?e.$t("label.addSubfolder"):e.$t("label.addSublabel")))])])],1)],1)],1),!e.isDecryptFailed&&0!==e.item.displayNum&&e.showLabelCountBadge(e.item.id)?t("zm-badge",{class:["label-item-badge",{"hide-on-hover":!(e.item.isSystem||e.isMinimized),"zm-badge-draft":e.isDraftLabel(e.item.id),selected:e.getIsSelectedLabel(e.item)}],attrs:{"is-dot":e.isMinimized||!e.enableLabelCount,value:e.item.displayNum,max:9999,title:e.item.displayNum}}):e._e()],1)},b=[],g=(i(6886),i(21942)),S=i(39544),I=i(50620),x=i(63147),w=i(43251),y=i(8062),C=i(55430),L=c.Enums.SystemDefinedCategoryIds,k=c.Enums.SystemDefinedMailLabelIds,$=c.Business.labelUtils,T={name:"LabelItem",components:{SvgLabel:S.Z,SvgIcon:g.Z},mixins:[C.Z],props:{item:Object,selectMailLabel:Object,isMinimized:{type:Boolean,default:!1},isBolded:{type:Boolean,default:!1},noDropDownAction:{type:Boolean,default:!1}},data:function(){return{isMoving:!1,categoryIds:Object.values(L),systemLabelIdsForMove:[k.INBOX,k.STARRED,k.TRASH,k.ARCHIVE,k.SPAM],labelActions:c.Enums.LabelActions}},computed:(0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.Se)(["enableLabelCount","isGmail","isOutlook"])),(0,u.rn)(["searchString","inSearching","draggedEmails","dragType"])),{},{isDecryptFailed:function(){return c.Utils.isDecryptFailed(this.item.labelDecryptionStatus)},labelIcon:function(){return c.Business.labelUtils.getLabelIconName(this.isOutlook)}}),methods:(0,l.Z)((0,l.Z)({focusTreeNode:function(){this.$el.closest(".zm-tree-node").focus()},handleKeyDown:function(){this.$emit("pressDownArrowKey")},handleKeyUp:function(){this.$emit("pressUpArrowKey")}},(0,u.nv)("inbox",["removeSelectedInboxThreadIds"])),{},{validateDrop:function(e){"messages"===this.dragType&&this.selectMailLabel.id!==this.item.id&&(this.item.isSystem&&!this.systemLabelIdsForMove.includes(this.item.id)||this.draggedEmails.length>0&&(this.setDropFeedback(!0),e.preventDefault()))},handleDragLeave:function(e){this.setDropFeedback(!1),e.preventDefault()},handleDrop:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,l,c,d,u;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if("messages"===t.dragType){i.next=2;break}return i.abrupt("return");case 2:if(t.setDropFeedback(!1),n=t.selectMailLabel.id,s=t.item.id,n!==s){i.next=7;break}return i.abrupt("return");case 7:return t.isMoving=!0,a=t.draggedEmails,i.next=11,Promise.all(a.map(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(i){var n,s;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y.t.getThreadHead(t.selectMailLabel.id,i);case 2:return n=e.sent,s=n.GetThreadHead.msgIds,e.abrupt("return",{msgIds:s,groupId:i});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return l=i.sent,i.next=14,t.handleMoveAndGetUndoFunc(n,s,l);case 14:c=i.sent,d=a.length,u=t.getLabelContent(t.item),t.$undoNotice({iconClass:"checkmark",title:t.$tc("common.messageMovedTo",d,[u]),action:t.$t("operation.undo"),actionCallback:c,duration:5e3}),t.isMoving=!1,e.preventDefault();case 20:case"end":return i.stop()}}),i)})))()},setDropFeedback:function(e){var t=e?"add":"remove";this.$el.classList[t]("drop-target")},isDraftLabel:function(e){return e===k.DRAFT},showLabelCountBadge:function(e){return!$.HIDE_COUNT_LABELS.includes(e)},getIsSelectedLabel:function(e){if(this.selectMailLabel.id===e.id)return!0;if(e.id===k.INBOX&&this.categoryIds.includes(this.selectMailLabel.id))return!0;if(this.inSearching&&!this.selectMailLabel.id){var t,i=null===(t=this.searchString)||void 0===t?void 0:t.toLowerCase();if(i==="in:".concat(e.id.toLowerCase()," ")||i==="is:".concat(e.id.toLowerCase()," "))return!0;if(x.Z.isArchive(e.id)&&("in:archive "===i||"is:archive "===i))return!0;if(i==="in:".concat(e.name.toLowerCase()," ")||i==="is:".concat(e.name.toLowerCase()," "))return!0}return!1},getFolderIconClass:function(e){var t,i,n="folder";this.isOutlook?n=(null===(t=w.Z[e.id])||void 0===t?void 0:t.icon)||"folder":n=(null===(i=I.Z[e.id])||void 0===i?void 0:i.icon)||"folder";return this.getIsSelectedLabel(e)?"".concat(n,"-filled"):n},handleCommand:function(e){this.$emit("handleCommand",{method:e,item:this.item})},handleClick:function(e){this.$store.commit("changeCurrentPage",1),this.$emit("handleSelectLabel",e);var t=this.$el.closest(".zm-tree-node");null===t||void 0===t||t.focus()},getLabelContent:function(e){var t,i,n,s;return e.isSystem?this.isOutlook?null!==(n=w.Z[e.id])&&void 0!==n&&n.displayName?this.$t(null===(s=w.Z[e.id])||void 0===s?void 0:s.displayName):"":null!==(t=I.Z[e.id])&&void 0!==t&&t.displayName?this.$t(null===(i=I.Z[e.id])||void 0===i?void 0:i.displayName):"":this.isGmail?e.displayName:this.isDecryptFailed?this.$t("label.encryptedLabel"):e.name}})},_=T,D=i(93483),E=(0,D.Z)(_,v,b,!1,null,"b35c85e0",null),M=E.exports,A=i(58854),R={name:"LabelList",components:{LabelItem:M,ShortcutReminder:A.Z},props:{labels:{type:Array,default:[]},isMinimized:{type:Boolean,default:!1},isUserLabel:{type:Boolean,default:!1},selection:{type:Object,default:null}},data:function(){return{expandKeys:[],expandKeysTmp:[],emptyText:"",boldLabelIDs:[]}},watch:{labels:function(){var e=this;this.expandKeys=this.expandKeysTmp,setTimeout((function(){e.expandKeys=[]}),0),this.findAndCheckBoldLabel()},expandKeysTmp:function(){this.findAndCheckBoldLabel()}},mounted:function(){this.findAndCheckBoldLabel()},methods:{getAriaLabelForSystemLabel:function(e){switch(e.id){case c.Enums.SystemDefinedMailLabelIds.INBOX:return this.$t("accessibility.unreadCountOfLabel",[e.displayName,e.count.threadsUnread]);case c.Enums.SystemDefinedMailLabelIds.DRAFT:return this.$t("accessibility.draftCount",[e.count.threadsTotal]);default:return e.displayName}},getZmTaTag:function(e){var t,i=null===(t=this.getLabelContent(e))||void 0===t?void 0:t.toLowerCase();return e.isSystem?"sidebar-sys-label-".concat(i):"sidebar-user-label-".concat(i)},handleNodeExpand:function(e){this.expandKeysTmp.push(e.id)},handleNodeCollapse:function(e){this.expandKeysTmp=this.expandKeysTmp.filter((function(t){return t!==e.id}))},isDecryptFailed:function(e){return c.Utils.isDecryptFailed(e.labelDecryptionStatus)},getLabelContent:function(e){if(e.isSystem){var t;if(this.isOutlook){var i,n=this.$t("common.unknownFolderName");return e.id&&this.$t(null===(i=w.Z[e.id])||void 0===i?void 0:i.displayName)||n}var s=this.$t("common.unknownLabelName");return e.id&&this.$t(null===(t=I.Z[e.id])||void 0===t?void 0:t.displayName)||s}return this.isGmail?e.displayName:c.Utils.isDecryptFailed(e.labelDecryptionStatus)?this.$t("label.encryptedLabel"):e.displayName},findAndCheckBoldLabel:function(){var e=this;this.boldLabelIDs=[],this.labels.forEach((function(t){e.DFS_CheckLabelTreeHasUnreadEmail(t)}))},DFS_CheckLabelTreeHasUnreadEmail:function(e){var t,i=this;if(0===(null===(t=e.children)||void 0===t?void 0:t.length))return e.count.msgUnread>0&&this.boldLabelIDs.push(e.id),e.count.msgUnread>0;var n,s=!1;return null===(n=e.children)||void 0===n||n.forEach((function(e){s|=i.DFS_CheckLabelTreeHasUnreadEmail(e)})),s|=e.count.msgUnread>0,e.count.msgUnread>0&&this.boldLabelIDs.push(e.id),!this.expandKeysTmp.includes(e.id)&&s&&this.boldLabelIDs.push(e.id),s}}},Z=R,z=(0,D.Z)(Z,p,f,!1,null,"75ae79f0",null),O=z.exports,H=c.Business.labelUtils,P=c.Enums.SystemDefinedCategoryIds,N=c.Enums.LabelActions,F={name:"SystemLabels",components:{LabelList:O},props:{isMinimized:{type:Boolean}},data:function(){return{categoryIds:Object.values(P),mailLabelsLength:this.isZmail?7:8}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.Se)(["currentLabelId","isOutlook","isZmail"])),(0,u.rn)(["showAllSystemLabels","mailLabels","selectMailLabel","prefersColorScheme"])),(0,u.rn)({isDelegated:function(e){return e.userProfile.isDelegated}})),{},{totalSystemLabels:function(){var e=this,t=this.mailLabels;return this.isOutlook&&(t=H.getLabelListTree(this.mailLabels,this.isOutlook)),t.filter((function(t){if(!t.isSystem)return!1;if(e.categoryIds.includes(t.id))return!1;var i=t.id,n=t.count;return e.isOutlook?![c.Enums.SystemDefinedMailLabelIds.OUTBOX,c.Enums.SystemDefinedMailLabelIds.SYNC_ISSUES].includes(t.id)||!!n.threadsTotal:(!e.isDelegated||t.id!==c.Enums.SystemDefinedMailLabelIds.PRIVATE)&&(![c.Enums.SystemDefinedMailLabelIds.OUTBOX,c.Enums.SystemDefinedMailLabelIds.USER_SCHEDULED,c.Enums.SystemDefinedMailLabelIds.ESCROW,c.Enums.SystemDefinedMailLabelIds.GROUP_APPROVAL].includes(i)||n.threadsTotal)}))},systemLabels:function(){var e=this,t=c.Business.labelUtils.orderSystemLabels(this.totalSystemLabels),i=this.totalSystemLabels.length===this.mailLabelsLength;return i||(t=t.filter((function(t,i){return e.showAllSystemLabels||i<e.mailLabelsLength}))),t},hasSubLabel:function(){return this.systemLabels.some((function(e){return e.children.length}))}}),watch:{currentLabelId:function(e){this.systemLabels.findIndex((function(t){return t.id===e}))>this.mailLabelsLength&&(this.showAllSystemLabels||this.handleToggleLabels())},mailLabels:function(e){this.checkTempFolderCount(e)}},methods:(0,l.Z)((0,l.Z)({},(0,u.OI)(["setShowAllSystemLabels"])),{},{getLabelContent:function(e){var t;if(this.isOutlook){var i,n=this.$t("common.unknownFolderName");return e.id&&this.$t(null===(i=w.Z[e.id])||void 0===i?void 0:i.displayName)||n}var s=this.$t("common.unknownLabelName");return e.id&&this.$t(null===(t=I.Z[e.id])||void 0===t?void 0:t.displayName)||s},handleSelectLabel:function(e){this.$emit("handleSelectLabel",e)},handleToggleLabels:function(){this.setShowAllSystemLabels(!this.showAllSystemLabels),this.$metric.report("sidebar_label_more")},handleItemCommand:function(e){var t=e.item,i=e.method;this.action=i,i===N.DELETE||i===N.EDIT||i===N.ADDSUB?(this.labelItem=t,this.dialogVisible=!0):i===N.RETRYDECRYPT&&this.retryDecryptLabel(t,!0)},checkTempFolderCount:function(e){var t=e.find((function(e){return e.id===c.Enums.SystemDefinedMailLabelIds.OUTBOX})),i=e.find((function(e){return e.id===c.Enums.SystemDefinedMailLabelIds.USER_SCHEDULED}));if(this.currentLabelId===c.Enums.SystemDefinedMailLabelIds.OUTBOX&&0===t.displayNum||this.currentLabelId===c.Enums.SystemDefinedMailLabelIds.USER_SCHEDULED&&0===i.displayNum){var n=e.find((function(e){return e.id===c.Enums.SystemDefinedMailLabelIds.INBOX}));n&&this.$emit("handleSelectLabel",n)}}})},U=F,V=(0,D.Z)(U,h,m,!1,null,"e3d9c052",null),B=V.exports,G=function(){var e=this,t=e._self._c;return t("div",{class:["labels","tab-focus",e.isMinimized&&"labels__minimized","dark"===e.prefersColorScheme&&"is_dark"]},[t("shortcut-reminder",{staticClass:"label-list-label create-btn",attrs:{hideLabel:!0,tabindex:"-1",preTooltip:e.isOutlook?e.$t("label.createFolder"):e.$t("label.createLabel"),placement:"right",disabled:!e.isMinimized,"zm-ta":"sidebar-user-label-add"}},[t("div",{staticClass:"create-btn-wrap tab-focus",attrs:{tabindex:"0","aria-label":e.isOutlook?e.$t("label.createFolder"):e.$t("label.createLabel"),"aria-expanded":void 0,role:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAddLabel.apply(null,arguments)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.handleAddLabel.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddLabel.apply(null,arguments)},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.stopPropagation(),t.preventDefault()},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.stopPropagation(),t.preventDefault()}]}},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.isMinimized,expression:"!isMinimized"}],staticClass:"create-btn-content"},[e._v(" "+e._s(e.isOutlook?e.$t("label.createFolder"):e.$t("label.createLabel"))+" ")]),t("svg-icon",{staticClass:"create-btn-icon",attrs:{iconClass:"plus","aria-hidden":"true"}})],1)]),t("LabelList",{ref:"labelList",attrs:{labels:e.userMailLabels,isMinimized:e.isMinimized,isUserLabel:!0,selection:e.selectMailLabel},on:{select:e.handleSelectLabel,itemCommand:e.handleItemCommand}}),t("label-dialog",{attrs:{show:e.dialogVisible,action:e.action,item:e.labelItem,labelListTree:e.labelListTree,"append-to-body":"","zm-ta":"create-label-dialog"},on:{onOk:e.handleOperationOk,onCancel:e.handleOperationCancel,handleSelectLabel:e.handleSelectLabel}})],1)},W=[],j=i(75107),X=i(82159),K=c.Business.labelUtils,J=c.Enums.LabelActions,Y={name:"UserLabels",components:{LabelList:O,SvgIcon:g.Z,labelDialog:j.Z,ShortcutReminder:A.Z},props:{isMinimized:{type:Boolean}},data:function(){return{action:"",dialogVisible:!1,labelItem:{}}},computed:(0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["selectMailLabel","mailLabels","prefersColorScheme"])),(0,u.Se)(["isZmail","isOutlook","showDecryptFailedReminder"])),{},{providerIsGmail:function(){return this.$store.state.typeOfEmail===X.EMAIL_PROVIDER.GMAIL},labelListTree:function(){return K.getLabelListTree(this.mailLabels,this.isOutlook)},userMailLabels:function(){return this.labelListTree.filter((function(e){return!e.isSystem}))}}),watch:{mailLabels:function(e){var t,i=this;if((null===(t=this.selectMailLabel)||void 0===t?void 0:t.id)!==c.Enums.SystemDefinedMailLabelIds.SEARCH){var n=e.find((function(e){var t;return e.id===(null===(t=i.selectMailLabel)||void 0===t?void 0:t.id)}))||{};Object.keys(n).length||this.handleSelectLabel({isSystem:!0,id:c.Enums.SystemDefinedMailLabelIds.INBOX})}}},mounted:function(){this.isZmail&&this.retryDecryptAllLabels(!0)},methods:(0,l.Z)((0,l.Z)({},(0,u.OI)(["setShowDecryptFailedReminder","setDecryptFailedReminderContent"])),{},{handleSelectLabel:function(e){this.$emit("handleSelectLabel",e)},handleAddLabel:function(){this.dialogVisible=!0,this.labelItem={},this.action=J.CREATE},handleItemCommand:function(e){var t=e.item,i=e.method;this.action=i,i===J.DELETE||i===J.EDIT||i===J.ADDSUB?(this.labelItem=t,this.dialogVisible=!0):i===J.RETRYDECRYPT&&this.retryDecryptLabel(t,!0)},handleOperationOk:function(e){var t=this,i=e.action,n=e.labels;this.dialogVisible=!1,i===c.Enums.LabelActions.ADDSUB&&n.forEach((function(e){t.$refs.labelList.handleNodeExpand({id:e.parentFolderId})}))},handleOperationCancel:function(){this.dialogVisible=!1},retryDecryptLabel:function(e,t){var i=this;return(0,o.Z)((0,r.Z)().mark((function n(){var s;return(0,r.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=4,window.zoomSdk.postJsMessage({functionName:"mailui_retrydecryptlabel",params:{labelId:e.id}});case 4:s=n.sent,0===s.returnCode?i.$store.commit("changeMailLabelsDisplayNum",{labelId:e.id,mailLabel:s.result.RetryDecryptLabel}):t&&i.$undoNotice({title:c.Utils.getErrMsgWithCode(i.$t("label.unableToDecryptLabel"),s)}),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),i.$msg({type:"Error",content:i.$t("label.errorDecryptingLabel")});case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},retryDecryptAllLabels:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.mailLabels.filter((function(e){return!c.Utils.isDecrypted(e.labelDecryptionStatus)}));i.forEach((function(i){e.retryDecryptLabel(i,!t)}))}})},q=Y,Q=(0,D.Z)(q,G,W,!1,null,"6c47c6dc",null),ee=Q.exports,te=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"scale",rawName:"v-scale",value:1,expression:"1"}],staticClass:"inbox-container",on:{wheel:e.throttleHandleMouseWheel}},[t("add-filter-dialog",{ref:"addFilterDialog",attrs:{filterEdits:e.filterEdits},on:{cancel:function(){},submit:function(){}}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showActions,expression:"showActions"}],ref:"contextMenu",staticClass:"actions zoom-modal",style:{left:e.actionX+"px",top:e.actionY+"px"},attrs:{id:"mail-list-actions-menu"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()}}},[e.archiveStatus?t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-archive"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleArchiveToggle.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("operation.archive"))+" ")]):e._e(),e.showMove2Inbox?t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-move-to-inbox"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleTrashToggle(!0)}}},[e._v(" "+e._s(e.move2InboxText)+" ")]):e._e(),e.showMove2Trash?t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-delete"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleTrashToggle(!1)}}},[e._v(" "+e._s(e.move2TrashText)+" ")]):e._e(),t("div",{staticClass:"actions-item",attrs:{"zm-ta":e.readStatus?"inbox-action-mark-as-unread":"inbox-action-mark-as-read"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleReadToggle.apply(null,arguments)}}},[e._v(" "+e._s(e.readStatus?e.$t("operation.markAsUnread"):e.$t("operation.markAsRead"))+" ")]),e.hasDrafts?t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-discard-draft"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleDiscardDrafts(!1)}}},[e._v(" "+e._s(e.$t("operation.discardDraft"))+" ")]):e._e(),e.canDeleteForever?t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-delete-forever"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleDeleteTrash.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("operation.deleteForever"))+" ")]):e._e(),e.isOutlook||e.allContextMenuSendersAreSelf?e._e():t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-"+(e.isSpammed?"remove-from-spam":"mark-as-spam")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSpamToggle.apply(null,arguments)}}},[e._v(" "+e._s(e.spamStatus)+" ")]),e.isOutlook?e._e():t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-filter-messages-like-this"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.showCreateFilterDialog.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("operation.createFilter"))+" ")]),e.isZmail&&!e.userProfile.isDelegated?t("div",{staticClass:"actions-item",attrs:{"zm-ta":"inbox-action-make-private"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onPrivateAction.apply(null,arguments)}}},[e._v(" "+e._s(e.isInPrivateBox?e.$t("operation.showToDelegates"):e.$t("operation.hideFromDelegates"))+" ")]):e._e()]),t("div",{staticClass:"top-bar"},[t("search",{ref:"searchRef",staticClass:"search-container",attrs:{"zm-ta":"inbox-search"},on:{searchFinished:e.setLoadingState,changeSearchErrorStatus:e.changeSearchErrorStatus,redirect:e.redirect2Thread}}),t("div",[t("div",{staticClass:"header-bar-right"},[e.isTestClient?t("span",{staticClass:"header-bar__version"},[e._v(" "+e._s(e.$t("common.version",[e.version]))+" "),e.fixedJiras.length>0?t("span",[e._v("("),t("a",{on:{click:function(t){return e.handDevInfo(!0)}}},[e._v("Package Info")]),e._v(")")]):e._e()]):e._e(),t("zm-tooltip",{attrs:{content:e.$t("operation.refresh"),placement:"bottom",enterable:!1}},[t("zm-button",{directives:[{name:"metric",rawName:"v-metric:inbox_refresh",arg:"inbox_refresh"}],staticClass:"header-bar-btn",attrs:{tabindex:"0","aria-label":e.$t("operation.refresh"),"aria-expanded":void 0,"zm-ta":"inbox-refresh"},on:{click:e.throttleHandleSyncMail}},[t("svg-icon",{class:{"circle-refresh":e.refreshRun},attrs:{iconClass:"refresh"}})],1)],1),t("SettingsDropdown",{on:{enterSettings:e.goToSettings,changeView:e.handleSplitToggle,dropdownOpened:e.onSettingDropdownOpened},scopedSlots:e._u([{key:"trigger",fn:function(){return[t("zm-tooltip",{attrs:{content:e.$t("common.settings"),placement:"bottom",enterable:!1}},[t("zm-button",{staticClass:"header-bar-btn",attrs:{tabindex:"0","zm-ta":"inbox-go-setting-page","aria-expanded":void 0,"aria-label":e.$t("common.settings")}},[t("svg-icon",{attrs:{iconClass:"setting"}})],1)],1)]},proxy:!0}])})],1)])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showDetail||e.isSplitView,expression:"!showDetail || isSplitView"}],ref:"headerBar",staticClass:"header-bar-wrap",on:{contextmenu:e.handleHideActions}},[t("div",{staticClass:"header-bar"},[t("CategoryTabs",{attrs:{selectionCount:e.selectedInboxThreadIds.length}})],1),e.isShowControlHeader?t("ControlHeader",{ref:"controlHeader",attrs:{isLoading:e.isLoading,actions:e.actions},on:{showApproveDialog:e.showApproveDialog,handleCheckMore:e.handleCheckMore,setIsLastPage:e.setIsLastPage,changeSearchErrorStatus:e.changeSearchErrorStatus,setLoadingState:e.setLoadingState,handleCheckAllChange:e.handleCheckAllChange,setSelectInboxes:e.setSelectInboxes,handleRefresh:e.handleRefresh}}):e._e()],1),t("div",{class:["mail-view-manager",{"split-view":e.isSplitView,"has-offline-banner":e.isOfflineByDisconection}]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isSplitView||!e.showDetail,expression:"isSplitView || !showDetail"}],staticClass:"mail-list",attrs:{id:"mail-list"}},[e.isZmail?t("low-storage-usage-tips"):e._e(),e.currentLabelId===e.groupLabel?t("div",{staticClass:"group-label-description tab-focus",attrs:{tabindex:"0"}},[e._v(" "+e._s(e.$t("groupSetting.groupLabelDescription",[5]))+" ")]):e._e(),e.inboxSectionVisible?t("div",{staticClass:"recycle-scroller-container-sections"},[t("inbox-sections",{ref:"inboxSections",on:{handleDelete:e.handleItemDelete,handleArchive:e.handleItemArchive,handleMove:e.handleItemMove,handleSpam:e.handleItemSpam,handlePhishing:e.handleItemPhishing,handleMark:e.handleItemMark,handleCheckedItemsChange:e.handleCheckedItemsChange,handleShowActions:e.handleShowActions,handleHideActions:e.handleHideActions,handleShowDetail:e.handleShowDetail,handleCancelScheduledSend:e.handleCancelScheduledSend,handleDiscardDrafts:e.handleDiscardDrafts,setSelectItem:e.setSelectItem}})],1):[e.shouldShowEmptyState?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"no-data empty-state",attrs:{"element-loading-spinner":"zm-icon-loading"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"no-data-tip"},[t("div",{staticClass:"no-data-in-label"},[e.isSplitView||e.showSplitDefault?e._e():t("div",{staticClass:"splash-image"},[t("img",{staticClass:"splash",attrs:{src:i(66813),alt:e.$t("list.splashImage")}})]),e.inSearching||e.inFilters?t("div",[t("div",[e._v(e._s(e.$t("list.noEmailsInSearch")))]),t("zm-button",{directives:[{name:"show",rawName:"v-show",value:(e.isOffline||e.searchErrorStatus)&&e.isNotInOutbox,expression:"(isOffline || searchErrorStatus) && isNotInOutbox"}],attrs:{"zm-ta":"inbox-list-retry"},on:{click:e.retry}},[e._v(" "+e._s(e.$t("common.retry"))+" ")])],1):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.inSearching&&!e.inFilters,expression:"!inSearching && !inFilters"}]},[t("div",[e._v(e._s(e.listText))]),t("zm-button",{directives:[{name:"show",rawName:"v-show",value:(e.isOffline||e.errorStatus)&&e.isNotInOutbox,expression:"(isOffline || errorStatus) && isNotInOutbox"}],attrs:{"zm-ta":"inbox-list-refresh"},on:{click:e.retry}},[e._v(" "+e._s(e.$t("common.retry"))+" ")])],1)])])]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.shouldShowEmptyState,expression:"!shouldShowEmptyState"},{name:"loading",rawName:"v-loading",value:e.isFilteringMails||e.isSearchingMails,expression:"isFilteringMails || isSearchingMails"}],staticClass:"recycle-scroller-container",attrs:{id:"virtual-container","element-loading-spinner":"zm-icon-loading",tabindex:"-1"}},[t("RecycleScroller",{directives:[{name:"show",rawName:"v-show",value:!(e.isLoading&&e.isPaginated),expression:"!(isLoading && isPaginated)"}],ref:"recycleScroller",staticClass:"recycle-scroller tab-focus-button",attrs:{id:"recycle-scroller",tabindex:"0","aria-label":e.$t("accessibility.emailList"),keyField:"threadId",items:e.mails,sizeField:"height",simpleArray:!1},on:{handleHideActions:e.handleHideActions,scrollEnd:e.onScrollEnd},scopedSlots:e._u([{key:"default",fn:function(i){var n=i.item;return[t("inbox-item",{key:n.threadId,attrs:{"zm-ta":"inbox-item-"+n.threadId,isLoadingDetail:e.currentLoadingInboxDetailThreadId===n.threadId,inboxItem:n,displayActionTooltip:!e.isThreadExist(n.threadId),tabindex:"-1"},on:{handleDelete:e.handleItemDelete,handleArchive:e.handleItemArchive,handleMove:e.handleItemMove,handleSpam:e.handleItemSpam,handlePhishing:e.handleItemPhishing,handleMark:e.handleItemMark,handleCheckedItemsChange:e.handleCheckedItemsChange,handleShowActions:e.handleShowActions,handleHideActions:e.handleHideActions,handleShowDetail:e.handleShowDetail,handleCancelScheduledSend:e.handleCancelScheduledSend,handleDiscardDrafts:e.handleDiscardDrafts,setSelectItem:e.setSelectItem}})]}},{key:"after",fn:function(){return[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoading&&0!==e.inboxList.length,expression:"isLoading && inboxList.length !== 0"}],staticClass:"list-loading"},[t("i",{staticClass:"zm-icon-loading"})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLocalLastPage&&!e.isLoading&&0!==e.inboxList.length,expression:"isLocalLastPage && !isLoading && inboxList.length !== 0"}],staticClass:"list-marker",on:{contextmenu:function(t){return t.stopPropagation(),e.handleHideActions.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("list.endOfEmails"))+" ")])]},proxy:!0}],null,!1,3136030157)})],1)]],2),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isSplitView,expression:"isSplitView"}],staticClass:"resizer",attrs:{id:"resizer"}},[t("div",{staticClass:"resizer-line"})]),e.isSplitView&&(!e.showDetail&&e.showSplitDefault||!e.isDetailInList)?t("div",{staticClass:"detail-view splash-image"},[t("div",{staticClass:"no-data-tip"},[t("img",{staticClass:"splash",attrs:{src:i(66813),alt:e.$t("list.splashImage")}})])]):""!==e.currentLoadingInboxDetailThreadId&&e.isSplitView?t("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],staticClass:"response-detail-loading",attrs:{"element-loading-spinner":"zm-icon-loading","element-loading-text":e.$t("detail.loadingEmail")}}):e.showDetail?t("detail",{staticClass:"detail-view",attrs:{inboxList:e.inboxList,responseItemMailLabels:e.responseItemMailLabels,isLoading:e.isLoading},on:{verifySelectInboxes:e.verifySelectInboxes,handleDelete:e.handleDeleteResponse,handleArchive:e.handleItemArchive,handleMark:e.handleMarkResponse,handleSpam:e.handleSpamResponse,handleShowDetail:e.handleShowDetail,openCreateFilter:e.openCreateFilter}}):e._e()],1),e.isOfflineByDisconection?t("offline-mode-inbox-banner"):e._e(),t("confirm-dialog",{attrs:{visible:e.showApproveUserDialog,hasBold:e.hasBold,actions:e.approveUserActions,title:e.$t("operation.approveThisEmailAddress"),width:"475px"}}),t("confirm-dialog",{attrs:{visible:e.showReportPhishingDialog,title:e.$t("operation.reportPhishing"),content:e.$t("operation.reportPhishingContent"),actions:e.reportPhishingActions,width:"475px"}}),t("zm-dialog",{staticClass:"get-started",attrs:{width:"490px",visible:e.showGetStartedModal,"append-to-body":"",modal:"","aria-label":e.$t("accessibility.zoom")}},[t("div",{staticClass:"logo",attrs:{"aria-label":e.$t("landing.zoomLogo"),role:"text"}},[t("svg-icon",{attrs:{"aria-hidden":!0,iconClass:"logo"}})],1),t("div",{staticClass:"description"},[e._v(e._s(e.$t("landing.aimsToHelp")))]),t("div",{staticClass:"items"},e._l(["enjoyInbox","useTeamChat","customizeInbox"],(function(i,n){return t("div",{key:i,staticClass:"item"},[t("div",{staticClass:"item-title"},[t("span",[e._v(e._s(n+1))]),t("div",[e._v(e._s(e.$t("landing.".concat(i))))])]),t("div",{staticClass:"item-detail"},[e._v(e._s(e.$t("landing.".concat(i,"Detail"))))])])})),0),t("zm-button",{attrs:{type:"primary"},on:{click:e.closeGetStartedModal}},[e._v(" "+e._s(e.$t("landing.getStarted"))+" ")])],1),e.isTestClient&&e.fixedJiras.length>0?t("zm-dialog",{staticClass:"fixed-jiras-dialog",attrs:{visible:e.showDevJIRA,title:"Fixed Issues In Recent 3 Days","append-to-body":"",modal:""}},[t("div",{staticClass:"fixed-jiras-continer"},e._l(e.fixedJiras,(function(i){return t("div",{key:i},[t("a",{attrs:{href:i}},[e._v(e._s(i))])])})),0),t("zm-button",{on:{click:function(t){return e.handDevInfo(!1)}}},[e._v("Close")])],1):e._e()],1)},ie=[],ne=i(84282),se=i(6041),ae=i(26274),re=(i(43430),i(21515),i(77950),i(71372),i(37348)),oe=i.n(re),le=i(37761),ce=i.n(le),de=i(46905),ue=i(87693),he=i(41236),me=i(16759),pe={itemsLimit:1e3},fe=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibilityChange,expression:"handleVisibilityChange"}],staticClass:"vue-recycle-scroller",class:(0,ae.Z)({ready:e.ready,"page-mode":e.pageMode},"direction-".concat(e.direction),!0),attrs:{role:"application"},on:{"&scroll":function(t){return e.handleScroll.apply(null,arguments)},contextmenu:e.handleHideActions,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnPrev.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnNext.apply(null,arguments))}],focus:function(t){return t.target!==t.currentTarget?null:e.handleFocus.apply(null,arguments)}}},[e.$slots.before?t("div",{staticClass:"vue-recycle-scroller__slot",on:{contextmenu:e.handleHideActions}},[e._t("before")],2):e._e(),t("div",{ref:"wrapper",staticClass:"vue-recycle-scroller__item-wrapper",style:(0,ae.Z)({},"vertical"===e.direction?"minHeight":"minWidth",e.totalSize+"px")},[t("transition-group",{attrs:{name:"scroll-item-fade"}},e._l(e.pool,(function(i){return t("div",{key:i.nr.id,ref:i.nr.id,refInFor:!0,staticClass:"vue-recycle-scroller__item-view",class:{hover:e.hoverKey===i.nr.key,__in__view:e.ready&&i.nr.used},style:e.ready&&i.nr.used?{transform:"translate".concat("vertical"===e.direction?"Y":"X","(").concat(i.position,"px)")}:{display:"none"},attrs:{tabindex:"-1"},on:{mouseenter:function(t){e.hoverKey=i.nr.key},mouseleave:function(t){e.hoverKey=null}}},[e._t("default",null,{item:i.item,index:i.nr.index,active:i.nr.used})],2)})),0)],1),e.$slots.after?t("div",{staticClass:"vue-recycle-scroller__slot",on:{contextmenu:e.handleHideActions}},[e._t("after")],2):e._e(),t("ResizeObserver",{on:{notify:e.handleResize}})],1)},ve=[];function be(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var i=e.indexOf("Trident/");if(i>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var s=e.indexOf("Edge/");return s>0?parseInt(e.substring(s+5,e.indexOf(".",s)),10):-1}function ge(){ge.init||(ge.init=!0,n=-1!==be())}var Se={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},mounted:function(){var e=this;ge(),this.$nextTick((function(){e._w=e.$el.offsetWidth,e._h=e.$el.offsetHeight,e.emitOnMount&&e.emitSize()}));var t=document.createElement("object");this._resizeObject=t,t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex",-1),t.onload=this.addResizeHandlers,t.type="text/html",n&&this.$el.appendChild(t),t.data="about:blank",n||this.$el.appendChild(t)},beforeDestroy:function(){this.removeResizeHandlers()},methods:{compareAndNotify:function(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize:function(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers:function(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers:function(){this._resizeObject&&this._resizeObject.onload&&(!n&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};function Ie(e,t,i,n,s,a,r,o,l,c){"boolean"!==typeof r&&(l=o,o=r,r=!1);var d,u="function"===typeof i?i.options:i;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,s&&(u.functional=!0)),n&&(u._scopeId=n),a?(d=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=d):t&&(d=r?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),d)if(u.functional){var h=u.render;u.render=function(e,t){return d.call(t),h(e,t)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,d):[d]}return i}var xe=Se,we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"resize-observer",attrs:{tabindex:"-1"}})},ye=[];we._withStripped=!0;var Ce=void 0,Le="data-v-8859cc6c",ke=void 0,$e=!1,Te=Ie({render:we,staticRenderFns:ye},Ce,xe,Le,$e,ke,!1,void 0,void 0,void 0);function _e(e){e.component("resize-observer",Te),e.component("ResizeObserver",Te)}var De={version:"1.0.1",install:_e},Ee=null;"undefined"!==typeof window?Ee=window.Vue:"undefined"!==typeof i.g&&(Ee=i.g.Vue),Ee&&Ee.use(De);var Me=i(56632);i(634);function Ae(e){return Ae="function"===typeof Symbol&&"symbol"===(0,Me.Z)(Symbol.iterator)?function(e){return(0,Me.Z)(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":(0,Me.Z)(e)},Ae(e)}function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ze(e,t,i){return t&&Ze(e.prototype,t),i&&Ze(e,i),e}function Oe(e){return He(e)||Pe(e)||Ne()}function He(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function Pe(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function Ne(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Fe(e){var t;return t="function"===typeof e?{callback:e}:e,t}function Ue(e,t){var i,n,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(r){for(var o=arguments.length,l=new Array(o>1?o-1:0),c=1;c<o;c++)l[c-1]=arguments[c];if(s=l,!i||r!==n){var d=a.leading;"function"===typeof d&&(d=d(r,n)),i&&r===n||!d||e.apply(void 0,[r].concat(Oe(s))),n=r,clearTimeout(i),i=setTimeout((function(){e.apply(void 0,[r].concat(Oe(s))),i=0}),t)}};return r._clear=function(){clearTimeout(i),i=null},r}function Ve(e,t){if(e===t)return!0;if("object"===Ae(e)){for(var i in e)if(!Ve(e[i],t[i]))return!1;return!0}return!1}var Be=function(){function e(t,i,n){Re(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(i,n)}return ze(e,[{key:"createObserver",value:function(e,t){var i=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Fe(e),this.callback=function(e,t){i.options.callback(e,t),e&&i.options.once&&(i.frozen=!0,i.destroyObserver())},this.callback&&this.options.throttle){var n=this.options.throttleOptions||{},s=n.leading;this.callback=Ue(this.callback,this.options.throttle,{leading:function(e){return"both"===s||"visible"===s&&e||"hidden"===s&&!e}})}this.oldResult=void 0,this.observer=new IntersectionObserver((function(e){var t=e[0];if(e.length>1){var n=e.find((function(e){return e.isIntersecting}));n&&(t=n)}if(i.callback){var s=t.isIntersecting&&t.intersectionRatio>=i.threshold;if(s===i.oldResult)return;i.oldResult=s,i.callback(s,t)}}),this.options.intersection),t.context.$nextTick((function(){i.observer&&i.observer.observe(i.el)}))}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&"number"===typeof this.options.intersection.threshold?this.options.intersection.threshold:0}}]),e}();function Ge(e,t,i){var n=t.value;if(n)if("undefined"===typeof IntersectionObserver);else{var s=new Be(e,n,i);e._vue_visibilityState=s}}function We(e,t,i){var n=t.value,s=t.oldValue;if(!Ve(n,s)){var a=e._vue_visibilityState;n?a?a.createObserver(n,i):Ge(e,{value:n},i):je(e)}}function je(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var Xe={bind:Ge,update:We,unbind:je};function Ke(e){e.directive("observe-visibility",Xe)}var Je={version:"1.0.0",install:Ke},Ye=null;"undefined"!==typeof window?Ye=window.Vue:"undefined"!==typeof i.g&&(Ye=i.g.Vue),Ye&&Ye.use(Je);var qe=i(66311),Qe=i.n(qe),et={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(e){return["vertical","horizontal"].includes(e)}},simpleArray:{type:Boolean,default:!1}},tt=et,it=!1;if("undefined"!==typeof window){it=!1;try{var nt=Object.defineProperty({},"passive",{get:function(){it=!0}});window.addEventListener("test",null,nt)}catch(ua){}}var st,at,rt=0,ot={name:"RecycleScroller",components:{ResizeObserver:Te},directives:{ObserveVisibility:Xe},props:(0,l.Z)((0,l.Z)({},tt),{},{itemSize:{type:Number,default:null},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1}}),data:function(){return{pool:[],totalSize:0,ready:!1,hoverKey:null,focusIndex:-1}},computed:(0,l.Z)((0,l.Z)({},(0,u.rn)({selectMailLabel:function(e){return e.selectMailLabel.id},labelPositionMap:function(e){return e.labelPositionMap}})),{},{sizes:function(){if(null===this.itemSize){for(var e,t={"-1":{accumulator:0}},i=this.items,n=this.sizeField,s=this.minItemSize,a=1e4,r=0,o=0,l=i.length;o<l;o++)e=i[o][n]||s,e<a&&(a=e),r+=e,t[o]={accumulator:r,size:e};return this.$_computedMinItemSize=a,t}return[]}}),watch:{items:function(){this.updateVisibleItems(!0),this.focusOn(this.focusIndex)},pageMode:function(){this.applyPageMode(),this.updateVisibleItems(!1)},focusIndex:function(e){this.focusOn(e)},sizes:{handler:function(){this.updateVisibleItems(!1)},deep:!0}},created:function(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1))},activated:function(){var e=this,t=this.$_lastUpdateScrollPosition;"number"===typeof t&&this.$nextTick((function(){e.scrollToPosition(t)}))},mounted:function(){var e=this;this.applyPageMode(),this.$nextTick((function(){e.$_prerender=!1,e.updateVisibleItems(!0),e.ready=!0}))},beforeDestroy:function(){this.removeListeners()},methods:(0,l.Z)((0,l.Z)({},(0,u.OI)(["setLabelPositionMap"])),{},{handleHideActions:function(){this.$emit("handleHideActions")},addView:function(e,t,i,n,s){var a={item:i,position:0},r={id:rt++,index:t,used:!0,key:n,type:s};return Object.defineProperty(a,"nr",{configurable:!1,value:r}),e.push(a),a},unuseView:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.$_unusedViews,n=e.nr.type,s=i.get(n);s||(s=[],i.set(n,s)),s.push(e),t||(e.nr.used=!1,this.$_views["delete"](e.nr.key))},handleResize:function(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll:function(e){var t=this;this.$store.commit("setLabelPositionMap",(0,ae.Z)({},this.selectMailLabel,this.getScroll().start)),this.$_scrollDirty||(this.$_scrollDirty=!0,requestAnimationFrame((function(){t.$_scrollDirty=!1,t.updateVisibleItems(!1,!0)})))},handleVisibilityChange:function(e,t){var i=this;this.ready&&(e||0!==t.boundingClientRect.width||0!==t.boundingClientRect.height?(this.$emit("visible"),requestAnimationFrame((function(){i.updateVisibleItems(!1)}))):this.$emit("hidden"))},updateVisibleItems:function(e){var t,i,n,s,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.itemSize,o=this.$_computedMinItemSize,l=this.typeField,c=this.simpleArray?null:this.keyField,d=this.items,u=d.length,h=this.sizes,m=this.$_views,p=this.$_unusedViews,f=this.pool;if(u)if(this.$_prerender)t=0,i=this.prerender,n=null;else{var v=this.getScroll();if(a){var b=v.start-this.$_lastUpdateScrollPosition;if(b<0&&(b=-b),null===r&&b<o||b<r)return{continuous:!0}}this.$_lastUpdateScrollPosition=v.start;var g=this.buffer;if(v.start-=g,v.end+=g,null===r){var S,I,x=0,w=u-1,y=~~(u/2);do{I=y,S=h[y].accumulator,S<v.start?x=y:y<u-1&&h[y+1].accumulator>v.start&&(w=y),y=~~((x+w)/2)}while(y!==I);for(y<0&&(y=0),t=y,n=h[u-1].accumulator,i=y;i<u&&h[i].accumulator<v.end;i++);-1===i?i=d.length-1:(i++,i>u&&(i=u))}else t=~~(v.start/r),i=Math.ceil(v.end/r),t<0&&(t=0),i>u&&(i=u),n=u*r}else t=i=n=0;i-t>pe.itemsLimit&&this.itemsLimitError(),this.totalSize=n;var C=t<=this.$_endIndex&&i>=this.$_startIndex;if(this.$_continuous!==C){if(C){m.clear(),p.clear();for(var L=0,k=f.length;L<k;L++)s=f[L],this.unuseView(s)}this.$_continuous=C}else if(C)for(var $=0,T=f.length;$<T;$++)s=f[$],s.nr.used&&(e&&(s.nr.index=d.findIndex((function(e){return c?e[c]===s.item[c]:e===s.item}))),(-1===s.nr.index||s.nr.index<t||s.nr.index>=i)&&this.unuseView(s));for(var _,D,E,M,A=C?null:new Map,R=t;R<i;R++){_=d[R];var Z=_[c]||_;if(null==Z)throw new Error("Key is ".concat(Z," on item (keyField is '").concat(c,"')"));s=m.get(Z),r||h[R].size?(s?(s.nr.used=!0,s.item=_):(R===d.length-1&&this.$emit("scrollEnd"),0===R&&this.$emit("scrollStart"),D=_[l],E=p.get(D),C?E&&E.length?(s=E.pop(),s.item=_,s.nr.used=!0,s.nr.index=R,s.nr.key=Z,s.nr.type=D):s=this.addView(f,R,_,Z,D):(M=A.get(D)||0,(!E||M>=E.length)&&(s=this.addView(f,R,_,Z,D),this.unuseView(s,!0),E=p.get(D)),s=E[M],s.item=_,s.nr.used=!0,s.nr.index=R,s.nr.key=Z,s.nr.type=D,A.set(D,M+1),M++),m.set(Z,s)),s.position=null===r?h[R-1].accumulator:R*r):s&&this.unuseView(s)}return this.$_startIndex=t,this.$_endIndex=i,this.emitUpdate&&this.$emit("update",t,i),{continuous:C}},getListenerTarget:function(){var e=Qe()(this.$el);return!window.document||e!==window.document.documentElement&&e!==window.document.body||(e=window),e},getScroll:function(){var e,t=this.$el,i=this.direction,n="vertical"===i;if(this.pageMode){var s=t.getBoundingClientRect(),a=n?s.height:s.width,r=-(n?s.top:s.left),o=n?window.innerHeight:window.innerWidth;r<0&&(o+=r,r=0),r+o>a&&(o=a-r),e={start:r,end:r+o}}else e=n?{start:t.scrollTop,end:t.scrollTop+(t.clientHeight||window.innerHeight)}:{start:t.scrollLeft,end:t.scrollLeft+(t.clientWidth||window.innerWidth)};return e},applyPageMode:function(){this.pageMode?this.addListeners():this.removeListeners()},addListeners:function(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,!!it&&{passive:!0}),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners:function(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem:function(e){var t;t=null===this.itemSize?e>0?this.sizes[e-1].accumulator:0:e*this.itemSize,this.scrollToPosition(t)},scrollToPosition:function(e){"vertical"===this.direction?this.$el.scrollTop=e:this.$el.scrollLeft=e},itemsLimitError:function(){throw setTimeout((function(){})),new Error("Rendered items limit reached")},sortViews:function(){this.pool.sort((function(e,t){return e.nr.index-t.nr.index}))},focusOnPrev:function(){this.focusIndex<0?this.focusIndex=0:this.focusIndex=Math.max(this.$_startIndex,this.focusIndex-1)},focusOnNext:function(){this.focusIndex<0?this.focusIndex=0:this.focusIndex=Math.min(this.focusIndex+1,this.$_endIndex-1)},focusOn:function(e){var t;if(!(e<0)){var i=this.$_startIndex>e||this.$_endIndex<e;i&&this.scrollToItem(e);var n=this.pool.find((function(t){var i=t.nr;return i.index===e})),s=this.$refs[null===n||void 0===n||null===(t=n.nr)||void 0===t?void 0:t.id][0];null===s||void 0===s||s.firstElementChild.focus()}},handleFocus:function(){this.focusIndex=-1}})},lt=ot,ct=(0,D.Z)(lt,fe,ve,!1,null,"3c5a983b",null),dt=ct.exports,ut=function(){var e=this,t=e._self._c;return t("RecycleScroller",e._g(e._b({ref:"scroller",attrs:{items:e.itemsWithSize,"min-item-size":e.minItemSize,direction:e.direction,"key-field":"id"},on:{resize:e.onScrollerResize,visible:e.onScrollerVisible},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.item,n=t.index,s=t.active;return[e._t("default",null,null,{item:i.item,index:n,active:s,itemWithSize:i})]}}],null,!0)},"RecycleScroller",e.$attrs,!1),e.listeners),[t("template",{slot:"before"},[e._t("before")],2),t("template",{slot:"after"},[e._t("after")],2)],2)},ht=[],mt={name:"DynamicScroller",components:{RecycleScroller:dt},inheritAttrs:!1,provide:function(){return"undefined"!==typeof ResizeObserver&&(this.$_resizeObserver=new ResizeObserver((function(e){var t,i=(0,ne.Z)(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.target){var s=new CustomEvent("resize",{detail:{contentRect:n.contentRect}});n.target.dispatchEvent(s)}}}catch(a){i.e(a)}finally{i.f()}}))),{vscrollData:this.vscrollData,vscrollParent:this,vscrollResizeObserver:this.$_resizeObserver}},props:(0,l.Z)((0,l.Z)({},tt),{},{minItemSize:{type:[Number,String],required:!0}}),data:function(){return{vscrollData:{active:!0,sizes:{},validSizes:{},keyField:this.keyField,simpleArray:!1}}},computed:{itemsWithSize:function(){for(var e=[],t=this.items,i=this.keyField,n=this.simpleArray,s=this.vscrollData.sizes,a=0;a<t.length;a++){var r=t[a],o=n?a:r[i],l=s[o];"undefined"!==typeof l||this.$_undefinedMap[o]||(l=0),e.push({item:r,id:o,size:l})}return e},listeners:function(){var e={};for(var t in this.$listeners)"resize"!==t&&"visible"!==t&&(e[t]=this.$listeners[t]);return e}},watch:{items:function(){this.forceUpdate(!1)},simpleArray:{handler:function(e){this.vscrollData.simpleArray=e},immediate:!0},direction:function(e){this.forceUpdate(!0)}},created:function(){this.$_updates=[],this.$_undefinedSizes=0,this.$_undefinedMap={}},activated:function(){this.vscrollData.active=!0},deactivated:function(){this.vscrollData.active=!1},methods:{onScrollerResize:function(){var e=this.$refs.scroller;e&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible:function(){this.$emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(e||this.simpleArray)&&(this.vscrollData.validSizes={}),this.$emit("vscroll:update",{force:!0})},scrollToItem:function(e){var t=this.$refs.scroller;t&&t.scrollToItem(e)},getItemSize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=this.simpleArray?null!=t?t:this.items.indexOf(e):e[this.keyField];return this.vscrollData.sizes[i]||0},scrollToBottom:function(){var e=this;if(!this.$_scrollingToBottom){this.$_scrollingToBottom=!0;var t=this.$el;this.$nextTick((function(){t.scrollTop=t.scrollHeight+5e3;var i=function i(){t.scrollTop=t.scrollHeight+5e3,requestAnimationFrame((function(){t.scrollTop=t.scrollHeight+5e3,0===e.$_undefinedSizes?e.$_scrollingToBottom=!1:requestAnimationFrame(i)}))};requestAnimationFrame(i)}))}}}},pt=mt,ft=(0,D.Z)(pt,ut,ht,!1,null,null,null),vt=ft.exports,bt={name:"DynamicScrollerItem",inject:["vscrollData","vscrollParent","vscrollResizeObserver"],props:{item:{required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},index:{type:Number,default:void 0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},computed:{id:function(){return this.vscrollData.simpleArray?this.index:this.item[this.vscrollData.keyField]},size:function(){return this.vscrollData.validSizes[this.id]&&this.vscrollData.sizes[this.id]||0},finalActive:function(){return this.active&&this.vscrollData.active}},watch:{watchData:"updateWatchData",id:function(){this.size||this.onDataUpdate()},finalActive:function(e){this.size||(e?this.vscrollParent.$_undefinedMap[this.id]||(this.vscrollParent.$_undefinedSizes++,this.vscrollParent.$_undefinedMap[this.id]=!0):this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=!1)),this.vscrollResizeObserver?e?this.observeSize():this.unobserveSize():e&&this.$_pendingVScrollUpdate===this.id&&this.updateSize()}},created:function(){var e=this;if(!this.$isServer&&(this.$_forceNextVScrollUpdate=null,this.updateWatchData(),!this.vscrollResizeObserver)){var t=function(t){e.$watch((function(){return e.sizeDependencies[t]}),e.onDataUpdate)};for(var i in this.sizeDependencies)t(i);this.vscrollParent.$on("vscroll:update",this.onVscrollUpdate),this.vscrollParent.$on("vscroll:update-size",this.onVscrollUpdateSize)}},mounted:function(){this.vscrollData.active&&(this.updateSize(),this.observeSize())},beforeDestroy:function(){this.vscrollParent.$off("vscroll:update",this.onVscrollUpdate),this.vscrollParent.$off("vscroll:update-size",this.onVscrollUpdateSize),this.unobserveSize()},methods:{updateSize:function(){this.finalActive?this.$_pendingSizeUpdate!==this.id&&(this.$_pendingSizeUpdate=this.id,this.$_forceNextVScrollUpdate=null,this.$_pendingVScrollUpdate=null,this.computeSize(this.id)):this.$_forceNextVScrollUpdate=this.id},updateWatchData:function(){var e=this;this.watchData?this.$_watchData=this.$watch("data",(function(){e.onDataUpdate()}),{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate:function(e){var t=e.force;!this.finalActive&&t&&(this.$_pendingVScrollUpdate=this.id),this.$_forceNextVScrollUpdate!==this.id&&!t&&this.size||this.updateSize()},onDataUpdate:function(){this.updateSize()},computeSize:function(e){var t=this;this.$nextTick((function(){if(t.id===e){var i=t.$el.offsetWidth,n=t.$el.offsetHeight;t.applySize(i,n)}t.$_pendingSizeUpdate=null}))},applySize:function(e,t){var i=Math.round("vertical"===this.vscrollParent.direction?t:e);i&&this.size!==i&&(this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=void 0),this.$set(this.vscrollData.sizes,this.id,i),this.$set(this.vscrollData.validSizes,this.id,!0),this.emitResize&&this.$emit("resize",this.id))},observeSize:function(){this.vscrollResizeObserver&&(this.vscrollResizeObserver.observe(this.$el.parentNode),this.$el.parentNode.addEventListener("resize",this.onResize))},unobserveSize:function(){this.vscrollResizeObserver&&(this.vscrollResizeObserver.unobserve(this.$el.parentNode),this.$el.parentNode.removeEventListener("resize",this.onResize))},onResize:function(e){var t=e.detail.contentRect,i=t.width,n=t.height;this.applySize(i,n)}},render:function(e){return e(this.tag,this.$slots["default"])}},gt=bt,St=(0,D.Z)(gt,st,at,!1,null,null,null),It=St.exports;function xt(e,t){e.component("".concat(t,"recycle-scroller"),dt),e.component("".concat(t,"RecycleScroller"),dt),e.component("".concat(t,"dynamic-scroller"),vt),e.component("".concat(t,"DynamicScroller"),vt),e.component("".concat(t,"dynamic-scroller-item"),It),e.component("".concat(t,"DynamicScrollerItem"),It)}var wt={version:"0.0.1",install:function(e,t){var i=Object.assign({},{installComponents:!0,componentsPrefix:""},t);for(var n in i)"undefined"!==typeof i[n]&&(pe[n]=i[n]);i.installComponents&&xt(e,i.componentsPrefix)}},yt=null;"undefined"!==typeof window?yt=window.Vue:"undefined"!==typeof i.g&&(yt=i.g.Vue),yt&&yt.use(wt);var Ct,Lt=i(80366),kt=function(){var e=this,t=e._self._c;return t("div",{ref:"inboxItem",class:["inbox-item","tab-focus",(0,ae.Z)({"inbox-border":!e.isString(e.inboxItem),"checked-item":!e.isString(e.inboxItem)&&e.isSelected,"is-sticky":e.isString(e.inboxItem),"split-view":e.isSplitView,"split-view-last-selected":e.splitViewSelected,"drag-selection":e.includedInDragSelection,"inbox-item-header":e.isString(e.inboxItem)},"normal-inbox-item-".concat(e.selectMailLabel.id),!e.isString(e.inboxItem)),e.isString(e.inboxItem)||e.inboxItem.threadHead.isUnread?"unread-item":"read-item"],style:{height:!e.isSplitView||e.isString(e.inboxItem)?"40px":"80px"},attrs:{draggable:e.isDraggable,tabindex:"0"},on:{contextmenu:function(t){t.stopPropagation(),t.preventDefault(),e.inboxItem.isPlain?e.handleHideActions():e.handleShowActions(t,e.inboxItem)},drag:e.handleDrag,dragstart:e.handleDragStart,dragend:e.handleDragEnd,focusin:e.handleFocusIn,focusout:e.handleFocusOut,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])||t.target!==t.currentTarget?null:(t.preventDefault(),e.getDetail.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.target!==t.currentTarget?null:(t.preventDefault(),e.getDetail.apply(null,arguments))}]}},[e.isString(e.inboxItem)?t("div",{staticClass:"inbox-item-title",attrs:{tabindex:"-1"}},[e._v(" "+e._s(e.CATEGORY_DATE_FORMAT_MAP_DISPLAYNAME[e.inboxItem.value])+" ")]):t("div",{staticClass:"inbox-item-regular",attrs:{tabindex:"-1"}},[t("div",{staticClass:"inbox-item-status"},[t("SvgIcon",{directives:[{name:"show",rawName:"v-show",value:e.attachmentWithError&&!e.starHover,expression:"attachmentWithError && !starHover"}],class:["alert-icon",{"split-view-last-selected":e.splitViewSelected,read:!e.inboxItem.threadHead.isUnread}],attrs:{iconClass:"triangle-alert"}}),"OUTBOX"===e.inboxItem.labelId||e.escrowActionsDisabled||e.groupActionsDisabled?e.escrowActionsDisabled?t("div",{staticClass:"escrow-outlined"},[t("svg-icon",{class:[{"split-view-last-selected":e.splitViewSelected}],attrs:{iconClass:"escrow"}})],1):e._e():t("zm-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:!e.attachmentWithError||e.starHover,expression:"!attachmentWithError || starHover"}],ref:"checkboxGroup",attrs:{"aria-label":"","zm-ta":"inbox-item-checkbox-"+e.inboxItem.threadId,tabindex:"-1"},on:{change:e.handleCheckedItemsChange},model:{value:e.checkedList,callback:function(t){e.checkedList=t},expression:"checkedList"}},[t("zm-checkbox",{ref:"checkbox",class:[{"split-view-last-selected":e.splitViewSelected}],attrs:{id:e.inboxItem.threadId,label:e.inboxItem.threadId,"aria-label":e.$t("accessibility.select"),tabindex:e.hasFocusWithin?"0":"-1"}},[e._v("   ")])],1)],1),t("div",{class:["inbox-item-content",{"display-unset":e.isSplitView,"inbox-item-content-group":e.inboxItem.labelId===e.groupLabel}],attrs:{role:"button"},on:{click:function(t){return t.preventDefault(),e.getDetail.apply(null,arguments)}}},[t("div",{class:["inbox-item-left",e.isString(e.inboxItem)||e.inboxItem.threadHead.isUnread?"unread-item":"read-item",{"split-view":e.isSplitView,"split-view-last-selected":e.splitViewSelected}]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.lastReadValid&&!e.isSplitView,expression:"lastReadValid && !isSplitView"}],staticClass:"inbox-item-last-read"},[e._v(" "+e._s(e.$t("list.lastRead"))+" ")]),t("div",{staticClass:"inbox-item-left-header"},[t("i",{directives:[{name:"show",rawName:"v-show",value:e.iconVisible.loading,expression:"iconVisible.loading"}],staticClass:"zm-icon-loading small"}),t("zm-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.iconVisible.star,expression:"iconVisible.star"}],attrs:{content:e.inboxItem.threadHead.isStarred?e.$t("operation.markAsUnstarred"):e.$t("operation.markAsStarred"),placement:"bottom",enterable:!1}},[t("svg-icon",{ref:"markStarOrUnstar",class:["tab-focus",{"empty-star":!e.inboxItem.threadHead.isStarred&&(e.starHover||e.hasFocusWithin),"split-view-last-selected":e.splitViewSelected}],attrs:{iconClass:e.inboxItem.threadHead.isStarred?"starred-colored":"starred","zm-ta":"inbox-item-"+(e.inboxItem.threadHead.isStarred?"remove-star":"star")+"-"+e.inboxItem.threadId,role:"button","aria-label":e.inboxItem.threadHead.isStarred?e.$t("operation.markAsUnstarred"):e.$t("operation.markAsStarred"),"aria-expanded":void 0,tabindex:e.starHover||e.hasFocusWithin?"0":"-1"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleMark(e.inboxItem,e.inboxItem.threadHead.isStarred?"UnStarred":"Starred","click")},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.handleMark(e.inboxItem,e.inboxItem.threadHead.isStarred?"UnStarred":"Starred"))}}})],1),t("Avatar",{directives:[{name:"show",rawName:"v-show",value:e.iconVisible.avatar,expression:"iconVisible.avatar"}],staticClass:"head-img",attrs:{email:e.getInboxItemFirstEmail,name:e.getInboxItemFirstName,tabindex:"-1"}}),t("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.iconVisible.draft,expression:"iconVisible.draft"}],staticClass:"draft-icon",attrs:{iconClass:"draft-filled"}})],1),t("div",{class:["inbox-item-left-name","much-hidden",{"split-view-last-selected":e.splitViewSelected}]},e._l(e.inboxItem.threadHead.userEmailStatusList,(function(i,n){return t("span",{key:n,style:{color:i.isDraft?"#E8173D":"",fontWeight:i.isUnread?"var(--text-bold)":"var(--text-normal)"}},e._l(e.senderInSearch(i.userEmail.displayName),(function(i,s){return t("span",{key:s},[i.searchTerm?t("span",{class:["highlight",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(i.searchTerm)+" ")]):t("span",{class:["unhighlight",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(i)+" ")]),t("span",{class:["unhighlight",{"split-view-last-selected":e.splitViewSelected}],style:{color:e.splitViewSelected?"var(--inbox-item-split-selected)":"var(--text-secondary)"}},[e._v(" "+e._s(n!==e.inboxItem.threadHead.userEmailStatusList.length-1?", ":"")+" ")])])})),0)})),0),e.showMessageCount?t("div",{class:["inbox-item-left-num",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" ("+e._s(e.getDisplayMessageCount())+") ")]):e._e()]),t("div",{staticClass:"inbox-item-right"},[t("div",{class:["content",{"display-unset":e.isSplitView}]},[e.isSplitView||e.isOutlook?e._e():t("LabelFlagsList",{attrs:{labels:e.labels,maxNumVisible:3}}),e.isLocalSearch(e.selectMailLabel.id)&&e.inboxItem.threadHead.subject?t("div",{class:["content-subject",!e.isString(e.inboxItem)&&e.inboxItem.threadHead.isUnread?"noRead":"",{"split-view-last-selected":e.splitViewSelected}]},e._l(e.subjectInSearch,(function(i,n){return t("span",{key:n},[i.searchTerm?t("span",{staticClass:"highlight"},[e._v(" "+e._s(i.searchTerm)+" ")]):t("span",{staticClass:"unhighlight"},[e._v(e._s(i))])])})),0):t("div",{class:["content-subject",!e.isString(e.inboxItem)&&e.inboxItem.threadHead.isUnread?"noRead":"",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(e.inboxItem.threadHead.subject?e.inboxItem.threadHead.subject:"(No Subject)")+" ")]),t("div",{class:["content-snippet-wrap"]},[e.isSplitView&&!e.isOutlook?t("LabelFlagsList",{attrs:{labels:e.labels,maxNumVisible:1}}):e._e(),e.isLocalSearch(e.selectMailLabel.id)&&!e.escrowActionsDisabled?t("div",{class:["content-snippet",{"split-view-last-selected":e.splitViewSelected}]},e._l(e.snippetInSearch,(function(i,n){return t("span",{key:n},[i.searchTerm?t("span",{class:["highlight",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(i.searchTerm)+" ")]):t("span",{class:["unhighlight",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(e.cleanSnippet(i))+" ")])])})),0):e.escrowActionsDisabled?e._e():t("div",{class:["content-snippet",{"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(e.cleanSnippet(e.filterMailSnippet(e.inboxItem.threadHead.snippet)))+" ")])],1)],1),t("div",{staticClass:"extras"},[t("div",{staticClass:"icons"},[e.inboxItem.threadHead.hasAttachment?t("svg-icon",{class:["attachment-icon",{"split-view-last-selected":e.splitViewSelected,read:!e.inboxItem.threadHead.isUnread}],attrs:{"zm-ta":"inbox-item-attachment-"+e.inboxItem.threadId,iconClass:e.includeCalendarEvent?"calendar-event":"clip"}}):e._e(),e.inboxItem.labelId===e.scheduledLabel?t("svg-icon",{class:["scheduled-time-icon",{"split-view-last-selected":e.splitViewSelected}],attrs:{iconClass:"scheduled","zm-ta":"inbox-item-scheduled-"+e.inboxItem.threadId}}):e._e()],1),e.timestampVisible?t("div",{class:["timestamp",e.inboxItem.threadHead.isUnread&&"timestamp__unread",{"timestamp-hidden":!e.escrowActionsDisabled&&!e.groupActionsDisabled,"scheduled-time":e.inboxItem.labelId===e.scheduledLabel,"split-view-last-selected":e.splitViewSelected}]},[e._v(" "+e._s(e.formatTime(e.inboxItem.threadHead.date))+" ")]):e._e(),e.actionButtonVisible?t("div",{class:["item-action-wrap",{"split-view-last-selected":e.splitViewSelected}]},[e._l(e.visibleActions,(function(i){return t("span",{key:i.id,staticClass:"action-button-wrap"},[t("zm-tooltip",{attrs:{content:i.label,placement:i.tooltipPlacement||"bottom",disabled:e.displayActionTooltip,enterable:!1,tabindex:"0"}},[i.iconClass?t("svg-icon",{attrs:{iconClass:i.iconClass,className:"label-btn-icon tab-focus",role:"button","aria-label":i.label,"aria-expanded":void 0,"zm-ta":i.zmTa},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),i["do"](e.inboxItem)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.stopPropagation(),t.preventDefault(),i["do"](e.inboxItem))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),i["do"](e.inboxItem))}]}}):t("zm-button",{attrs:{size:"mini","zm-ta":i.zmTa,"aria-expanded":void 0},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),i["do"](e.inboxItem)}}},[e._v(e._s(i.label))])],1)],1)})),e.moreMenuActions.length&&!e.isSplitView?[t("zm-dropdown",{staticClass:"action-button-wrap",attrs:{placement:"bottom-start"},on:{command:e.onMoreMenuCommand,"visible-change":e.onMoreMenuVisibleChange}},[t("span",{staticClass:"inbox-item-more-menu-btn tab-focus",attrs:{tabindex:"0","aria-label":e.$t("common.moreOptions")}},[t("svg-icon",{attrs:{iconClass:"more-horizontal"}})],1),t("zm-dropdown-menu",{staticClass:"inbox-item-more-menu-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.moreMenuActions,(function(i){return t("zm-dropdown-item",{key:i.id,attrs:{"zm-ta":i.zmTa,divided:i.divided,command:i["do"]}},[e._v(e._s(i.label))])})),1)],1)]:e._e()],2):e._e()])])])]),t("div",{ref:"dragImageOverride",style:{opacity:"0"}},[e._v(" ")])])},$t=[],Tt=(i(27072),i(67694),i(96920),i(17368),i(24471),i(83264)),_t=i(3078),Dt=i(33298),Et=i(71951),Mt=i(38017),At=c.Business.getListItemActions,Rt=c.Enums.SystemDefinedMailLabelIds,Zt=c.Enums.EMAIL_PROVIDER,zt=c.Enums.MAIL_ACTIONS,Ot=[zt.SHARE_TO_CHAT,zt.SCHEDULE_MEETING,zt.HIDE_FROM_DELEGATES,zt.SHOW_TO_DELEGATES],Ht={components:{SvgIcon:g.Z,LabelFlagsList:_t.Z,Avatar:Dt.Z},props:{isLoadingDetail:{type:Boolean,default:!1},inboxItem:{type:[Object,String]},displayActionTooltip:Boolean},data:function(){return{checkedList:[],attachments:[],starHover:!1,hasFocusWithin:!1,CATEGORY_DATE_FORMAT_MAP_DISPLAYNAME:Et.Di,actionButtonVisible:!1,moreMenuDropdownVisible:!1,originalScreenX:0,originalScreenY:0,originalClientX:0,originalClientY:0}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["mailLabels","typeOfEmail","userProfile","searchString","inSearching","selectMailLabel","scaleRadio","isSplitView","showSplitDefault","splitViewSelectedMails","draggedEmails"])),(0,u.rn)({isCalendarEnabled:function(e){return e.userProfile.isCalendarEnabled||!1},enableShareToChat:function(e){var t;return e.features.enableShare2Chat&&(null===(t=e.userProfile)||void 0===t?void 0:t.enableShareToChat)},isDelegated:function(e){return e.userProfile.isDelegated}})),(0,u.rn)("inbox",["lastReadInboxThreadId"])),(0,u.Se)(["isOutlook"])),(0,u.Se)("inbox",["selectedInboxThreadIds"])),(0,u.Se)("delegate",{delegates:"getDelegateList"})),{},{isDraggable:function(){return![Rt.PRIVATE,Rt.GROUP_APPROVAL,Rt.ESCROW,Rt.OUTBOX].includes(this.selectMailLabel.id)&&!this.isString(this.inboxItem)},timestampVisible:function(){return!this.actionButtonVisible||0===this.actions.length},includeCalendarEvent:function(){var e,t;return"None"!==(null===(e=this.inboxItem)||void 0===e||null===(t=e.threadHead)||void 0===t?void 0:t.calendarType)},includedInDragSelection:function(){return this.draggedEmails.includes(this.inboxItem.threadId)},splitViewSelected:function(){var e;return!(!this.$store.state.isSplitView||!this.$store.state.splitViewSelectedMails)&&(this.isSplitView&&(null===(e=this.$store.state.splitViewSelectedMails[this.$store.state.selectMailLabel.id])||void 0===e?void 0:e.threadId)===this.inboxItem.threadId)},searchTermObj:function(){return(0,ue.gE)(this.searchString)},senderInSearch:function(){var e=this;return this.searchString?function(t){return"[Draft]"===t||t.includes("Drafts]")?[t]:(0,ue._k)(t,[].concat((0,se.Z)(e.searchTermObj["default"]),(0,se.Z)(e.searchTermObj.from)))}:function(e){return[e]}},subjectInSearch:function(){var e,t,i,n;return null!==(e=this.inboxItem)&&void 0!==e&&null!==(t=e.threadHead)&&void 0!==t&&t.subject?(0,ue._k)(this.inboxItem.threadHead.subject,[].concat((0,se.Z)(this.searchTermObj["default"]),(0,se.Z)(this.searchTermObj.subject))):[null===(i=this.inboxItem)||void 0===i||null===(n=i.threadHead)||void 0===n?void 0:n.subject]},snippetInSearch:function(){var e,t,i,n;return null!==(e=this.inboxItem)&&void 0!==e&&null!==(t=e.threadHead)&&void 0!==t&&t.snippet?(0,ue._k)(this.filterMailSnippet(this.inboxItem.threadHead.snippet),this.searchTermObj["default"]):[this.filterMailSnippet(null===(i=this.inboxItem)||void 0===i||null===(n=i.threadHead)||void 0===n?void 0:n.snippet)]},labels:function(){var e=this;return this.inboxItem.threadHead.showLabelIds.filter((function(t){return e.userLabelIdNameMap.has(t)}))},userLabelIdNameMap:function(e){var t=e.mailLabels,i=e.isGmail,n=t.filter((function(e){return!e.isSystem||(0,ue["in"])(e.id)}));return new Map(n.map((function(e){var t=e.displayName;return i&&(t=e.name),[e.id,t]})))},getInboxItemFirstName:function(){var e=this.inboxItem.threadHead.userEmailStatusList.filter((function(e){return!/^\[(\d+ Drafts|Draft)\]$/.test(e.userEmail.displayName)}));return e.length>0?e[0].userEmail.displayName.toUpperCase():""},getInboxItemFirstEmail:function(){var e=this.inboxItem.threadHead.userEmailStatusList.filter((function(e){return"[Draft]"!==e.userEmail.displayName}));return e.length>0?e[0].userEmail.emailAddr:""},cachedUserLabels:function(e){var t=e.mailLabels;return t.filter((function(e){return!e.isSystem}))},userTimeZone:function(e){var t=e.userProfile;return t.userTimeZone},archiveStatus:function(){var e;return(0,ue.XP)(null===(e=this.inboxItem)||void 0===e?void 0:e.labelId)},lastReadValid:function(){return this.lastReadInboxThreadId===this.inboxItem.threadId&&"DRAFT"!==this.inboxItem.labelId&&"OUTBOX"!==this.inboxItem.labelId},canMoveToInbox:function(){var e=[Rt.INBOX,Rt.SPAM,Rt.DRAFT];return!e.includes(this.inboxItem.labelId)&&!this.labels.includes(Rt.INBOX)},attachmentWithError:function(e){var t,i=e.inboxItem,n=["DRAFT"],s=n.indexOf(i.labelId)>-1,a=this.checkedList.indexOf(i.threadId)>-1,r=null===(t=i.threadHead.attachmentList)||void 0===t?void 0:t.some((function(e){return"Error"===e.downloadStatus}));return s&&r&&!a},isSelected:function(){return this.selectedInboxThreadIds.includes(this.inboxItem.threadId)},enableActions:function(){return!this.isNoActionFolder(this.inboxItem.labelId)},escrowLabel:function(){return c.Enums.SystemDefinedMailLabelIds.ESCROW},scheduledLabel:function(){return c.Enums.SystemDefinedMailLabelIds.USER_SCHEDULED},draftLabel:function(){return c.Enums.SystemDefinedMailLabelIds.DRAFT},groupLabel:function(){return c.Enums.SystemDefinedMailLabelIds.GROUP_APPROVAL},isSelectedTrashLabel:function(){return this.selectMailLabel.id===Rt.TRASH},escrowActionsDisabled:function(e){var t=e.escrowLabel;return this.disableActions(t)},groupActionsDisabled:function(e){var t=e.groupLabel;return this.disableActions(t)},showToDelegateDisabled:function(){var e;return!!this.isDelegated||this.inboxItem.labelId!==Rt.PRIVATE&&!(null!==(e=this.inboxItem.threadHead)&&void 0!==e&&e.showLabelIds.includes(Rt.PRIVATE))},showDeleteForever:function(){return(!this.isOutlook||this.inboxItem.labelId!==Rt.TRASH)&&!(this.inboxItem.labelId===Rt.TRASH&&this.typeOfEmail!==Zt.ZMAIL)},showMessageCount:function(){var e=this.inboxItem.msgIds&&this.inboxItem.msgIds.length>1;return this.isOutlook?e&&this.inboxItem.threadHead.unreadMsgCnt:e},iconVisible:function(e){var t=e.inboxItem,i=e.isLoadingDetail,n=e.isSplitView,s=e.starHover,a=e.hasFocusWithin,r=e.isNoActionFolder,o=e.escrowActionsDisabled,l=e.groupActionsDisabled,c=e.getInboxItemFirstEmail,d=e.getInboxItemFirstName,u=t.labelId!==Rt.OUTBOX&&i&&!n,h=(t.threadHead.isStarred||s||a)&&!r(t.labelId)&&!o&&!l,m=c&&d;return{loading:u,star:!u&&h,avatar:!u&&!h&&m,draft:!u&&!h&&!m}},actionConfigMap:function(){var e,t,i,n=this,s=(i={},(0,ae.Z)(i,zt.MOVE_TO_INBOX,{label:this.$t("operation.moveToInbox"),iconClass:"move-to-inbox",zmTa:"inbox-item-move-to-inbox-".concat(this.inboxItem.threadId),disabled:this.isSplitView||this.labels.includes(Rt.INBOX),do:this.handleMove}),(0,ae.Z)(i,zt.DELETE,{label:this.isSelectedTrashLabel?this.$t("operation.deleteForever"):this.$t("operation.delete"),iconClass:"delete",zmTa:"inbox-item-delete-".concat(this.inboxItem.threadId),do:this.handleDelete}),(0,ae.Z)(i,zt.ARCHIVE,{label:this.$t("operation.archive"),iconClass:"archive",zmTa:"inbox-item-archive-".concat(this.inboxItem.threadId),disabled:!(0,ue.XP)(null===(e=this.inboxItem)||void 0===e?void 0:e.labelId)||this.isSplitView,do:this.handleArchive}),(0,ae.Z)(i,zt.UNREAD,{label:this.inboxItem.threadHead.isUnread?this.$t("operation.markAsRead"):this.$t("operation.markAsUnread"),iconClass:this.inboxItem.threadHead.isUnread?"read":"unread",zmTa:"inbox-item-".concat(this.inboxItem.threadHead.isUnread?"mark-as-read":"mark-as-unread","-").concat(this.inboxItem.threadId),disabled:this.isSplitView,do:function(){var e=n.inboxItem.threadHead.isUnread?"Read":"UnRead";n.handleMark(n.inboxItem,e)}}),(0,ae.Z)(i,zt.NOT_SPAM,{label:this.$t("operation.notSpam"),iconClass:"spam",zmTa:"inbox-item-remove-from-spam-".concat(this.inboxItem.threadId),disabled:this.isSplitView,do:this.handleSpam}),(0,ae.Z)(i,zt.SHARE_TO_CHAT,{label:this.$t("operation.sendCopyToChat"),zmTa:"inbox-item-share-to-chat-".concat(this.inboxItem.threadId),disabled:!this.enableShareToChat||!this.inboxItem.msgIds||1!==this.inboxItem.msgIds.length,do:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.enableShareToChat){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,Mt.cG)(n.inboxItem.threadId,n.inboxItem.labelId);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),(0,ae.Z)(i,zt.SCHEDULE_MEETING,{label:this.$t("operation.scheduleMeeting"),zmTa:"inbox-item-schedule-meeting-".concat(this.inboxItem.threadId),disabled:!this.isCalendarEnabled||!this.inboxItem.msgIds||1!==this.inboxItem.msgIds.length,do:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.isCalendarEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,Mt.Xs)(n.inboxItem.threadId,n.inboxItem.labelId);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}),(0,ae.Z)(i,zt.HIDE_FROM_DELEGATES,{label:this.$t("operation.hideFromDelegates"),zmTa:"inbox-item-hide-from-delegates-".concat(this.inboxItem.threadId),disabled:(null===(t=this.inboxItem.threadHead)||void 0===t?void 0:t.showLabelIds.includes(Rt.PRIVATE))||this.isDelegated,do:function(){(0,Mt.OJ)([n.inboxItem],n.selectMailLabel.id)}}),(0,ae.Z)(i,zt.SHOW_TO_DELEGATES,{label:this.$t("operation.showToDelegates"),zmTa:"inbox-item-show-to-delegates-".concat(this.inboxItem.threadId),disabled:this.showToDelegateDisabled,do:function(){(0,Mt.b_)([n.inboxItem],n.selectMailLabel.id)}}),(0,ae.Z)(i,zt.CANCEL_SEND,{label:this.$t("operation.cancelScheduled"),zmTa:"inbox-item-cancel-schedule-send-".concat(this.inboxItem.threadId),do:this.cancelScheduledSend}),(0,ae.Z)(i,zt.DISCARD_DRAFT,{label:this.$t("operation.discardDraft"),zmTa:"inbox-item-discard-draft-".concat(this.inboxItem.threadHead),do:this.discardDraft}),i);return s},actions:function(){var e=this,t=At(this.typeOfEmail,this.selectMailLabel);return t.map((function(t){var i=e.actionConfigMap[t]||{label:e.$t("common.unknown"),do:function(){}};return(0,l.Z)((0,l.Z)({},i),{},{id:t})}))},visibleActions:function(){return this.actions.filter((function(e){return!Ot.includes(e.id)&&!e.disabled}))},moreMenuActions:function(){var e=this.actions.filter((function(e){return Ot.includes(e.id)&&!e.disabled})),t=e.findIndex((function(e){return[zt.HIDE_FROM_DELEGATES,zt.SHOW_TO_DELEGATES].includes(e.id)}));if(t>0){var i=e[t];i.divided=!0}return e}}),watch:{scaleRadio:function(e){this.$refs.inboxItem.style.zoom="".concat(100*e,"%")},selectedInboxThreadIds:function(e){this.checkedList=e}},created:function(){this.checkedList=this.selectedInboxThreadIds||[]},mounted:function(){!this.isString(this.inboxItem)&&this.$refs.checkbox&&this.$refs.checkbox.$el.addEventListener("mouseup",this.checkboxSelect),!this.isString(this.inboxItem)&&this.$refs.inboxItem&&(this.$refs.inboxItem.addEventListener("mouseenter",this.starredHover),this.$refs.inboxItem.addEventListener("mouseleave",this.starredUnhover)),this.$refs.inboxItem&&(this.$refs.inboxItem.style.zoom="".concat(100*this.scaleRadio,"%"))},beforeDestroy:function(){!this.isString(this.inboxItem)&&this.$refs.checkbox&&this.$refs.checkbox.$el.removeEventListener("mouseup",this.checkboxSelect),!this.isString(this.inboxItem)&&this.$refs.inboxItem&&(this.$refs.inboxItem.removeEventListener("mouseenter",this.starredHover),this.$refs.inboxItem.removeEventListener("mouseleave",this.starredUnhover))},methods:(0,l.Z)((0,l.Z)({},(0,u.OI)({setDraggedEmails:"setDraggedEmails",setDragImageCoords:"setDragImageCoords",setDragType:"setDragType"})),{},{disableActions:function(e){return e===this.inboxItem.labelId||this.inboxItem.threadHead.showLabelIds.includes(e)},handleFocusIn:function(e){var t=this.$refs.inboxItem;(t===e.target||t.contains(e.target))&&(this.actionButtonVisible=!0,this.hasFocusWithin=!0)},handleFocusOut:function(e){var t=this.$refs.inboxItem;t===e.relatedTarget||t.contains(e.relatedTarget)||(!this.moreMenuDropdownVisible&&(this.actionButtonVisible=!1),this.hasFocusWithin=!1)},handleDrag:function(e){var t=e.screenX-this.originalScreenX,i=e.screenY-this.originalScreenY,n=this.originalClientX+t,s=this.originalClientY+i;this.setDragImageCoords([n,s])},handleDragStart:function(e){var t=this.isSelected?this.selectedInboxThreadIds:[this.inboxItem.threadId];this.setDragType("messages"),this.setDraggedEmails(t),e.dataTransfer.allowedEffect="move";var i=this.$refs.dragImageOverride;this.originalScreenX=e.screenX,this.originalScreenY=e.screenY,this.originalClientX=e.clientX,this.originalClientY=e.clientY,e.dataTransfer.setDragImage(i,0,0)},handleDragEnd:function(e){this.setDraggedEmails([]),this.setDragType(""),this.setDragImageCoords([-1,-1])},checkboxSelect:function(e){var t=this;e.shiftKey&&e.preventDefault(),setTimeout((function(){t.$refs.checkbox.$refs.input.blur(),t.$refs.checkboxGroup.$el.blur()}))},onMoreMenuVisibleChange:function(e){this.moreMenuDropdownVisible=e,e||(this.actionButtonVisible=!1)},onMoreMenuCommand:function(e){"function"===typeof e&&e()},starredHover:function(e){this.starHover=!0,this.actionButtonVisible=!0},starredUnhover:function(e){this.starHover=!1,this.moreMenuDropdownVisible||(this.actionButtonVisible=!1)},substringSearch:function(e,t){var i=new Array(e.length).fill("0"),n=/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/,s=[];t.forEach((function(e){var t=e.split(n);s.push(t)})),s=s.flat(),s.forEach((function(t){var n=(0,se.Z)(e.matchAll(new RegExp(t,"gi"))).map((function(e){return e.index}));n.forEach((function(e){for(var n=e;n<e+t.length;n++)i[n]="1"}))})),i=i.join("").match(/(.)\1*/g);var a=0,r=[];return i.forEach((function(t){"0"===t[0]?r.push(e.slice(a,a+t.length)):r.push({searchTerm:e.slice(a,a+t.length)}),a+=t.length})),r},handleMove:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.$emit("handleMove",e);case 2:case"end":return i.stop()}}),i)})))()},handleDelete:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.$emit("handleDelete",e);case 1:case"end":return i.stop()}}),i)})))()},handleArchive:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.$emit("handleArchive",e);case 1:case"end":return i.stop()}}),i)})))()},handleSpam:function(e){this.$emit("handleSpam",e)},handleCheckedItemsChange:function(e){this.$emit("handleCheckedItemsChange",{threadId:this.inboxItem.threadId,status:e.length>0})},isString:function(e){return!!e.isPlain},formatTime:function(e){if("undefined"!==typeof e){var t,i=1e3*e,n={Upcoming:"LLL d",Today:"t","This Month":"LLL d","This Year":"LLL d"},s=(0,ue.Gt)(i),a=new Date(i).getTime(),r=new Date(Date.now()).getTime(),o=Tt.ou.fromMillis(i).hasSame(Tt.ou.now(),"day");return t="Upcoming"===s&&a>r&&o?"t":n[s]||"L/d/kk",Tt.ou.fromMillis(i).setZone(this.userTimeZone).toFormat(t)}return this.$t("time.notValidTime")},getDetail:function(){this.$emit("handleShowDetail",this.inboxItem),this.$metric.report("inbox_open_item",{labelId:this.inboxItem.labelId,msgId:this.inboxItem.threadId})},handleHideActions:function(){this.$emit("handleHideActions")},handleShowActions:function(e,t){this.isNoActionFolder(t.labelId)||this.$emit("handleShowActions",{e:e,item:t})},handleMark:function(e,t){var i=arguments,n=this;return(0,o.Z)((0,r.Z)().mark((function s(){var a;return(0,r.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:a=i.length>2&&void 0!==i[2]?i[2]:"",n.$emit("handleMark",{item:e,type:t}),"click"===a&&setTimeout((function(){["UnStarred","Starred"].includes(t)?n.$refs.markStarOrUnstar.$el.blur():["Read","UnRead"].includes(t)&&n.$refs.markReadOrUnread.$el.blur()}));case 3:case"end":return s.stop()}}),s)})))()},isLocalSearch:function(e){return x.Z.isLocalSearch(e)},filterMailSnippet:function(e){return(0,ue.mM)(e)},cleanSnippet:function(e){return(0,ue.X4)(e)},cancelScheduledSend:function(e){this.$emit("handleCancelScheduledSend",e,!0)},discardDraft:function(e){this.$emit("setSelectItem",e),this.$emit("handleDiscardDrafts",!1),this.$emit("setSelectItem",{})},isNoActionFolder:function(e){return[c.Enums.SystemDefinedMailLabelIds.OUTBOX,c.Enums.SystemDefinedMailLabelIds.USER_SCHEDULED,c.Enums.SystemDefinedMailLabelIds.ESCROW,c.Enums.SystemDefinedMailLabelIds.DRAFT,c.Enums.SystemDefinedMailLabelIds.GROUP_APPROVAL].includes(e)},getDisplayMessageCount:function(){return this.isOutlook?this.inboxItem.threadHead.unreadMsgCnt:this.inboxItem.msgIds.length}})},Pt=Ht,Nt=(0,D.Z)(Pt,kt,$t,!1,null,"75ffcbc0",null),Ft=Nt.exports,Ut=function(){var e=this,t=e._self._c;return t("div",{staticClass:"category-tabs"},[e.showSelectionCount?t("div",{class:["tab","selection-count"]},[t("span",{staticClass:"tab-name"},[e._v(e._s(e.getSelectionCountString()))])]):e.showTabs?e._t("default",(function(){return e._l(e.visibleCategoryTabIds,(function(i){return t("div",{key:i,class:["tab",{selected:i===e.selectedTabId}],attrs:{"zm-ta":"inbox-toggle-category-"+e.getName(i).toLowerCase()},on:{click:function(t){return e.selectTabId(i)}}},[t("span",{staticClass:"tab-name"},[e._v(e._s(e.getName(i)))]),e.getTabCount(i)&&!e.isRedundantCountInfo(i)?t("span",{staticClass:"tab-count"},[e._v(" "+e._s(e.getTabCount(i))+" ")]):e._e()])}))})):t("div",{staticClass:"tab selected"},[t("span",{staticClass:"tab-name"},[e._v(e._s(e.getName(e.selectedTabId)))]),e.getTabCount(e.selectedTabId)&&!e.isRedundantCountInfo(e.selectedTabId)?t("span",{staticClass:"tab-count"},[e._v(" "+e._s(e.getTabCount(e.selectedTabId))+" ")]):e._e()])],2)},Vt=[],Bt=c.Enums.SystemDefinedCategoryIds,Gt=c.Enums.SystemDefinedMailLabelIds,Wt=c.Business.labelUtils,jt=c.Business.formatNestedLabel,Xt={name:"CategoryTabs",props:{selectionCount:{type:Number,default:0}},data:function(){return{selectedTabId:"",categoryIds:Object.values(Bt),omittedCategoryIds:[Bt.GROUP_APPROVAL]}},computed:(0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["mailLabels","selectMailLabel","GetThreadHead","inFilters"])),(0,u.Se)(["isGmail","isZmail","isOutlook","labelNameInfo"])),{},{visibleCategoryTabIds:function(){var e=this,t=this.categoryIds.filter((function(t){return!e.omittedCategoryIds.includes(t)})).filter((function(t){return e.mailLabels.find((function(e){return e.id===t}))})),i=Gt.INBOX;return[i].concat((0,se.Z)(t))},showSelectionCount:function(){return this.selectionCount>0},showTabs:function(){return this.visibleCategoryTabIds.includes(this.selectedTabId)}}),watch:{selectMailLabel:{handler:function(e){e&&!this.inFilters&&(this.selectedTabId=e.id)},immediate:!0},selectedTabId:function(e){var t=this.mailLabels.find((function(t){return t.id===e}));t&&(this.$store.commit("clearSearchResults"),this.$store.commit("changeFilterStatus",!1),this.$store.commit("changeInFilters",!1),this.$store.commit("changeSelectMailLabel",t))}},methods:{selectTabId:function(e){this.selectedTabId=e,this.$metric.report("inbox_toggle_category",{tabId:e})},getSelectionCountString:function(){var e=this.getCount(this.selectedTabId,!0),t=this.selectionCount===e,i=t?"".concat(this.$t("common.all")," ").concat(e):this.selectionCount;return"".concat(this.$t("common.selected")," (").concat(i,")")},getLabelFromId:function(e){return this.mailLabels.find((function(t){return t.id===e}))},getTabCount:function(e){var t=this.getCount(e);return t>0?"".concat(t):""},isRedundantCountInfo:function(e){return e===Gt.INBOX&&!this.isZmail||e===Gt.DRAFT},getCount:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e===Et.v8){var i=this.GetThreadHead[Et.v8];return Object.keys(i).length}var n,s=this.getLabelFromId(e);return s?Wt.HIDE_COUNT_LABELS.includes(e)?0:t?null===(n=s.count)||void 0===n?void 0:n.threadsTotal:s.displayNum:0},getName:function(e){if(e===Et.v8)return this.$t("search.searchResults");var t=this.getLabelFromId(e);return t?this.getLabelName(t):""},getLabelName:function(e){if(e.isSystem){var t,i=this.isOutlook?w.Z:I.Z;return this.$t(null===(t=i[e.id])||void 0===t?void 0:t.displayName)||this.$t("common.unknown")}return this.isGmail?jt(e.name,{maxLen:Number.MAX_VALUE}):c.Utils.isDecryptFailed(e.labelDecryptionStatus)?this.$t("label.encryptedLabel"):(null===(n=this.labelNameInfo[e.id])||void 0===n?void 0:n.labelDisplayFullName)||jt(e.name,{maxLen:Number.MAX_VALUE});var n}}},Kt=Xt,Jt=(0,D.Z)(Kt,Ut,Vt,!1,null,"16fc5f49",null),Yt=Jt.exports,qt=function(){var e=this,t=e._self._c;return t("div",[e.currentLabelId===e.escrowLabel?t("div",{staticClass:"control-header"}):t("div",{ref:"controlHeader",staticClass:"control-header"},[e.currentLabelId!==e.groupLabel?t("zm-dropdown",{ref:"checkAll",attrs:{trigger:"click",role:"presentation",placement:"bottom"},on:{command:e.handleCheckMore}},[t("div",{staticClass:"check-all-container tab-focus",attrs:{"aria-label":e.$t("accessibility.checkAll"),tabindex:"0",role:"button"}},[t("zm-checkbox",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_all",arg:"inbox_header_action_all"}],attrs:{tabindex:"-1",indeterminate:e.isIndeterminate,controls:Object.keys(e.GetThreadHead).join(" "),"zm-ta":"inbox-control-header-check-all"},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}}),t("span",{staticClass:"zm-dropdown-link",attrs:{tabindex:"-1"}},[t("svg-icon",{attrs:{iconClass:"triangle-down"}})],1)],1),t("zm-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_all",arg:"inbox_header_action_all"}],staticClass:"clearfix",attrs:{command:"All","zm-ta":"inbox-control-header-all"}},[t("span",[e._v(e._s(e.$t("select.all")))])]),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_none",arg:"inbox_header_action_none"}],staticClass:"clearfix",attrs:{command:"None","zm-ta":"inbox-control-header-none"}},[t("span",[e._v(e._s(e.$t("select.none")))])]),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_read",arg:"inbox_header_action_read"}],staticClass:"clearfix",attrs:{command:"Read","zm-ta":"inbox-control-header-read"}},[t("span",[e._v(e._s(e.$t("select.read")))])]),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_unread",arg:"inbox_header_action_unread"}],staticClass:"clearfix",attrs:{command:"Unread","zm-ta":"inbox-control-header-unread"}},[t("span",[e._v(e._s(e.$t("select.unread")))])]),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_stared",arg:"inbox_header_action_stared"}],staticClass:"clearfix",attrs:{command:"Starred","zm-ta":"inbox-control-header-starred"}},[t("span",[e._v(e._s(e.$t("select.starred")))])]),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_header_action_unstarred",arg:"inbox_header_action_unstarred"}],staticClass:"clearfix",attrs:{command:"Unstarred","zm-ta":"inbox-control-header-unstarred"}},[t("span",[e._v(e._s(e.$t("select.unstarred")))])])],1)],1):e._e(),e.searchFiltersVisible?t("SearchFilters",{attrs:{"zm-ta":"search-filters",selected:e.selectedSearchFilters},on:{"update:selected":e.updateSelectedSearchFilters}}):e._e(),e.selectedInboxItems.length>0?t("ActionBar",{attrs:{actions:e.actions[0],menuActions:e.actions[1],selectedInboxItems:e.selectedInboxItems,widthPerButton:100,widthBuffer:50}}):e._e(),e.isPaginated?t("div",{staticClass:"page-index"},[e._v(" "+e._s("".concat(e.currentPage," of ").concat(e.pageCount||"many"))+" ")]):e._e(),e.isPaginated?t("div",{staticClass:"inbox-page-nav"},[t("zm-tooltip",{staticClass:"tab-focus",attrs:{content:"'Previous Page'",placement:"bottom"}},[t("div",{class:e.noMorePrev||e.isLoading?"pagePrev-disabled":"pagePrev",on:{click:function(t){t.stopPropagation(),t.preventDefault(),!e.noMorePrev&&!e.isLoading&&e.prevPage()}}},[t("i",{staticClass:"zm-icon-left"})])]),t("zm-tooltip",{staticClass:"tab-focus",attrs:{content:"Next Page",placement:"bottom"}},[t("div",{class:e.noMoreNext||e.isLoading?"pageNext-disabled":"pageNext",on:{click:function(t){t.stopPropagation(),t.preventDefault(),!e.noMoreNext&&!e.isLoading&&e.nextPage()}}},[t("i",{staticClass:"zm-icon-right"})])])],1):e._e()],1)])},Qt=[],ei=i(3664),ti=function(){var e=this,t=e._self._c;return t("zm-checkbox-group",{attrs:{buttonstyle:""},on:{change:function(t){return e.$emit("change",t)}},model:{value:e.selectedComputed,callback:function(t){e.selectedComputed=t},expression:"selectedComputed"}},e._l(e.filters,(function(i){var n=i.id,s=i.label,a=i.zmTa;return t("zm-checkbox",{key:n,attrs:{label:n,"zm-ta":a,"aria-label":s}},[e._v(" "+e._s(s)+" ")])})),1)},ii=[],ni={name:"SearchFilters",props:{selected:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}}},data:function(){return{defaultOptions:[{id:"hasAttachment",label:this.$t("search.hasAttachment"),zmTa:"inbox-search-attachment"},{id:"starred",label:this.$t("search.starred"),zmTa:"inbox-search-starred"},{id:"fromMe",label:this.$t("search.fromMe"),zmTa:"inbox-search-from-me"}],selectedData:[]}},computed:{filters:function(){return this.options.length?this.options:this.defaultOptions},selectedComputed:{get:function(){return this.selected},set:function(e){this.$emit("update:selected",e)}}},watch:{selected:function(e){this.selectedData=e}},mounted:function(){this.selectedData=this.selected}},si=ni,ai=(0,D.Z)(si,ti,ii,!1,null,"00560806",null),ri=ai.exports,oi=c.Enums.SystemDefinedMailLabelIds,li=c.Enums.SystemDefinedCategoryIds,ci={None:0,Some:1,All:2},di={components:{ActionBar:ei.Z,SearchFilters:ri},props:{isLoading:{type:Boolean,default:!1},actions:{type:Array,default:function(){return[]}}},data:function(){return{checkAll:!1,isIndeterminate:!1}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["ListThreads","selectMailLabel","inFilters","inSearching","currentPage","isLastPage","mailLabels","maxNumberMailsPerRequest","isPaginated","inSearching"])),(0,u.rn)("search",["selectedSearchFilters"])),(0,u.Se)(["isGmail","isZmail","isOutlook"])),(0,u.Se)("inbox",["selectedInboxThreadIds","inboxSectionVisible"])),{},{enableQuickFilter:function(){var e,t;if(this.inboxSectionVisible)return!1;if(this.inFilters)return!0;if(this.inSearching)return!1;var i=!(null!==(e=this.selectMailLabel)&&void 0!==e&&e.isSystem),n=this.isZmail?[li.CATEGORY_PERSONAL,li.CATEGORY_SOCIAL]:[],s=[oi.INBOX,oi.STARRED,oi.SPAM,oi.TRASH,oi.BLOCKED].concat(n).includes(null===(t=this.selectMailLabel)||void 0===t?void 0:t.id);return i||s},currentLabelId:function(){var e;return this.checkAll=!1,null===(e=this.selectMailLabel)||void 0===e?void 0:e.id},currentThreadList:function(){return this.ListThreads&&this.ListThreads[this.currentLabelId]&&this.ListThreads[this.currentLabelId].ListThreads&&this.ListThreads[this.currentLabelId].ListThreads.threadIds||[]},selectedInboxItems:function(){var e=this;return this.selectedInboxThreadIds.filter((function(t){return e.GetThreadHead[t]})).map((function(t){return{groupId:t,msgIds:e.GetThreadHead[t].msgIds}}))},selectedStatus:function(){var e,t=this.currentThreadList;return this.inboxSectionVisible&&null!==(e=this.$parent)&&void 0!==e&&e.$refs.inboxSections&&(t=this.$parent.$refs.inboxSections.getCurrentVisibleMails().map((function(e){return e.threadId}))),t.length<1||this.selectedInboxItems.length<1?ci.None:this.selectedInboxItems.length===Object.keys(this.GetThreadHead).length?ci.All:ci.Some},GetThreadHead:function(){var e;return this.inboxSectionVisible&&null!==(e=this.$parent)&&void 0!==e&&e.$refs.inboxSections?this.$parent.$refs.inboxSections.getCurrentVisibleMails().reduce((function(e,t){return e[t.threadId]=t,e}),{}):this.$store.state.GetThreadHead[this.currentLabelId]||{}},escrowLabel:function(){return c.Enums.SystemDefinedMailLabelIds.ESCROW},groupLabel:function(){return c.Enums.SystemDefinedMailLabelIds.GROUP_APPROVAL},searchFiltersVisible:function(){var e=this.isGmail||this.isZmail,t=0===this.selectedInboxItems.length;return e&&t&&this.inSearching}}),watch:{selectedStatus:{handler:function(e){switch(e){case ci.None:this.checkAll=!1,this.isIndeterminate=!1;break;case ci.Some:this.checkAll=!1,this.isIndeterminate=!0;break;case ci.All:this.checkAll=!0,this.isIndeterminate=!1;break}},immediate:!0}},methods:(0,l.Z)((0,l.Z)({},(0,u.nv)("search",["updateSelectedSearchFilters"])),{},{handleCheckMore:function(e){this.$emit("handleCheckMore",e)},setIsLastPage:function(e){this.$emit("setIsLastPage",e)},handleCheckAllChange:function(e){this.$emit("handleCheckAllChange",e),this.$refs.checkAll.hide()},prevPage:function(){this.$emit("setSelectInboxes",[]),this.checkAll=!1,this.isIndeterminate=!1,this.$store.commit("changeCurrentPage",this.currentPage-1)},nextPage:function(){this.$emit("setSelectInboxes",[]),this.checkAll=!1,this.isIndeterminate=!1,this.$emit("handleRefresh"),this.$store.commit("changeCurrentPage",this.currentPage+1)},mailCount:function(){var e=this;return x.Z.isLocalSearch(this.selectMailLabel.id)||x.Z.isArchive(this.selectMailLabel.id)?this.isLastPage.get(this.selectMailLabel.id)?this.ListThreads[this.selectMailLabel.id]["ListThreads"]["threadIds"].length:null:this.mailLabels.find((function(t){return t.id===e.selectMailLabel.id})).count.threadsTotal},pageCount:function(){return null===this.mailCount?null:Math.ceil(this.mailCount/this.maxNumberMailsPerRequest)},noMorePrev:function(){return 1===this.currentPage},noMoreNext:function(){return this.currentPage===this.pageCount}})},ui=di,hi=(0,D.Z)(ui,qt,Qt,!1,null,"4a46e8de",null),mi=hi.exports,pi=i(80544),fi=i(69969),vi=i(95740),bi=i(32682),gi=i(96802),Si=function(){var e=this,t=e._self._c;return t("div",[t("zm-dropdown",{on:{command:function(e){return e()},"visible-change":e.visibleChange}},[e._t("trigger"),t("zm-dropdown-menu",{ref:"menu",attrs:{slot:"dropdown"},slot:"dropdown"},[t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_toggle_view",arg:"inbox_toggle_view"}],attrs:{"zm-ta":"inbox-toggle-list-view",role:"menuitemcheckbox","aria-checked":(!e.isSplitView).toString(),command:e.changeToListView}},[t("div",{staticClass:"settings-dropdown-item"},[t("svg-icon",{attrs:{iconClass:"list-view"}}),t("span",{staticClass:"item-label"},[e._v(e._s(e.$t("common.listView")))]),t("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!e.isSplitView,expression:"!isSplitView"}],staticClass:"checkmark",attrs:{iconClass:"check"}})],1)]),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_toggle_view",arg:"inbox_toggle_view"}],attrs:{"zm-ta":"inbox-toggle-split-view",role:"menuitemcheckbox","aria-checked":e.isSplitView.toString(),command:e.changeToSplitView}},[t("div",{staticClass:"settings-dropdown-item"},[t("svg-icon",{attrs:{iconClass:"split-view"}}),t("span",{staticClass:"item-label"},[e._v(e._s(e.$t("common.splitView")))]),t("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.isSplitView,expression:"isSplitView"}],staticClass:"checkmark",attrs:{iconClass:"check"}})],1)]),e.isOffline?e._e():t("div",{staticClass:"divider"}),e.isOffline?e._e():t("switch-account",{ref:"swichAccount"}),t("div",{staticClass:"divider"}),t("zm-dropdown-item",{directives:[{name:"metric",rawName:"v-metric:inbox_go_setting",arg:"inbox_go_setting"}],attrs:{"zm-ta":"inbox-enter-setting","aria-label":e.$t("accessibility.emailPreferences"),command:e.enterSettings}},[t("div",{staticClass:"settings-dropdown-item"},[t("svg-icon",{attrs:{iconClass:"setting"}}),t("span",{staticClass:"item-label"},[e._v(e._s(e.$t("operation.emailPreferences")))])],1)]),t("div",{staticClass:"divider"}),t("zm-dropdown-item",{attrs:{command:e.handleLogoutWithWarning,"zm-ta":"mail-logout"}},[t("div",{directives:[{name:"metric",rawName:"v-metric:setting_logout",arg:"setting_logout"}],staticClass:"settings-dropdown-item logout-btn"},[t("svg-icon",{staticClass:"logout-icon",attrs:{iconClass:"leave"}}),t("span",{staticClass:"item-label"},[e._v(e._s(e.$t("account.signOut")))])],1)])],1)],2),t("confirm-dialog",{attrs:{visible:e.showWarningDialog,title:e.$t("offlineMode.signOutWarningTitle"),content:e.$t("offlineMode.signOutWarningContent"),width:"400px",actions:[{text:e.$t("offlineMode.cancel"),handler:e.close,className:"tab-focus"},{text:e.$t("offlineMode.signOut"),handler:e.confirmToLogout,className:"tab-focus",type:"primary"}]}})],1)},Ii=[],xi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"switch-account-in-dropdown-wrap"},[t("div",{staticClass:"switch-account-header"},[e._v(e._s(e.$t("account.accounts")))]),t("div",{staticClass:"account-item"},e._l(e.accountLists,(function(i){return t("zm-dropdown-item",{key:i.accountId,attrs:{command:function(){},"aria-label":"".concat(e.$t("accessibility.account"),", ").concat(i.name,"(").concat(i.alias,"), ").concat(i.address).concat(e.currentUserAccountId===i.accountId?", "+e.$t("accessibility.checked"):""),role:"menuitemcheckbox","aria-checked":(e.currentUserAccountId===i.accountId).toString(),"zm-ta":"switch-account-"+i.address,"data-debug":JSON.stringify({currentUserAccountId:e.currentUserAccountId,accountId:i.accountId})}},[t("div",{staticClass:"item"},[e.overlappingVisible(i)?t("div",{staticClass:"account-item__logo account-item__logo--overlapping"},[t("svg-icon",{staticClass:"account-item__logo--zoom",attrs:{"aria-hidden":"true",iconClass:i.icon}}),t("svg-icon",{staticClass:"account-item__logo--external",attrs:{"aria-hidden":"true",iconClass:e.externalAccountIcon}})],1):t("div",{staticClass:"account-item__logo"},[t("svg-icon",{attrs:{"aria-hidden":"true",iconClass:i.icon}})],1),i.name&&i.type!==e.ACCOUNTS.DELEGATE?t("div",{staticClass:"email-info",on:{click:function(t){i.type===e.ACCOUNTS.SHARED_INBOX?e.switchToDelegateAccount(i):e.switchAccount(i)}}},[t("div",{staticClass:"email-info__name"},[e._v(e._s(i.name)+" ("+e._s(i.alias)+")")]),t("div",{staticClass:"email-info__address"},[e._v(e._s(i.address))])]):i.name&&i.type===e.ACCOUNTS.DELEGATE?t("div",{staticClass:"email-info",on:{click:function(t){return e.switchToDelegateAccount(i)}}},[t("div",{staticClass:"email-info__name delegate-container"},[t("div",{staticClass:"delegate-name"},[e._v(e._s(i.name)+" ")]),t("div",{staticClass:"delegate-alias"},[e._v("("+e._s(i.alias)+")")])]),t("div",{staticClass:"email-info__address"},[e._v(e._s(i.address))])]):e._e(),i.name?e._e():t("div",{staticClass:"email-address-skeleton"},[t("zm-skeleton",{attrs:{loading:!0,animated:""}},[t("template",{slot:"template"},[t("div",[t("zm-skeleton-item",{attrs:{variant:"text"}})],1),t("div",[t("zm-skeleton-item",{staticClass:"shorter-skeleton-item",attrs:{variant:"text"}})],1)])],2)],1),e.currentUserAccountId===i.accountId?t("div",{staticClass:"active-mail"},[t("svg-icon",{staticClass:"checkmark",attrs:{iconClass:"check"}})],1):e._e()])])})),1),e.isLoading||!e.canAddAccount||e.isDelegated?e._e():t("zm-dropdown-item",{attrs:{command:e.open,"zm-ta":"switch-account-add-account"}},[t("div",{staticClass:"add-account"},[t("svg-icon",{attrs:{iconClass:"plus"}}),t("span",{staticClass:"add-account-text"},[e._v(e._s(e.$t("account.addAccount")))])],1)]),t("select-account",{ref:"choiceAnotherAccount",attrs:{accountLists:e.accountLists},on:{addAccount:e.addAccount}})],1)},wi=[],yi=i(82573),Ci=i(8158),Li=c.Enums.ACCOUNTS,ki={name:"SelectAccount",components:{selectAccount:yi.Z},mixins:[Ci.Z],data:function(){return{ACCOUNTS:Li,showWarningDialog:!1,accountToSwitch:{}}},computed:(0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.Se)("account",["mergingAccountAvailable","mergingAccountPaused"])),(0,u.rn)({typeOfEmail:function(e){return e.typeOfEmail},mergeAccountData:function(e){return e.account.mergeAccount||{}}})),{},{overlappingVisible:function(e){var t=e.currentUserAccountId,i=e.typeOfEmail,n=e.mergeAccountData,s=e.accountLists,a=e.mergingAccountAvailable,r=e.mergingAccountPaused;return function(e){return t===e.accountId&&s.filter((function(e){return e.type!==Li.DELEGATE&&e.type!==Li.SHARED_INBOX&&e.type!==i})).map((function(e){return e.address})).includes(n.externalEmail)&&(a||r)}},externalAccountIcon:function(e){var t,i=e.typeOfEmail,n=e.accountLists,s=e.mergeAccountData;return null===(t=n.find((function(e){return e.address===s.externalEmail&&e.type!==Li.DELEGATE&&e.type!==Li.SHARED_INBOX&&e.type!==i})))||void 0===t?void 0:t.icon}}),created:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.refreshDelegateList();case 2:return t.next=4,e.refreshDelegatorList();case 4:e.initAccountLists();case 5:case"end":return t.stop()}}),t)})))()},methods:{open:function(){this.$refs.choiceAnotherAccount.open()},close:function(){this.showWarningDialog=!1}}},$i=ki,Ti=(0,D.Z)($i,xi,wi,!1,null,"b01e9128",null),_i=Ti.exports,Di=i(62164),Ei=i(17236),Mi={name:"SettingsDropdown",components:{switchAccount:_i,ConfirmDialog:Di["default"]},mixins:[Ei.Z],data:function(){return{showWarningDialog:!1}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["isSplitView","isOffline"])),(0,u.rn)("auth",["defaultAccountLists"])),(0,u.Se)("delegate",{delegators:"getDelegatorList"})),(0,u.Se)(["isOutlook"])),watch:{defaultAccountLists:{handler:function(e,t){var i=this;e.length&&this.$nextTick((function(){var e,t;null===(e=i.$refs)||void 0===e||null===(t=e.menu)||void 0===t||t.updatePopper()}))}},delegators:{handler:function(){this.resetDropdownOptions(this.$refs.menu)}}},mounted:function(){this.bindDropdownScroll(this.$refs.menu)},methods:{visibleChange:function(e){var t=this;e&&(this.$nextTick((function(){var e;null===(e=t.$refs.swichAccount)||void 0===e||e.initAccountLists()})),this.$emit("dropdownOpened"))},close:function(){this.showWarningDialog=!1},handleLogoutWithWarning:function(){this.isOffline?this.showWarningDialog=!0:this.handleLogout()},enterSettings:function(){this.$emit("enterSettings"),this.isOutlook||this.fetchVacationResponder()},fetchVacationResponder:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.Setting.getVacationResponder();case 3:i=t.sent,n=i.errorCode,s=i.data,n?e.$msg({type:"Error",content:e.$t("vacationSettings.failedToFetchVacationResponder")}):(a=JSON.parse(c.Utils.purifyHtml(s.GetVacationResponder.vacationResponder)),e.$store.commit("setVacationResponder",a)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},changeToListView:function(){this.isSplitView&&this.$emit("changeView")},changeToSplitView:function(){this.isSplitView||this.$emit("changeView")},openFeedbackPage:function(){var e=this.$refs.feedbackAnchor;e.click()},confirmToLogout:function(){this.handleLogout()},handleLogout:function(){var e=this;window.zoomSdk.postJsMessage({functionName:"mailui_removemailaccount",params:{},needResponse:!1})["catch"]((function(t){e.$msg(e.$t("account.failedToLogout"))}))}}},Ai=Mi,Ri=(0,D.Z)(Ai,Si,Ii,!1,null,"773fc968",null),Zi=Ri.exports,zi=i(60659),Oi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"banner"},[t("span",{staticClass:"content",attrs:{"aria-hidden":!0}},[e._v(" "+e._s(e.$t("offlineMode.inboxBannerContent"))+" ")]),t("span",{staticClass:"learn-more tab-focus",attrs:{tabindex:"0",role:"button","aria-label":"".concat(e.$t("offlineMode.inboxBannerContent")," ").concat(e.$t("offlineMode.inboxBannerLearnMore"))},on:{click:e.handleLearnMore,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.handleLearnMore.apply(null,arguments))}}},[e._v(" "+e._s(e.$t("offlineMode.inboxBannerLearnMore"))+" ")]),t("confirm-dialog",{attrs:{visible:e.showLearnMoreDialog,content:e.$t("offlineMode.learnMoreContent"),actions:e.LearnMoreActions,title:e.$t("offlineMode.learnMoreTitle"),width:"400px"}})],1)},Hi=[],Pi={name:"OfflineModeInboxBanner",components:{ConfirmDialog:fi.Q},props:{},data:function(){return{showLearnMoreDialog:!1,LearnMoreActions:[{id:"got-it",className:"got-it tab-focus",handler:this.hideDialog,text:this.$t("offlineMode.gotIt"),type:"primary"}]}},methods:{hideDialog:function(){this.showLearnMoreDialog=!1},handleLearnMore:function(){this.showLearnMoreDialog=!0}}},Ni=Pi,Fi=(0,D.Z)(Ni,Oi,Hi,!1,null,"3eb1b738",null),Ui=Fi.exports,Vi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"inbox-sections"},[e.currentFullSectionType?[t("inbox-section-full",e._g({attrs:{listId:"recycle-scroller",name:e.getSectionName(e.currentFullSectionType),mails:e.getSectionMails(e.currentFullSectionType),isLastPage:e.sectionIsLastPageMap[e.currentFullSectionType],isInitialLoading:e.getSectionInitialLoadingStatus(e.currentFullSectionType),isScrollLoading:e.getSectionFullRefreshLoadingStatus(e.currentFullSectionType),placeholderContent:e.placeholderContent,isShowRetryButton:e.getRetryButtonVisibility(e.currentFullSectionType)},on:{close:e.onCloseFullSection,scrollEnd:function(t){return e.onScrollEnd(e.currentFullSectionType)},retry:function(t){return e.onRetry(e.currentFullSectionType)}}},e.getListener(e.currentFullSectionType)))]:t("div",{staticClass:"inbox-sections-section-list",attrs:{id:"recycle-scroller"}},e._l(e.sectionTypes,(function(i){return t("div",{key:i},[t("inbox-section",e._g({class:["inbox-section-".concat(i)],attrs:{listId:i,name:e.getSectionName(i),mails:e.getTopSectionMails(i),isLastPage:e.showEndOfMails(i),isCollapsed:e.sectionCollapseStateMap[i],isInitialLoading:e.getSectionInitialLoadingStatus(i),isScrollLoading:e.getSectionRefreshLoadingStatus(i),placeholderContent:e.placeholderContent,isShowRetryButton:e.getRetryButtonVisibility(i)},on:{menuCommand:function(t){return e.onMenuCommand(t,i)},toggleExpand:function(t){return e.onToggleExpand(i)},retry:function(t){return e.onRetry(i)}}},e.getListener(i)))],1)})),0)],2)},Bi=[],Gi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"inbox-section"},[t("div",{staticClass:"head"},[t("zm-button",{staticClass:"expand-button tab-focus",attrs:{tabindex:"0",role:"button","zm-ta":"inbox-section-expand-".concat(e.listId),"aria-label":e.name,"aria-expanded":e.isCollapsed?"false":"true"},on:{click:e.onToggleExpand}},[t("svg-icon",{attrs:{iconClass:e.isCollapsed?"chevron-small-down":"chevron-small-up"}}),t("span",{staticClass:"name"},[e._v(e._s(e.name))])],1),t("zm-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],attrs:{trigger:"click",placement:"bottom"},on:{command:e.onMenu}},[t("zm-button",{staticClass:"menu-button",attrs:{tabindex:"0",role:"button","zm-ta":"inbox-section-more-menu-".concat(e.listId),"aria-label":e.$t("accessibility.moreMenu",[e.name])}},[t("svg-icon",{attrs:{iconClass:"more"}})],1),t("zm-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("zm-dropdown-item",{attrs:{tabindex:"0","zm-ta":"inbox-section-show-all-".concat(e.listId),command:"showAll"}},[t("span",[e._v(e._s(e.$t("list.showAll")))])])],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isCollapsed,expression:"!isCollapsed"},{name:"loading",rawName:"v-loading",value:e.isInitialLoading,expression:"isInitialLoading"}],staticClass:"list-container",attrs:{"element-loading-spinner":"zm-icon-loading"}},[e.isInitialLoading?e._e():t("mail-list",e._g(e._b({staticClass:"list"},"mail-list",e.$props,!1),e.$listeners))],1)])},Wi=[],ji=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mail-list"},[0===e.mails.length?t("div",{class:["mail-list-empty",!e.showEmptyImg&&"no-empty-image"]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showEmptyImg,expression:"showEmptyImg"}],staticClass:"mail-list-empty-image"},[t("img",{staticClass:"splash",attrs:{src:i(66813),alt:e.$t("list.splashImage")}})]),t("div",[e._v(e._s(e.placeholderContent||e.$t("list.defaultNoMailsTip")))]),t("div",[e.isShowRetryButton?t("zm-button",{attrs:{"zm-ta":"inbox-list-refresh-".concat(e.listId)},on:{click:e.onRetry}},[e._v(" "+e._s(e.$t("common.retry"))+" ")]):e._e()],1)]):t("RecycleScroller",{ref:"recycleScroller",staticClass:"recycle-scroller tab-focus-button",attrs:{id:e.listId,tabindex:"0","aria-label":"".concat(e.name," ").concat(e.$t("accessibility.emailList")),keyField:"threadId",items:e.mails,sizeField:"height",simpleArray:!1},on:{scrollEnd:e.onScrollEnd},scopedSlots:e._u([{key:"default",fn:function(i){var n=i.item;return[t("inbox-item",e._g({key:n.threadId,attrs:{"zm-ta":"inbox-item-"+n.threadId,inboxItem:n,tabindex:"-1"}},e.$listeners))]}},{key:"after",fn:function(){return[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isScrollLoading&&0!==e.mails.length,expression:"isScrollLoading && mails.length !== 0"}],staticClass:"list-loading"},[t("i",{staticClass:"zm-icon-loading"})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLastPage&&!e.isScrollLoading&&0!==e.mails.length,expression:"isLastPage && !isScrollLoading && mails.length !== 0"}],staticClass:"list-marker"},[e._v(" "+e._s(e.$t("list.endOfEmails"))+" ")])]},proxy:!0}])})],1)},Xi=[],Ki={name:"MailList",components:{InboxItem:Ft,RecycleScroller:dt},props:{name:{type:String,default:""},mails:{type:Array,default:function(){return[]}},isScrollMode:{type:Boolean,default:!1},isScrollLoading:{type:Boolean,default:!1},isLastPage:{type:Boolean,default:!1},placeholderContent:{type:String,default:""},isShowRetryButton:{type:Boolean,default:!1},listId:{type:String,default:""},showEmptyImg:{type:Boolean,default:!1}},methods:{onScrollEnd:function(){this.isScrollMode&&this.$emit("scrollEnd")},onRetry:function(){this.$emit("retry")}}},Ji=Ki,Yi=(0,D.Z)(Ji,ji,Xi,!1,null,"0ecd07b2",null),qi=Yi.exports,Qi={name:"InboxSection",components:{MailList:qi},props:{name:{type:String,default:""},mails:{type:Array,default:function(){return[]}},isInitialLoading:{type:Boolean,default:!1},isScrollLoading:{type:Boolean,default:!1},isLastPage:{type:Boolean,default:!1},placeholderContent:{type:String,default:""},isShowRetryButton:{type:Boolean,default:!1},listId:{type:String,default:""},isCollapsed:{type:Boolean,default:!1}},computed:{menuVisible:function(){return 0!==this.mails.length}},methods:{onMenu:function(e){this.$emit("menuCommand",e)},onToggleExpand:function(){this.$emit("toggleExpand")},onScrollEnd:function(){this.$emit("scrollEnd")}}},en=Qi,tn=(0,D.Z)(en,Gi,Wi,!1,null,"b08d3476",null),nn=tn.exports,sn=function(){var e=this,t=e._self._c;return t("div",{staticClass:"inbox-section-full"},[t("div",{staticClass:"head"},[t("div",{staticClass:"name"},[e._v(e._s(e.name))]),t("zm-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:e.onMenu}},[t("zm-button",{staticClass:"menu-button",attrs:{tabindex:"0",role:"button","zm-ta":"inbox-section-full-more-menu-".concat(e.listId)}},[t("svg-icon",{attrs:{iconClass:"more"}})],1),t("zm-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("zm-dropdown-item",{attrs:{tabindex:"0","zm-ta":"inbox-section-full-close-all-".concat(e.listId),command:"closeAll"}},[t("span",[e._v(e._s(e.$t("list.closeAll")))])])],1)],1)],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isInitialLoading,expression:"isInitialLoading"}],staticClass:"list-container",attrs:{"element-loading-spinner":"zm-icon-loading"}},[e.isInitialLoading?e._e():t("mail-list",e._g(e._b({staticClass:"list",attrs:{isScrollMode:!0,"show-empty-img":!0}},"mail-list",e.$props,!1),e.$listeners))],1)])},an=[],rn={name:"InboxSectionFull",components:{MailList:qi},props:{name:{type:String,default:""},mails:{type:Array,default:function(){return[]}},isInitialLoading:{type:Boolean,default:!1},isScrollLoading:{type:Boolean,default:!1},isLastPage:{type:Boolean,default:!1},placeholderContent:{type:String,default:""},isShowRetryButton:{type:Boolean,default:!1},listId:{type:String,default:""}},methods:{onMenu:function(e){var t=this,i={closeAll:function(){t.$emit("close")}};i[e]&&i[e]()},onScrollEnd:function(){this.$emit("scrollEnd")}}},on=rn,ln=(0,D.Z)(on,sn,an,!1,null,"8c1c2d9e",null),cn=ln.exports,dn=c.Enums.SystemDefinedMailLabelIds,un=c.Enums.INBOX_SECTION_TYPE,hn=(Ct={},(0,ae.Z)(Ct,un.UNREAD,{name:"list.unreadSectionName"}),(0,ae.Z)(Ct,un.READ,{name:"list.everythingElseSectionName"}),Ct),mn=(0,ae.Z)({},dn.INBOX,"list.noEmailsInInbox"),pn={name:"InboxSections",components:{InboxSection:nn,InboxSectionFull:cn},props:{sectionTypes:{type:Array,default:function(){return[un.UNREAD,un.READ]}}},data:function(){return{sectionConfigMap:hn,sectionInitialLoadingStateMap:{},sectionRefreshLoadingStateMap:{},sectionIsLastPageMap:{},sectionErrorStateMap:{},sectionCollapseStateMap:{}}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["isOffline","GetThreadHead","maxNumberMailsPerRequest","selectMailLabel"])),(0,u.rn)("inbox",["currentFullSectionType","sectionFixedMailCount"])),(0,u.Se)(["isOutlook","isGmail"])),(0,u.Se)("inbox",["currentLabelMails","currentSectionsMails"])),{},{currentLabelId:function(){var e;return null===(e=this.selectMailLabel)||void 0===e?void 0:e.id},unreadMails:function(){return this.currentSectionsMails[un.UNREAD]||[]},readMails:function(){return this.currentSectionsMails[un.READ]||[]},placeholderContent:function(){var e=mn[this.currentLabelId]||"list.noEmailsInLabel";return this.$t(e)}}),watch:{unreadMails:function(e,t){this.checkSectionListCount(un.UNREAD)},readMails:function(e,t){this.checkSectionListCount(un.READ)}},mounted:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object.keys(e.GetThreadHead).includes(dn.INBOX)||e.fetchAllSectionMails();case 1:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.$store.commit("inbox/changeCurrentCachedSectionMails",[]),this.clearCurrentFullSectionType(),this.clearSelectedInboxThreadIds()},methods:(0,l.Z)((0,l.Z)({},(0,u.nv)("inbox",["clearSelectedInboxThreadIds","setCurrentFullSectionType","clearCurrentFullSectionType"])),{},{getListener:function(e){var t=this;return(0,l.Z)((0,l.Z)({},this.$listeners),{},{handleShowDetail:function(i){t.handleShowDetail(i,e)}})},onScrollEnd:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!t.sectionIsLastPageMap[e]){i.next=2;break}return i.abrupt("return");case 2:t.refreshMailList(e);case 3:case"end":return i.stop()}}),i)})))()},onRetry:function(e){this.refreshMailList(e)},checkSectionListCount:function(e){var t=this,i=this.sectionInitialLoadingStateMap[e]||this.sectionRefreshLoadingStateMap[e];if(!i){var n=this.currentSectionsMails[e]||[],s=this.sectionFixedMailCount;e===un.READ&&this.isGmail&&(s=100),n.length<s&&!this.sectionIsLastPageMap[e]&&this.$nextTick((function(){t.refreshMailList(e)}))}},refreshMailList:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,l;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:n={},(0,ae.Z)(n,un.UNREAD,{fetch:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fetchMails({isUnread:!0,isFromBegin:!1,isRead:!1}));case 1:case"end":return e.stop()}}),e)})));function i(){return e.apply(this,arguments)}return i}()}),(0,ae.Z)(n,un.READ,{fetch:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fetchMails({isRead:!0,isFromBegin:!1,isUnread:!1}));case 1:case"end":return e.stop()}}),e)})));function i(){return e.apply(this,arguments)}return i}()}),s=n,a=s[e].fetch,t.$set(t.sectionRefreshLoadingStateMap,e,!0),t.$set(t.sectionErrorStateMap,e,!1),l=t.currentSectionsMails[e],l&&0===l.length&&t.$set(t.sectionInitialLoadingStateMap,e,!0),a().then((function(i){var n=i.isLastPage,s=i.threadHeads;t.$set(t.sectionIsLastPageMap,e,n),t.$set(t.sectionRefreshLoadingStateMap,e,!1),t.$set(t.sectionInitialLoadingStateMap,e,!1),s.forEach((function(e){t.$store.commit("addThreadHead",e.GetThreadHead)}))}))["catch"]((function(i){t.$set(t.sectionErrorStateMap,e,!0),t.$set(t.sectionRefreshLoadingStateMap,e,!1),t.$set(t.sectionInitialLoadingStateMap,e,!1)}));case 7:case"end":return i.stop()}}),i)})))()},fetchAllSectionMails:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a,o,l,c,d,u;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i={},(0,ae.Z)(i,un.UNREAD,{fetch:function(){return e.fetchMails({isUnread:!0,isFromBegin:!0,isRead:!1})}}),(0,ae.Z)(i,un.READ,{fetch:function(){return e.fetchMails({isRead:!0,isFromBegin:!0,isUnread:!1})}}),n=i,s=(0,ne.Z)(e.sectionTypes),t.prev=2,s.s();case 4:if((a=s.n()).done){t.next=29;break}if(o=a.value,n[o]){t.next=8;break}return t.abrupt("return");case 8:return l=n[o].fetch,e.$set(e.sectionInitialLoadingStateMap,o,!0),e.$set(e.sectionErrorStateMap,o,!1),t.prev=11,t.next=14,l();case 14:c=t.sent,d=c.isLastPage,u=c.threadHeads,e.$set(e.sectionIsLastPageMap,o,d),u.forEach((function(t){e.$store.commit("addThreadHead",t.GetThreadHead)})),e.$set(e.sectionInitialLoadingStateMap,o,!1),t.next=27;break;case 22:t.prev=22,t.t0=t["catch"](11),e.$set(e.sectionErrorStateMap,o,!0),e.$set(e.sectionInitialLoadingStateMap,o,!1);case 27:t.next=4;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t["catch"](2),s.e(t.t1);case 34:return t.prev=34,s.f(),t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[2,31,34,37],[11,22]])})))()},fetchMails:function(){var e=arguments,t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,c,u,h,m,p,f,v;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},s=t.isOutlook,a=!0,o=[],i.prev=4,i.next=7,d.Mail.listThreads((0,l.Z)({label:t.currentLabelId,count:n.count||t.maxNumberMailsPerRequest},n));case 7:if(m=i.sent,p=m.data,f=m.errorCode,0===f){i.next=12;break}return i.abrupt("return",Promise.reject(new Error("list thread failed.")));case 12:if(v=(null===p||void 0===p||null===(c=p.ListThreads)||void 0===c?void 0:c.threadIds)||[],null===p||void 0===p||null===(u=p.ListThreads)||void 0===u||!u.threadIds){i.next=16;break}return i.next=16,t.$store.dispatch("addListThreads",p);case 16:return a=null===p||void 0===p||null===(h=p.ListThreads)||void 0===h?void 0:h.isLastPage,i.next=19,y.t.getAllThreadHead(t.currentLabelId,v,s);case 19:o=i.sent,i.next=26;break;case 22:return i.prev=22,i.t0=i["catch"](4),i.abrupt("return",Promise.reject(new Error("fetch mails failed.")));case 26:return i.abrupt("return",{threadHeads:o,isLastPage:a});case 27:case"end":return i.stop()}}),i,null,[[4,22]])})))()},getSectionName:function(e){var t,i=null===(t=hn[e])||void 0===t?void 0:t.name;return i?this.$t(i):""},getSectionMails:function(e){var t,i=(t={},(0,ae.Z)(t,un.UNREAD,this.unreadMails),(0,ae.Z)(t,un.READ,this.readMails),t);return i[e]||[]},getTopSectionMails:function(e){var t,i=(t={},(0,ae.Z)(t,un.UNREAD,this.unreadMails),(0,ae.Z)(t,un.READ,this.readMails),t);return(i[e]||[]).slice(0,this.sectionFixedMailCount)},getCurrentVisibleMails:function(){var e=this;return this.currentFullSectionType?this.getSectionMails(this.currentFullSectionType):this.sectionTypes.reduce((function(t,i){var n=e.getTopSectionMails(i);return t.concat(n)}),[])},getSectionInitialLoadingStatus:function(e){var t=this.sectionInitialLoadingStateMap[e];return void 0===t&&!this.currentLabelMails.length||t},getSectionFullRefreshLoadingStatus:function(e){return this.sectionRefreshLoadingStateMap[e]},getSectionRefreshLoadingStatus:function(e){var t=this.currentSectionsMails[e]||[];return this.sectionRefreshLoadingStateMap[e]&&t.length<this.sectionFixedMailCount},getRetryButtonVisibility:function(e){return!!this.isOffline||this.sectionErrorStateMap[e]},onMenuCommand:function(e,t){var i=this,n={showAll:function(){i.setCurrentFullSectionType(t),i.clearSelectedInboxThreadIds()}};n[e]&&n[e]()},onCloseFullSection:function(){this.clearCurrentFullSectionType(),this.clearSelectedInboxThreadIds()},onToggleExpand:function(e){var t=this.sectionCollapseStateMap[e]||!1;this.$set(this.sectionCollapseStateMap,e,!t)},showEndOfMails:function(e){if(!this.sectionIsLastPageMap[e])return!1;var t=this.currentSectionsMails[e]||[];return t.length<this.sectionFixedMailCount},handleShowDetail:function(e,t){var i=this.currentSectionsMails[t];this.$store.commit("inbox/changeCurrentCachedSectionMails",this.currentFullSectionType?i:i.slice(0,this.sectionFixedMailCount)),this.$emit("handleShowDetail",e)}})},fn=pn,vn=(0,D.Z)(fn,Vi,Bi,!1,null,"42ab900b",null),bn=vn.exports,gn=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLowStorage&&e.showStorageUsageTips,expression:"isLowStorage && showStorageUsageTips"}],staticClass:"low-storage-usage-tips-container"},[t("div",{staticClass:"low-storage-usage-tips"},[t("div",{staticClass:"low-storage-usage-tips-content"},[t("div",{staticClass:"low-storage-usage-tips-bar",style:{backgroundColor:e.isStorageFull?"var(--red-60)":"var(--blue-60)"},attrs:{tabindex:"-1","aria-hidden":"true"}},[t("div",{staticClass:"low-storage-usage-tips-bar-item"})]),t("div",{staticClass:"low-storage-usage-tips-description"},[t("div",{staticClass:"usage-tips-header tab-focus",attrs:{"aria-label":e.tipsHeader,tabindex:"0"}},[e._v(" "+e._s(e.tipsHeader)+" ")]),t("div",{staticClass:"usage-tips-detail tab-focus",attrs:{"aria-label":e.tipsDetail,tabindex:"0"}},[e._v(" "+e._s(e.tipsDetail)+" ")])])]),e.isStorageFull?e._e():t("zm-button",{staticClass:"low-storage-usage-tips-action tab-focus",attrs:{type:"text",tabindex:"0","aria-label":e.$t("common.close")},on:{click:e.hideTips},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hideTips.apply(null,arguments)}}},[t("svg-icon",{attrs:{"icon-class":"close"}})],1)],1)])},Sn=[],In={name:"LowStorageUsageTips",data:function(){return{timer:null}},computed:(0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["showStorageUsageTips"])),(0,u.Se)(["zmailStorageUsage","isZmail"])),{},{isLowStorage:function(e){var t=e.zmailStorageUsage;return t>=.95},isStorageFull:function(e){var t=e.zmailStorageUsage;return t>=.99},tipsHeader:function(e){var t=e.isLowStorage,i=e.isStorageFull,n=e.zmailStorageUsage,s="";return i?s=this.$t("account.storageFull"):t&&(s=this.$t("account.storageAlmostFull",[(100*n).toFixed(2)+"%"])),s},tipsDetail:function(e){var t=e.isLowStorage,i=e.isStorageFull,n="";return i?n=this.$t("account.storageFullDetail"):t&&(n=this.$t("account.storageAlmostFullDetail")),n}}),created:function(){var e=this;this.isZmail&&(this.startRefreshZmailProfileTimer(),this.$once("hook:beforeDestroy",(function(){e.stopRefreshZmailProfileTimer()})))},methods:(0,l.Z)((0,l.Z)({},(0,u.OI)(["changeStorageUsageTips"])),{},{hideTips:function(){this.changeStorageUsageTips(!1)},startRefreshZmailProfileTimer:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.timer=setTimeout((0,o.Z)((0,r.Z)().mark((function t(){var i,n,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.Setting.getCurrentMailUserProfile();case 3:i=t.sent,n=i.data.GetCurrentMailUserProfile,s=i.errorCode,!s&&n&&e.$store.commit("setUserProfile",{mboxQuota:n["mboxQuota"],mboxSize:n["mboxSize"]}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0);case 13:return t.prev=13,t.next=16,e.startRefreshZmailProfileTimer();case 16:return e.changeStorageUsageTips(!0),t.finish(13);case 18:case"end":return t.stop()}}),t,null,[[0,10,13,18]])}))),36e5);case 2:case"end":return t.stop()}}),t)})))()},stopRefreshZmailProfileTimer:function(){clearTimeout(this.timer)}})},xn=In,wn=(0,D.Z)(xn,gn,Sn,!1,null,"a1ed9064",null),yn=wn.exports,Cn=(i(45794),function(){var e=this,t=e._self._c;return t("form",{ref:"searchForm",staticClass:"search-form",attrs:{role:"search"},on:{submit:function(e){e.preventDefault()}}},[t("zm-popover",{staticClass:"search-popover",attrs:{placement:"bottom-start","visible-arrow":!1,trigger:"click","tab-to-leave":!0,transition:"none"},model:{value:e.searchPopoverVisible,callback:function(t){e.searchPopoverVisible=t},expression:"searchPopoverVisible"}},[t("div",{staticClass:"search-box",attrs:{slot:"reference",name:"searchbox"},slot:"reference"},[t("zm-input",{ref:"searchInput",staticClass:"search-input",attrs:{"zm-ta":"inbox-search-input",placeholder:e.$t("search.searchMail")},on:{focus:function(t){e.isSearchInputFocused=!0},blur:function(t){e.isSearchInputFocused=!1},submit:e.handleSubmit},nativeOn:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnFirst.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnFirst.apply(null,arguments))}],click:function(t){return e.onClickSearchInput.apply(null,arguments)}},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}},[t("SvgIcon",{attrs:{slot:"prefix",iconClass:"search"},slot:"prefix"})],1),t("span",{directives:[{name:"show",rawName:"v-show",value:e.userInput.length>0,expression:"userInput.length > 0"}],staticClass:"clear-search-key-button",attrs:{"zm-ta":"inbox-search-clear","aria-label":e.$t("search.clear")},on:{click:function(t){return t.preventDefault(),e.handleClose.apply(null,arguments)}}},[t("svg-icon",{attrs:{iconClass:"blocked"}})],1)],1),t("div",[e.isGmail||e.isZmail?t("SearchFilters",{staticClass:"search-filters",attrs:{selected:e.tempSelectedSearchFilters},on:{"update:selected":e.onUpdateSearchFilters}}):e._e(),t("search-suggestion",{ref:"searchSuggestionRef",attrs:{keyword:e.userInput.trim(),selectedSearchFilters:e.tempSelectedSearchFilters},on:{quickSearch:e.handleQuickSearch,redirect:e.handleRedirect}}),e.isGmail||e.isZmail?t("div",{staticClass:"search-form-divider"}):e._e(),t("RecentSearchList",{attrs:{recentSearches:e.recentSearches},on:{"update:recentSearches":function(t){e.recentSearches=t},"update:recent-searches":function(t){e.recentSearches=t},select:e.handleRecentSelection}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.userInput.length>0&&e.isSearchDone,expression:"userInput.length > 0 && isSearchDone"}],staticClass:"search-form-divider"}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.userInput.length>0&&e.isSearchDone,expression:"userInput.length > 0 && isSearchDone"}],staticClass:"view-all-searches tab-focus",attrs:{tabindex:"0","aria-label":e.$t("search.viewAllAria",[e.userInput]),"zm-ta":"inbox-search-view-all",role:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments))}}},[t("div",{staticClass:"view-all-searches-title"},[e._v(" "+e._s(e.$t("search.viewAll"))+" ")]),t("div",{staticClass:"view-all-searches-action"},[e._v(" "+e._s(e.$t("search.viewAllAction"))+" ")])])],1)])],1)}),Ln=[],kn=i(68571),$n=(i(85940),function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"recent-searches-title",attrs:{"aria-label":e.$t("search.recentSearches")}},[e._v(" "+e._s(e.$t("search.recentSearches"))+" "),t("zm-button",{directives:[{name:"show",rawName:"v-show",value:e.recentSearches.length>0,expression:"recentSearches.length > 0"}],attrs:{ghost:"","zm-ta":"inbox-search-clear-all","aria-label":e.$t("search.clearRecents")},on:{click:function(t){return t.preventDefault(),e.handleClearHistory.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("operation.clear"))+" ")])],1),0===e.recentSearches.length?t("div",{staticClass:"no-recent-searches"},[t("div",{staticClass:"no-recent-searches-image"},[t("img",{attrs:{src:i(99391),alt:e.$t("search.noSearchHistory"),draggable:"false"}})]),t("div",{staticClass:"no-recent-searches-text"},[e._v(" "+e._s(e.$t("search.noSearchHistory"))+" ")])]):e._e(),e._l(e.recentSearches,(function(i,n){return t("div",{key:i,ref:i,refInFor:!0,staticClass:"recent-item-container tab-focus",attrs:{"zm-ta":"inbox-search-recent-history-item-"+i,tabindex:0===n?"0":"-1","aria-label":"'".concat(i,"'")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRecentClick(i)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRecentClick(i)},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;t.stopPropagation(),t.preventDefault(),e.recentSelectDown(e.recentSearches.indexOf(i))},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;t.stopPropagation(),t.preventDefault(),e.recentSelectUp(e.recentSearches.indexOf(i))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:(t.stopPropagation(),t.preventDefault(),void e.$refs["clear-"+i][0].focus())}]}},[t("div",{staticClass:"recent-item-left"},[t("svg-icon",{attrs:{iconClass:"recent-search"}}),t("span",{staticClass:"recent-item-text"},[e._v(e._s(i))])],1),t("span",{ref:"clear-"+i,refInFor:!0,staticClass:"tab-focus",attrs:{tabindex:"-1","aria-label":e.$t("search.clearRecentItem",[i]),role:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleClearRecentItem(i)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.handleClearRecentItem(i))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:(t.stopPropagation(),t.preventDefault(),e.$refs[i][0].focus())}]}},[t("svg-icon",{style:{width:"10px",height:"10px"},attrs:{iconClass:"close"}})],1)])}))],2)}),Tn=[],_n={name:"RecentSearchList",props:{recentSearches:{type:Array,default:[]}},methods:{handleClearRecentItem:function(e){var t=this.recentSearches;t.splice(this.recentSearches.indexOf(e),1),this.$emit("update:recentSearches",t)},handleClearHistory:function(){this.$emit("update:recentSearches",[])},recentSelectDown:function(e){e+1>this.recentSearches.length-1||this.$refs[this.recentSearches[e+1]][0].focus()},recentSelectUp:function(e){e<1||this.$refs[this.recentSearches[e-1]][0].focus()},handleRecentClick:function(e){this.$emit("select",e)}}},Dn=_n,En=(0,D.Z)(Dn,$n,Tn,!1,null,"77d2c7b4",null),Mn=En.exports,An=function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"search-suggestion"},[t("div",{staticClass:"search-suggestion__divider"}),e._l(e.contacts,(function(i,n){return t("div",{key:i.value,staticClass:"search-suggestion__item",attrs:{id:"suggestion-".concat(n),tabindex:"-1","aria-label":e.getContactAriaLabel(i)},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnNext.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnPrev.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.quickSearch(i.value))}],click:function(t){return e.quickSearch(i.value)}}},[t("div",{staticClass:"search-suggestion__item__wrapper"},[t("div",{staticClass:"search-suggestion__item__icon",style:{marginRight:"12px"}},[t("svg-icon",{attrs:{"aria-hidden":"true",iconClass:"profile"}})],1),i.contactNameHighlight?[t("div",{staticClass:"search-suggestion__item__container"},[t("div",{staticClass:"search-suggestion__item__text",domProps:{innerHTML:e._s(i.contactNameHighlight)}}),t("div",{staticClass:"search-suggestion__item__subtext",domProps:{innerHTML:e._s(i.contactAddressHighlight)}})])]:[t("div",{staticClass:"search-suggestion__item__container"},[t("div",{staticClass:"search-suggestion__item__text",domProps:{innerHTML:e._s(i.contactAddressHighlight)}})])]],2)])})),t("div",{directives:[{name:"show",rawName:"v-show",value:e.keyword.length,expression:"keyword.length"}],staticClass:"search-suggestion__divider"}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.contents.length&&e.keyword.length,expression:"!contents.length && keyword.length"}],staticClass:"search-suggestion__item"},[t("div",{staticClass:"search-suggestion__item__container"},[t("div",{staticClass:"search-suggestion__item__subtext"},[e._v(e._s(e.$t("search.noRecentMatchedItems")))])])]),e._l(e.contents,(function(i,n){return t("div",{key:i.threadId,staticClass:"search-suggestion__item",attrs:{id:"suggestion-".concat(n+e.contacts.length),tabindex:"-1","aria-label":e.getContentAriaLabel(i)},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnNext.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.focusOnPrev.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.redirect2Thread(i.threadId,i.data))}],click:function(t){return e.redirect2Thread(i.threadId,i.data)}}},[t("div",{staticClass:"search-suggestion__item__wrapper"},[t("div",{staticClass:"search-suggestion__item__icon",style:{marginRight:"12px"}},[t("svg-icon",{attrs:{"aria-hidden":"true",iconClass:"mail"}})],1),t("div",{staticClass:"search-suggestion__item__container",style:{width:"auto"}},[t("div",{staticClass:"search-suggestion__item__text",domProps:{innerHTML:e._s(i.subject)}}),t("div",{staticClass:"search-suggestion__item__subtext",domProps:{innerHTML:e._s(i.snippet)}})]),i.hasAttachments?t("div",{staticClass:"search-suggestion__item__icon",style:{marginLeft:"6px"}},[t("svg-icon",{style:{transform:"rotate(90deg)"},attrs:{"aria-hidden":"true",iconClass:"clip"}})],1):e._e(),t("span",{staticClass:"search-suggestion__item__date"},[e._v(e._s(e.formatDate(i.date)))])])])}))],2)},Rn=[],Zn=c.Enums.SystemDefinedMailLabelIds,zn=2,On=5,Hn={name:"SearchSuggestion",components:{SvgIcon:g.Z},props:{keyword:{type:String,required:!0},selectedSearchFilters:{type:Array,required:!0}},data:function(){return{focusIndex:-1,recentJsCallId:"",onceContentSearch:{hash:"",localSearchDone:!0,remoteSearchDone:!0},contentSearchResults:[]}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["contactSearches"])),(0,u.rn)({userEmail:function(e){return e.userProfile.userEmail||""},userTimeZone:function(e){return e.userProfile.userTimeZone}})),(0,u.Se)(["isOutlook","isGmail","isZmail"])),{},{lastKeyWord:function(e){var t=e.keyword;return t.split(",").pop().trim()},restKeyWord:function(e){var t=e.keyword,i=t.split(",");return i.pop(),i.join(",").trim()},visible:function(e){var t=e.keyword,i=e.contacts;return!!(t&&i.length>0)},contacts:function(e){var t=this,i=e.recentJsCallId,n=e.keyword,s=e.contactSearches,a=e.lastKeyWord;if(!i||!n||null===s||void 0===s||!s[i])return[];var r=new RegExp((0,ue.hr)(a),"gi"),o=s[i];if(this.combinedKeyword=(0,ue.a1)([a]).join(","),0===o.searchResults.length){var l=(0,ue.a1)([this.combinedKeyword]).map((function(e){return e.includes(Et.aE)?c.Utils.getContactName(e):e.split("@")[0]})),d="";l.forEach((function(e,t){d+=t===l.length-1?e:e+", "}));var u=[{displayName:c.Utils.sanitizeHTML2String(d),email:c.Utils.sanitizeHTML2String(this.combinedKeyword)}];return u.reduce((function(e,i){var n=i.email,s=i.displayName,a=r.test(s)||r.test(n),o="@"===t.combinedKeyword[t.combinedKeyword.length-1];return a&&!o&&e.push({value:n.toLowerCase(),displayName:s,contactAddressHighlight:n.replace(r,(function(e){return"<strong>".concat(e,"</strong>")})),contactNameHighlight:s.replace(r,(function(e){return"<strong>".concat(e,"</strong>")}))}),e}),[])}var h=o.searchResults.reduce((function(e,t){var i=t.email,n=t.displayName;return e.push({value:i.toLowerCase(),displayName:n,contactAddressHighlight:c.Utils.sanitizeHTML2String(i).trim().replace(r,(function(e){return"<strong>".concat(e,"</strong>")})),contactNameHighlight:c.Utils.sanitizeHTML2String(n).trim().replace(r,(function(e){return"<strong>".concat(e,"</strong>")}))}),e}),[]);return h.slice(0,zn)},contents:function(e){var t=this,i=e.keyword,n=e.contentSearchResults,s=new RegExp((0,ue.hr)(i),"gi"),a=n.reduce((function(e,i){return e.push({labelId:i.labelId,threadId:i.threadId,date:i.threadHead.date,hasAttachments:i.threadHead.hasAttachment,subject:i.threadHead.subject?c.Utils.sanitizeHTML2String(i.threadHead.subject).trim().replace(s,(function(e){return"<strong>".concat(e,"</strong>")})):c.Utils.sanitizeHTML2String(t.$t("common.noSubject")),snippet:i.threadHead.snippet?c.Utils.sanitizeHTML2String((0,ue.X4)(i.threadHead.snippet)).trim().replace(s,(function(e){return"<strong>".concat(e,"</strong>")})):c.Utils.sanitizeHTML2String(t.$t("common.noSnippet")),data:i}),e}),[]);return a.slice(0,On)}}),watch:{focusIndex:{handler:function(){this.focusOn()},immediate:!0},lastKeyWord:{handler:function(e,t){e!==t&&this.getContactSearchSuggestion()},immediate:!0},keyword:{handler:function(e,t){e!==t&&(this.resetFocus(),e?this.debouncedSearchSuggestion():this.clearSearchSuggestion())},immediate:!0}},methods:(0,l.Z)((0,l.Z)({},(0,u.OI)(["clearStaleContactSearch","listenForSearchCallbacks"])),{},{focusOn:function(){var e=this;this.$nextTick((function(){var t;null===(t=document.getElementById("suggestion-".concat(e.focusIndex)))||void 0===t||t.focus()}))},focusOnFirst:function(){this.focusIndex=0},focusOnPrev:function(){document.body.classList.remove("using-mouse"),this.focusIndex<0?this.focusIndex=0:(this.focusIndex=this.focusIndex-1,this.focusIndex<0&&(this.focusIndex=this.contacts.length+this.contents.length-1))},focusOnNext:function(){document.body.classList.remove("using-mouse"),this.focusIndex<0?this.focusIndex=0:(this.focusIndex=this.focusIndex+1,this.focusIndex>=this.contacts.length+this.contents.length&&(this.focusIndex=0))},resetFocus:function(){this.focusIndex=-1},clearSearchSuggestion:function(){this.resetFocus(),this.recentJsCallId&&this.clearStaleContactSearch(this.recentJsCallId),this.contentSearchResults=[]},getContactSearchSuggestion:function(){var e=this;if(!this.lastKeyWord)return this.clearStaleContactSearch(this.recentJsCallId),void(this.recentJsCallId="");d.Setting.getRecentContacts({keyword:this.lastKeyWord}).then((function(t){0===t.errorCode&&(e.clearStaleContactSearch(e.recentJsCallId),e.listenForSearchCallbacks({jsCallId:t.data.jsCallId,result:t.data,isResultUpdated:!1}),e.recentJsCallId=t.data.jsCallId)}))},getContentSearchSuggestion:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.keyword){t.next=2;break}return t.abrupt("return");case 2:return i=function(){var t=(0,o.Z)((0,r.Z)().mark((function t(i){var n,s,a,o,l;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.onceContentSearch.hash===e.keyword.trim()){t.next=2;break}return t.abrupt("return");case 2:if(n=i.labelId,s=i.threadIds,a=i.isLocalSearch,a?e.onceContentSearch.localSearchDone=!0:e.onceContentSearch.remoteSearchDone=!0,s&&0!==s.length){t.next=7;break}return a&&(e.contentSearchResults=[]),t.abrupt("return");case 7:for(o=0;o<s.length;o++)l=s[o],e.monoblockSearch({labelId:n,threadIds:[l]}).then((function(t){e.onceContentSearch.hash===e.keyword.trim()&&t.forEach((function(t){var i=t.GetThreadHead;i.labelId=Zn.INBOX;var n=!0;e.isZmail&&(n=c.Utils.isDecrypted(i.threadHead.decryptionStatus)),n||(i.threadHead.subject=e.$t("operation.emailLocked"),i.threadHead.snippet=e.$t(c.Utils.getDecryptErrorInfo(i.threadHead.originalCode).wording));var s=e.contentSearchResults.findIndex((function(e){return e.threadId===i.threadId}));s<0?e.contentSearchResults.push(i):e.contentSearchResults[s]=i}))}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=c.Hooks.useSearchAction(e.keyword,i),t.next=6,n.search({field:null,count:On,inSpamTrash:!1,advSearch:{inLabelId:Zn.INBOX,isStarred:e.selectedSearchFilters.includes("starred"),hasAttach:e.selectedSearchFilters.includes("hasAttachment"),from:e.selectedSearchFilters.includes("fromMe")?e.userEmail:null},searchFromBeginning:!0});case 6:s=t.sent,s||(e.contentSearchResults=[]),e.onceContentSearch.hash=e.keyword.trim(),e.onceContentSearch.localSearchDone=!1,e.onceContentSearch.remoteSearchDone=!1;case 11:case"end":return t.stop()}}),t)})))()},getAttachmentSearchSuggestion:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.keyword){t.next=2;break}return t.abrupt("return");case 2:case"end":return t.stop()}}),t)})))()},debouncedSearchSuggestion:(0,le.debounce)((function(){this.getContentSearchSuggestion(),this.getAttachmentSearchSuggestion()}),500,!0),monoblockSearch:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.labelId,s=e.threadIds,!t.isOutlook){i.next=7;break}return i.next=4,t.doBatchSearch(n,s);case 4:i.t0=i.sent,i.next=10;break;case 7:return i.next=9,t.doSearch(n,s);case 9:i.t0=i.sent;case 10:return a=i.t0,i.abrupt("return",a);case 12:case"end":return i.stop()}}),i)})))()},doBatchSearch:function(e,t){return(0,o.Z)((0,r.Z)().mark((function i(){var n;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e&&0!==t.length){i.next=2;break}return i.abrupt("return",[]);case 2:return i.prev=2,i.next=5,y.t.getAllThreadHead(e,t,!0);case 5:return n=i.sent,i.abrupt("return",n);case 9:return i.prev=9,i.t0=i["catch"](2),i.abrupt("return",[]);case 13:case"end":return i.stop()}}),i,null,[[2,9]])})))()},doSearch:function(e,t){return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,l,c,d,u,h;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e&&0!==t.length){i.next=2;break}return i.abrupt("return",[]);case 2:return n=[],i.prev=3,i.next=6,y.t.experientialGetThreadsHead(e,t);case 6:s=i.sent,a=(0,ne.Z)(s.entries());try{for(a.s();!(o=a.n()).done;)l=(0,kn.Z)(o.value,2),c=l[1],"fulfilled"===c.status&&(d=c.value,u=d.result,h=d.returnCode,0===h&&n.push(u))}catch(r){a.e(r)}finally{a.f()}return i.abrupt("return",n);case 12:return i.prev=12,i.t0=i["catch"](3),i.abrupt("return",[]);case 16:case"end":return i.stop()}}),i,null,[[3,12]])})))()},quickSearch:function(e){if(e){var t=this.lastKeyWord!==this.keyword.trim();this.$emit("quickSearch",t?"".concat(this.restKeyWord,",").concat(e):e)}},redirect2Thread:function(e,t){this.$emit("redirect",{threadId:e,thread:t})},formatDate:function(e){return Tt.ou.fromSeconds(e).setZone(this.userTimeZone).toFormat("LLL d")},getContactAriaLabel:function(e){return e.displayName?"".concat(this.$t("accessibility.searchFor"),", ").concat(e.displayName,", ").concat(e.value):"".concat(this.$t("accessibility.searchFor"),", ").concat(e.value)},getContentAriaLabel:function(e){return"".concat(this.$t("accessibility.searchFor"),", ").concat(e.subject,", ").concat(e.snippet)}})},Pn=Hn,Nn=(0,D.Z)(Pn,An,Rn,!1,null,"50c2685d",null),Fn=Nn.exports,Un=c.Enums.SystemDefinedMailLabelIds,Vn={name:"Search",components:{SearchFilters:ri,RecentSearchList:Mn,SearchSuggestion:Fn},data:function(){return{searchPopoverVisible:!1,isSearchInputFocused:!1,tempSelectedSearchFilters:[],userInput:"",recentSearches:[],isSearchDone:!0,searchPending:!1,isComposing:!1,hasCompositionJustEnd:!1,retryQueue:[]}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.Se)(["isOutlook","isGmail","isZmail"])),(0,u.rn)("search",["selectedSearchFilters"])),(0,u.rn)({userEmail:function(e){return e.userProfile.userEmail||""},cachedSearchString:function(e){return e.searchString},selectedMailLabel:function(e){return e.selectMailLabel},selectPrevLabel:function(e){return e.selectPrevLabel},mailLabels:function(e){return e.mailLabels},inFilters:function(e){return e.inFilters},maxNumberMailsPerRequest:function(e){return e.maxNumberMailsPerRequest},curSearchHash:function(e){return e.curSearchHash},isSearchingMails:function(e){return e.isSearchingMails},inSearching:function(e){return e.inSearching}})),{},{isNotInSearchMode:function(){var e;return"inbox"!==this.$route.name||"inbox"===this.$route.name&&!x.Z.isLocalSearch(null===(e=this.$route.params)||void 0===e?void 0:e.id)}}),watch:{selectedSearchFilters:function(){this.inSearching&&(this.isSearchDone?this.search(!0):this.searchPending=!0)},userInput:function(e){var t;e&&this.isSearchInputFocused&&!this.searchPopoverVisible&&(this.searchPopoverVisible=!0),null===(t=this.$refs.popover)||void 0===t||t.refreshAria()},selectedMailLabel:function(e){var t=null===e||void 0===e?void 0:e.id;if(!x.Z.isLocalSearch(t)){var i,n=e.isSystem?null===(i=I.Z[t])||void 0===i?void 0:i.id:e.name;if(this.$store.commit("changeSearchStatus",!1),this.$store.commit("clearSearchResults"),this.$store.commit("changeInSearchBox",!1),this.isSearchDone=!0,this.clearAdvSearchStatus(),this.searchPopoverVisible=!1,this.isGmail&&t!==Un.INBOX&&n)return this.$store.commit("setSearchString","in:".concat(n," ")),void(this.userInput="in:".concat(n," "));this.$store.commit("setSearchString",""),this.userInput=""}},isSearchDone:function(e){e&&this.searchPending&&this.search(!0)}},mounted:function(){var e,t,i,n,s,a;this.userInput=this.trimWithSpace(this.cachedSearchString),null===(e=this.$refs.searchInput)||void 0===e||null===(t=e.$el)||void 0===t||t.addEventListener("compositionstart",this.handleCompositionStart),null===(i=this.$refs.searchInput)||void 0===i||null===(n=i.$el)||void 0===n||n.addEventListener("compositionend",this.handleCompositionEnd),null===(s=this.$refs.searchInput)||void 0===s||null===(a=s.$el)||void 0===a||a.addEventListener("keydown",this.handleKeydown)},beforeDestroy:function(){var e,t,i,n,s,a;null===(e=this.$refs.searchInput)||void 0===e||null===(t=e.$el)||void 0===t||t.removeEventListener("compositionstart",this.handleCompositionStart),null===(i=this.$refs.searchInput)||void 0===i||null===(n=i.$el)||void 0===n||n.removeEventListener("compositionend",this.handleCompositionEnd),null===(s=this.$refs.searchInput)||void 0===s||null===(a=s.$el)||void 0===a||a.removeEventListener("keydown",this.handleKeydown)},methods:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.OI)(["setCurSearchHash","clearSplitViewSelectedMail"])),(0,u.nv)("search",["updateSelectedSearchFilters"])),(0,u.nv)("inbox",["clearSelectedInboxThreadIds"])),{},{focusOnFirst:function(){var e;(null===(e=this.$refs)||void 0===e?void 0:e.searchSuggestionRef)&&this.$refs.searchSuggestionRef.focusOnFirst()},onClickSearchInput:function(){var e=this;setTimeout((function(){e.searchPopoverVisible=!0}))},closePopover:function(){this.searchPopoverVisible=!1},onUpdateSearchFilters:function(e){this.tempSelectedSearchFilters=e,this.$refs.searchInput.focus()},handleCompositionStart:function(){this.isComposing=!0},handleCompositionEnd:function(){this.isComposing=!1,this.hasCompositionJustEnd=!0},handleKeydown:function(e){var t=e.keyCode||e.which;229!==t&&(this.hasCompositionJustEnd=!1)},handleClose:function(e){e.stopPropagation(),this.searchPopoverVisible||(this.searchPopoverVisible=!0),this.isNotInSearchMode?this.handleClearQuery():this.handleExitSearch()},handleClearQuery:function(){this.userInput="",this.$refs.searchInput.focus()},handleRecentSelection:function(e){this.userInput=e,this.isSearchDone?this.handleSubmit():this.$refs.searchInput.focus()},handleQuickSearch:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&(this.userInput=t?this.userInput.concat(" ".concat(e)):e,this.searchPopoverVisible=!1,this.handleSubmit())},handleRedirect:function(e){e&&(this.$emit("redirect",e),this.searchPopoverVisible=!1)},trimWithSpace:function(e){return e?e.trim()+" ":""},handleSubmit:function(e){this.isComposing||this.hasCompositionJustEnd?this.hasCompositionJustEnd=!1:this.userInput&&this.userInput.trim()?(this.$store.commit("changeCurrentPage",1),this.updateSelectedSearchFilters(this.tempSelectedSearchFilters),this.$store.commit("changeShowDetail",!1),this.search(!0),this.userInput=this.trimWithSpace(this.userInput)):this.userInput=""},handleSearchArchive:function(){var e=this.mailLabels.find((function(e){return x.Z.isArchive(e.id)}));this.$store.commit("changeSearchStatus",!1),this.$store.commit("clearSearchResults"),this.$store.commit("changeInSearchBox",!1),this.isSearchDone=!0,this.searchPopoverVisible=!1,this.$emit("searchFinished",Un.SEARCH,!1),this.$store.commit("changeSelectMailLabel",e);var t=e.id.toLowerCase();this.$route.params.id!==t&&this.$router.push({name:"inbox",params:{id:t}})},clearAdvSearchStatus:function(){this.tempSelectedSearchFilters=[],this.updateSelectedSearchFilters([])},search:function(){var e=arguments,t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.length>0&&void 0!==e[0]&&e[0],t.searchPending=!1,t.isSearchDone){i.next=5;break}return i.abrupt("return");case 5:if(""!==t.userInput.trim()){i.next=8;break}return t.$store.commit("changeSearchStatus",!1),i.abrupt("return");case 8:if(n&&t.$store.commit("changeSearchStatus",!0),t.$store.commit("changeInSearchBox",!0),t.$store.commit("changeInFilters",!1),t.searchPopoverVisible=!1,t.isSearchDone=!1,s=t.userInput.trim().toLowerCase(),s!==t.curSearchHash&&t.clearSelectedInboxThreadIds(),t.clearSplitViewSelectedMail(),t.setCurSearchHash(s),a=["in:archive","is:archive","in:archived","is:archived","in:archives"],!a.includes(t.userInput.replace(" ",""))){i.next=22;break}return t.handleSearchArchive(),t.$store.commit("changeSearchStatus",!1),i.abrupt("return");case 22:(t.cachedSearchString!==t.userInput||n)&&t.$store.commit("setSearchString",t.userInput),t.isNotInSearchMode&&t.$router.push({name:"inbox",params:{id:Un.SEARCH}}),t.getSearchResultThreadIds(t.userInput,s,n);case 26:case"end":return i.stop()}}),i)})))()},getSearchResultThreadIds:function(e,t,i){var n=this;return(0,o.Z)((0,r.Z)().mark((function s(){var a,l,d,u,h;return(0,r.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a=!1,(e.includes("in:trash")||e.includes("in: trash"))&&(a=!0),(e.includes("is:trash")||e.includes("is: trash"))&&(a=!0),l=function(){var i=(0,o.Z)((0,r.Z)().mark((function i(s){var a,o,l,c,d,u,h,m,p,f,v,b;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=s.labelId,o=s.threadIds,l=s.isLastPage,c=s.isLocalSearch,n.$emit("changeSearchErrorStatus",!1),n.$store.dispatch("addListThreads",{ListThreads:{labelId:a,threadIds:o}}),n.$store.commit("changeIsLastPage",{type:a,result:l}),n.$emit("isLastPage",l),d=e.trim().toLowerCase(),u=n.recentSearches.indexOf(d),-1===u?(n.recentSearches.unshift(d),n.recentSearches.length>5&&n.recentSearches.pop()):(n.recentSearches.splice(u,1),n.recentSearches.unshift(d)),o&&0!==o.length){i.next=16;break}if(!c){i.next=11;break}return i.abrupt("return");case 11:return n.$store.commit("changeSearchStatus",!1),n.handleSearchReady(),n.isSearchDone=!0,n.$emit("searchFinished",Un.SEARCH,!1),i.abrupt("return");case 16:if(n.handleSearchReady(),h=0,c){i.next=21;break}for(m=0;m<o.length;m++)p=o[m],n.monoblockSearch({hash:t,labelId:a,threadIds:[p]}).then((function(e){e.length&&t===n.curSearchHash&&n.isSearchingMails&&setTimeout((function(){n.$store.commit("changeSearchStatus",!1)}),0)}))["finally"]((function(){h++,h===o.length&&t===n.curSearchHash&&(n.isSearchDone=!0,n.$emit("searchFinished",Un.SEARCH,!1))}));return i.abrupt("return");case 21:f=(0,se.Z)(o);case 22:if(!f.length){i.next=30;break}return v=f.shift(),i.next=26,n.monoblockSearch({hash:t,labelId:a,threadIds:[v]})["finally"]((function(){h++,h===o.length&&n.curSearchHash}));case 26:b=i.sent,b.length&&t===n.curSearchHash&&n.isSearchingMails&&setTimeout((function(){n.$store.commit("changeSearchStatus",!1)}),0),i.next=22;break;case 30:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}(),d=function(){n.$store.commit("changeSearchStatus",!1),n.handleSearchReady(),n.isSearchDone=!0,n.$emit("searchFinished",Un.SEARCH,!1)},u=c.Hooks.useSearchAction(e,l,d),s.next=8,u.search({field:null,inSpamTrash:a,advSearch:{isStarred:n.selectedSearchFilters.includes("starred"),hasAttach:n.selectedSearchFilters.includes("hasAttachment"),from:n.selectedSearchFilters.includes("fromMe")?n.userEmail:null},searchFromBeginning:i});case 8:if(h=s.sent,h){s.next=17;break}return n.$emit("changeSearchErrorStatus",!0),n.$store.commit("changeIsLastPage",{type:Un.SEARCH,result:!1}),n.$emit("isLastPage",!1),n.$store.commit("changeSearchStatus",!1),n.isSearchDone=!0,n.$emit("searchFinished",Un.SEARCH,!1),s.abrupt("return");case 17:n.$emit("changeSearchErrorStatus",!1),i&&n.$store.commit("clearSearchResults");case 19:case"end":return s.stop()}}),s)})))()},handleSearchReady:function(){var e;this.userInput&&(x.Z.isLocalSearch(null===(e=this.selectedMailLabel)||void 0===e?void 0:e.id)||this.$store.commit("changeSelectPrevLabel",this.selectedMailLabel),this.$store.commit("changeSelectMailLabel",{id:Un.SEARCH}),this.$store.commit("changeInSearchBox",!0),this.$store.commit("changeInFilters",!1),this.isNotInSearchMode&&this.$router.push({name:"inbox",params:{id:Un.SEARCH}}))},monoblockSearch:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.hash,s=e.labelId,a=e.threadIds,!t.isOutlook){i.next=7;break}return i.next=4,t.doBatchSearch(s,a);case 4:i.t0=i.sent,i.next=10;break;case 7:return i.next=9,t.doSearch({hash:n,labelId:s,threadIds:a});case 9:i.t0=i.sent;case 10:return o=i.t0,o.forEach((function(e){n===t.curSearchHash&&t.$store.commit("addGetThreadHead",e)})),i.abrupt("return",o);case 13:case"end":return i.stop()}}),i)})))()},doBatchSearch:function(e,t){var i=this;return(0,o.Z)((0,r.Z)().mark((function n(){var s;return(0,r.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e&&0!==t.length){n.next=2;break}return n.abrupt("return",[]);case 2:return n.prev=2,n.next=5,y.t.getAllThreadHead(e,t,!0);case 5:return s=n.sent,n.abrupt("return",s);case 9:return n.prev=9,n.t0=n["catch"](2),i.$emit("changeSearchErrorStatus",!0),n.abrupt("return",[]);case 13:case"end":return n.stop()}}),n,null,[[2,9]])})))()},doSearch:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,l,c,d,u,h,m,p,f,v;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.hash,s=e.labelId,a=e.threadIds,0!==a.length){i.next=3;break}return i.abrupt("return",[]);case 3:return o=[],i.prev=4,i.next=7,y.t.experientialGetThreadsHead(s,a);case 7:l=i.sent,c=(0,ne.Z)(l.entries());try{for(c.s();!(d=c.n()).done;)u=(0,kn.Z)(d.value,2),h=u[0],m=u[1],"fulfilled"===m.status?(p=m.value,f=p.result,v=p.returnCode,0===v?o.push(f):(t.retryQueue.push({labelId:s,threadId:a[h]}),t.retrySearch(n))):(t.retryQueue.push({labelId:s,threadId:a[h]}),t.retrySearch(n))}catch(r){c.e(r)}finally{c.f()}return i.abrupt("return",o);case 13:return i.prev=13,i.t0=i["catch"](4),t.$emit("changeSearchErrorStatus",!0),i.abrupt("return",[]);case 18:case"end":return i.stop()}}),i,null,[[4,13]])})))()},retrySearch:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.retryQueue.length&&e===t.curSearchHash){i.next=2;break}return i.abrupt("return");case 2:n=t.retryQueue.pop(),s=n.labelId,a=n.threadId,y.t.getOneThreadHead(s,a).then(function(){var i=(0,o.Z)((0,r.Z)().mark((function i(n){return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(0===(null===n||void 0===n?void 0:n.returnCode)){i.next=3;break}return i.abrupt("return");case 3:if(e!==t.curSearchHash){i.next=13;break}return t.$store.commit("addGetThreadHead",n.result),i.next=9,t.$nextTick();case 9:t.$store.commit("changeSearchStatus",!1),i.next=14;break;case 13:case 14:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())["finally"]((function(){t.retryQueue.length||e!==t.curSearchHash||t.$store.commit("changeSearchStatus",!1)})),t.retrySearch(e);case 5:case"end":return i.stop()}}),i)})))()},handleExitSearch:function(){var e,t;if(this.$store.commit("changeSearchStatus",!1),this.$store.commit("clearSearchResults"),this.$store.commit("setSearchString",""),this.$store.commit("changeInSearchBox",!1),this.clearAdvSearchStatus(),null!==(e=this.selectPrevLabel)&&void 0!==e&&e.id)this.$store.commit("changeSelectMailLabel",this.selectPrevLabel),t=this.selectPrevLabel.id.toLowerCase();else{var i=this.mailLabels.find((function(e){return(0,ue.WP)(e)}));this.$store.commit("changeSelectMailLabel",i),t=null===i||void 0===i?void 0:i.id.toLowerCase()}this.$route.params.id!==t&&this.$router.push({name:"inbox",params:{id:t}})}})},Bn=Vn,Gn=(0,D.Z)(Bn,Cn,Ln,!1,null,"2b046558",null),Wn=Gn.exports,jn=c.Business.ReplaceInlineImageSrcPlugin,Xn=c.Enums.SystemDefinedMailLabelIds,Kn=c.Enums.ACTIONS_BY_PROVIDER_AND_LABEL,Jn=c.Enums.MailMarkAction,Yn=c.Enums.INBOX_LIST_TYPE,qn={name:"Inbox",components:{LowStorageUsageTips:yn,inboxItem:Ft,InboxSections:bn,RecycleScroller:dt,CategoryTabs:Yt,ControlHeader:mi,SvgIcon:g.Z,detail:me.Z,ConfirmDialog:fi.Q,AddFilterDialog:pi["default"],SettingsDropdown:Zi,OfflineModeInboxBanner:Ui,Search:Wn},mixins:[Lt.Z,C.Z],provide:function(){var e=this;return{threadActions:{moveToInbox:function(t){e.handleMove(t)}},splitViewSelections:{nextSelection:function(t){return e.findNextSelection(t)},controlAction:function(t){e.splitViewControlAction(t)}}}},data:function(){var e=this;return{version:gi.Z.version,fixedJiras:gi.Z.fixedJiras,showDevJIRA:!1,showGetStartedModal:!1,xDir:0,errorStatus:!1,searchErrorStatus:!1,isLocalLastPage:!1,index:0,refreshRun:!1,selectedMailInThread:null,responseItemMailLabels:[],storedTime:null,isIndeterminate:!1,checkAll:!1,showActions:!1,selectItem:{},actionX:0,actionY:0,allContextMenuSendersAreSelf:!0,allSelectedInvalidToSpam:!0,selectedSenderIsApproved:!0,isInitingNewLabelThreads:!1,currentLoadingInboxDetailThreadId:"",filteredThreadHeads:{},loadingState:{},loadTimer:null,hasBold:{},customPaneMode:{splitMode:1,mailListWidth:"34%"},showApproveUserDialog:!1,approveUserActions:[{id:"cancel",className:"cancel-report-spam tab-focus",handler:this.cancelApprove,text:this.$t("operation.cancel")},{id:"blockUser",className:"report-spam tab-focus",handler:this.approveUser,text:this.$t("operation.approve"),type:"primary"}],showReportPhishingDialog:!1,reportPhishingActions:[{id:"cancelPhishing",className:"cancel-report-spam",handler:function(){e.showReportPhishingDialog=!1},text:this.$t("operation.cancel")},{id:"reportPhishing",className:"report-spam",handler:function(){var t=(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showReportPhishingDialog=!1,t.next=3,e.reportPhishing(e.selectedInboxThreadIds);case 3:e.clearSelectedInboxThreadIds();case 4:case"end":return t.stop()}}),t)})));function i(){return t.apply(this,arguments)}return i}(),text:this.$t("operation.report"),type:"primary"}]}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["isOffline","needReauthorize","typeOfEmail","isSearchingMails","isFilteringMails","inSearching","searchString","inFilters","maxNumberMailsPerRequest","isTestClient","showDetail","mailLabels","selectMailLabel","selectPrevLabel","ListThreads","isLastPage","LastInboxRefreshDate","currentPage","isPaginated","scrollPositionY","scaleRadio","isSplitView","showSplitDefault","splitViewSelectedMails","userProfile","instantDraftList","labelPositionMap","allowMailExternalImg","actionOrdering","recipientInfo"])),(0,u.rn)("auth",["isFirstLogin","isAuthed"])),(0,u.rn)("inbox",["lastSelectedInboxThreadId","inboxType"])),(0,u.Se)(["isGmail","sidebarMenuWidth","isZmail","isOutlook","getLabelIdByTId","isOfflineByDisconection"])),(0,u.Se)("inbox",["selectedInboxThreadIds","inboxSectionVisible"])),(0,u.Se)("delegate",{delegateSettings:"getDelegateSettings"})),{},{shouldShowEmptyState:function(e){var t=e.inboxList,i=e.isFilteringMails,n=e.isSearchingMails;return 0===t.length&&!i&&!n},listText:function(){var e,t=(e={},(0,ae.Z)(e,Xn.INBOX,"list.noEmailsInInbox"),(0,ae.Z)(e,Xn.STARRED,"list.noEmailsInStarred"),(0,ae.Z)(e,Xn.DRAFT,"list.noEmailsInDrafts"),(0,ae.Z)(e,Xn.SENT,"list.noEmailsInSent"),(0,ae.Z)(e,Xn.TRASH,"list.noEmailsInTrash"),(0,ae.Z)(e,Xn.ARCHIVE,"list.noEmailsInArchive"),(0,ae.Z)(e,Xn.SPAM,"list.noEmailsInSpam"),(0,ae.Z)(e,Xn.BLOCKED,"list.noEmailsInBlocked"),e);return this.$t(t[this.currentLabelId])||this.$t("list.noEmailsInLabel")},isDetailInList:function(){var e=this,t=this.mails.findIndex((function(t){var i;return t.threadId===(null===(i=e.$store.state.splitViewSelectedMails[e.currentLabelId])||void 0===i?void 0:i.threadId)}));return-1!==t},mailCount:function(){var e=this;return x.Z.isLocalSearch(this.selectMailLabel.id)||x.Z.isArchive(this.selectMailLabel.id)?this.isLastPage.get(this.selectMailLabel.id)?this.ListThreads[this.selectMailLabel.id]["ListThreads"]["threadIds"].length:null:this.mailLabels.find((function(t){return t.id===e.selectMailLabel.id})).count.threadsTotal},filterEdits:function(){var e,t,i,n,s=this,a="";if(this.showDetail)a=null===(i=this.selectedMailInThread)||void 0===i||null===(n=i.from)||void 0===n?void 0:n.emailAddr;else if(null!==(e=this.selectItem)&&void 0!==e&&null!==(t=e.threadHead)&&void 0!==t&&t.userEmailStatusList){var r,o,l,c;a=null===(r=this.selectItem)||void 0===r||null===(o=r.threadHead)||void 0===o||null===(l=o.userEmailStatusList[0])||void 0===l||null===(c=l.userEmail)||void 0===c?void 0:c.emailAddr}else if(this.selectedInboxThreadIds.length>0){var d=[];this.selectedInboxThreadIds.forEach((function(e){var t,i,n,a,r=null===(t=s.GetThreadHead[e])||void 0===t||null===(i=t.threadHead)||void 0===i||null===(n=i.userEmailStatusList[0])||void 0===n||null===(a=n.userEmail)||void 0===a?void 0:a.emailAddr;r&&"string"===typeof r&&d.push(r)})),a=(0,se.Z)(new Set(d)).join(" OR ")}return{id:"",criteria:{from:a,to:"",subject:"",query:"",negatedQuery:"",hasAttachment:!1,excludeChats:!1,size:"",sizeComparison:"larger"},action:{removeLabelIds:[],addLabelIds:[]}}},filterThreadIds:function(){var e,t,i,n,s,a;return this.showDetail?null===(i=this.selectedMailInThread)||void 0===i||null===(n=i.mailHead)||void 0===n?void 0:n.msgId:null!==(e=this.selectItem)&&void 0!==e&&null!==(t=e.threadHead)&&void 0!==t&&t.threadId?null===(s=this.selectItem)||void 0===s||null===(a=s.threadHead)||void 0===a?void 0:a.threadId:this.selectedInboxThreadIds.length>0?this.selectedInboxThreadIds:[]},pageCount:function(){return null===this.mailCount?null:Math.ceil(this.mailCount/this.maxNumberMailsPerRequest)},noMorePrev:function(){return 1===this.currentPage},noMoreNext:function(){return this.currentPage===this.pageCount},responseCheckboxGroup:function(){return this.cachedUserLabels.length>5?"response-checkbox-group":""},cachedUserLabels:function(){return this.mailLabels.filter((function(e){return!e.isSystem}))},currentLabelId:function(){var e;return null===(e=this.selectMailLabel)||void 0===e?void 0:e.id},currentLabelName:function(){var e;return null===(e=this.selectMailLabel)||void 0===e?void 0:e.name},isNotInOutbox:function(){return this.currentLabelId!==Xn.OUTBOX},isShowControlHeader:function(){return this.isNotInOutbox},canDeleteForever:function(){return this.currentLabelId===Xn.TRASH&&this.isZmail},copyCurrentThreadList:function(){return this.currentThreadList.map((function(e){return{id:e}}))},currentThreadList:function(){var e,t,i;return(null===(e=this.ListThreads)||void 0===e||null===(t=e[this.currentLabelId])||void 0===t||null===(i=t.ListThreads)||void 0===i?void 0:i.threadIds)||[]},GetThreadHead:function(){return this.$store.state.GetThreadHead[this.currentLabelId]||{}},markRead:function(){var e=this;return this.selectedInboxThreadIds.filter((function(t){var i,n,s;return null===(i=e.GetThreadHead)||void 0===i||null===(n=i[t])||void 0===n||null===(s=n.threadHead)||void 0===s?void 0:s.isUnread})).length>0},markStarred:function(){var e=this;return this.selectedInboxThreadIds.filter((function(t){var i,n,s;return!(null!==(i=e.GetThreadHead)&&void 0!==i&&null!==(n=i[t])&&void 0!==n&&null!==(s=n.threadHead)&&void 0!==s&&s.isStarred)})).length>0},readStatus:function(){var e,t,i=this.selectItem.threadId;return i&&!(null!==(e=this.GetThreadHead)&&void 0!==e&&null!==(t=e[i])&&void 0!==t&&t.threadHead.isUnread)},selectingTrashLabel:function(){var e;return(null===(e=this.selectItem)||void 0===e?void 0:e.labelId)===Xn.TRASH},archiveStatus:function(){return(0,ue.XP)(this.currentLabelId)},isSpammed:function(){return this.currentLabelId===Xn.SPAM},spamStatus:function(){return this.isSpammed?this.isGmail?this.$t("operation.removeFromSpamStatus"):this.$t("operation.reportNotSpamStatus"):this.isGmail?this.$t("operation.markAsSpamStatus"):this.$t("operation.reportSpamStatus")},showMove2Trash:function(){var e;return(null===(e=this.selectItem)||void 0===e?void 0:e.labelId)!==Xn.TRASH},move2TrashText:function(){return this.isOutlook?this.$t("operation.delete"):this.$t("operation.trash")},showMove2Inbox:function(){var e;return[Xn.TRASH,Xn.ARCHIVE].includes(null===(e=this.selectItem)||void 0===e?void 0:e.labelId)},move2InboxText:function(){return this.$t("operation.moveToInbox")},trashOrMoveToInboxText:function(){return this.selectingTrashLabel?this.$t("operation.moveToInbox"):this.isOutlook?this.$t("operation.delete"):this.$t("operation.trash")},hasDrafts:function(){var e,t;return null===(e=this.selectItem)||void 0===e||null===(t=e.threadHead)||void 0===t?void 0:t.userEmailStatusList.some((function(e){return e.isDraft}))},groupMails:function(){var e=this,t=(new Date).getTime(),i={};return Object.values(this.GetThreadHead).forEach((function(n){var s=n&&n.threadHead&&1e3*n.threadHead.date,a=(0,ue.Gt)(s,t),r=a,o=Xn.USER_SCHEDULED,l=Xn.DRAFT;r=[o,l].includes(e.currentLabelId)?a:"Upcoming"===a?"Today":a,i[r]||(i[r]=[]),i[r].push(n)})),i},selectedInboxItems:function(){var e=this;return this.selectedInboxThreadIds.filter((function(t){return e.GetThreadHead[t]})).map((function(t){return{groupId:t,msgIds:e.GetThreadHead[t].msgIds}}))},mails:function(){if(!this.isPaginated)return this.flattenMails(this.groupMails);var e=this.flattenMails(this.groupMails),t=(this.currentPage-1)*this.maxNumberMailsPerRequest,i=this.currentPage*this.maxNumberMailsPerRequest;return e.slice(t,i)},canSpam:function(){return this.currentLabelId!==Xn.OUTBOX&&this.currentLabelId!==Xn.SENT},groupLabel:function(){return Xn.GROUP_APPROVAL},isLoading:function(){var e;return(null===(e=this.loadingState[this.currentLabelId])||void 0===e?void 0:e.isLoading)||!1},inboxList:function(){return this.inboxSectionVisible&&this.$refs.inboxSections?this.$refs.inboxSections.getCurrentVisibleMails():this.mails.filter((function(e){return!e.isPlain}))},isSingleCheckedInboxItem:function(){return 1===this.selectedInboxThreadIds.length},selectedUserEmail:function(){var e,t=this.selectedInboxThreadIds[0],i=this.GetThreadHead[t],n=i.threadHead.userEmailStatusList;return null===(e=n[n.length-1])||void 0===e?void 0:e.userEmail},actionMap:function(){var e=this,t=!(this.isZmail&&this.allSelectedInvalidToSpam),i=!this.selectedSenderIsApproved&&1===this.selectedInboxThreadIds.length;return(0,l.Z)((0,l.Z)({delete:{shortcutKey:this.selectMailLabel.id===Xn.TRASH?"not-support":"delete",iconClass:"delete",label:this.selectMailLabel.id===Xn.TRASH?this.$t("operation.deleteForever"):this.$t("operation.delete"),onClick:function(){return e.handleTrash("all")}},star:{shortcutKey:this.markStarred?"mark-starred":"mark-unstarred",iconClass:this.markStarred?"star":"unstar",label:this.markStarred?this.$t("operation.star"):this.$t("operation.removeStar"),onClick:function(){return e.handleMark("all",e.markStarred?"Starred":"UnStarred")},taTag:this.markStarred?"star":"remove-star"},label:{iconClass:"stroke",label:this.$t("operation.label")},move:{iconClass:"move",label:this.$t("operation.move")},moveToInbox:{iconClass:"move-to-inbox",label:this.$t("operation.moveToInbox"),onClick:function(){return e.handleItemMove("selected")}},unread:{shortcutKey:this.markRead?"mark-read":"mark-unread",iconClass:this.markRead?"read":"unread",label:this.markRead?this.$t("operation.markAsRead"):this.$t("operation.markAsUnread"),onClick:function(){return e.handleMark("all",e.markRead?"Read":"UnRead")},taTag:this.markRead?"mark-as-read":"mark-as-unread"},archive:{shortcutKey:"archive",iconClass:"archive",label:this.$t("operation.archive"),onClick:function(){return e.handleItemArchive("selected")}},filter:{iconClass:"funnel",label:this.$t("operation.createFilterFromMessages"),onClick:function(){return e.showCreateFilterDialog()}},cancelSend:{label:this.$t("operation.cancelScheduled"),onClick:function(){return e.handleCancelScheduledSend(e.selectedInboxThreadIds)}},discardDraft:{label:this.$t("operation.discardDrafts"),onClick:function(){return e.handleDiscardDrafts(!0)}}},i&&{approve:{label:this.$t("operation.approve"),onClick:this.showApproveDialog}}),t&&{spam:{shortcutKey:"report-spam",iconClass:this.selectMailLabel.id!==Xn.SPAM?"spam":"",label:this.isSpammed?this.$t("operation.notSpam"):this.$t("operation.spam"),onClick:function(){e.handleSpamForSelectionNRightClick(!1)},taTag:this.isSpammed?"remove-from-spam":"mark-as-spam"},phishing:{iconClass:"phishing",label:this.$t("operation.reportPhishing"),onClick:function(){if(e.isGmail)e.handleReportPhishing();else if(e.isZmail){if(e.allSelectedInvalidToSpam)return;e.currentLabelId!==Xn.SPAM&&e.moveThreadsToSpam(e.selectedInboxItems)}}}})},actions:function(){var e,t,i=this,n=this.typeOfEmail,s=Kn[n]||{},a=s[this.selectMailLabel.id]||s["FALLBACK"]||[],r=a.map((function(e){return e.filter((function(e){return i.actionMap[e]})).map((function(e){return(0,l.Z)({key:e},i.actionMap[e])}))}));null===(e=r[0])||void 0===e||e.sort((function(e,t){var n=e.key,s=t.key,a=i.actionOrdering.indexOf(n),r=i.actionOrdering.indexOf(s);return a<0&&(a=i.actionOrdering.length),r<0&&(r=i.actionOrdering.length),a-r}));var o=[this.$t("operation.discardDrafts"),this.$t("operation.notSpam")];return null===(t=r[0])||void 0===t||t.sort((function(e){var t=e.label;return o.includes(t)?-1:0})),r},isInPrivateBox:function(){return this.currentLabelId===Xn.PRIVATE}}),watch:{scaleRadio:function(e){this.updateZoomRadio(e)},showDetail:function(e){var t;e||(null===(t=this.$refs.recycleScroller)||void 0===t||t.updateVisibleItems(!0),this.$store.commit("clearRecipientInfo"))},$route:function(e){var t,i,n=e.path,s=e.query.threadId,a=e.params.id,r=null===n||void 0===n?void 0:n.startsWith("/main/inbox");r&&(this.clearSelectedInboxThreadIds(),this.clearLastSelectedInboxThreadId(),s&&this.autoOpenThreadHandler(s),a!==Xn.SEARCH&&(null===(t=this.$refs)||void 0===t||null===(i=t.searchRef)||void 0===i||i.clearAdvSearchStatus()))},currentLabelId:function(e,t){var i,n=this;if(t===Et.v8&&this.$store.commit("setSplitViewSelectedMails",(0,ae.Z)({},t,null)),!e)return!1;if(this.isLocalLastPage=!1,this.$store.commit("changeCurrentPage",1),e===Xn.DRAFT&&this.$store.commit("setSplitViewSelectedMails",(0,ae.Z)({},e,null)),this.isSplitView&&this.$store.state.splitViewSelectedMails[e]&&e!==Et.v8&&e!==Xn.DRAFT){this.$store.commit("changeShowSplitDefault",!1);var s=this.$store.state.splitViewSelectedMails[e];this.handleShowDetail(s,!1,!1,!0)}else this.isSplitView&&(this.$store.commit("changeShowDetail",!1),this.$store.commit("changeShowSplitDefault",!0));this.labelPositionMap[e]?this.$nextTick((function(){var t;null===(t=n.$refs.recycleScroller)||void 0===t||t.scrollToPosition(n.labelPositionMap[e])})):this.$nextTick((function(){var e;null===(e=n.$refs.recycleScroller)||void 0===e||e.scrollToPosition(0)})),null===(i=this.$refs.recycleScroller)||void 0===i||i.updateVisibleItems(!0),this.checkIsLabelInit()||(this.setLoadingState(),(this.ListThreads&&!this.ListThreads[e]||this.ListThreads&&this.ListThreads[e]&&this.ListThreads[e].ListThreads&&this.ListThreads[e].ListThreads.threadIds&&(!this.ListThreads[e].ListThreads.threadIds||this.ListThreads[e].ListThreads.threadIds.length<=100))&&e!==Xn.SEARCH&&(this.isInitingNewLabelThreads=!0,this.handleRefresh()["finally"]((function(){n.isInitingNewLabelThreads=!1}))))},activeKeyBinding:function(e){var t,i=e.action,n=e.event;if(n&&!(0,ue.LJ)(n)&&(!this.showDetail||this.isSplitView)){null===n||void 0===n||n.preventDefault();var s=(0,le.flattenDeep)(this.actions.slice(0,2)),a=s.find((function(e){return e.shortcutKey===i}));a&&null!==this&&void 0!==this&&null!==(t=this.selectedInboxItems)&&void 0!==t&&t.length&&a.onClick()}},inboxList:function(e){var t=this;!this.isInitingNewLabelThreads&&this.isAuthed&&"LOCAL_ID_SEARCH"!==this.currentLabelId&&this.$nextTick((function(){var i=(null===e||void 0===e?void 0:e.length)<t.maxNumberMailsPerRequest;i&&!t.isLocalLastPage&&t.handleRefresh()}))},selectedInboxThreadIds:function(e){this.verifySelectInboxes(e)},inboxType:function(e,t){var i=this;(null===t||void 0===t?void 0:t.type)===Yn.DEFAULT&&(null===e||void 0===e?void 0:e.type)!==Yn.DEFAULT&&this.$nextTick((function(){i.$refs.inboxSections&&i.$refs.inboxSections.fetchAllSectionMails()}))}},created:function(){var e=this;this.isPaginated||(this.throttleHandleMouseWheel=(0,le.debounce)(this.handleMouseWheel,96,{leading:!0}),this.throttleHandleSyncMail=(0,le.throttle)(this.handleSync,1e3),this.$once("hook:beforeDestroy",(function(){e.throttleHandleMouseWheel.cancel(),e.throttleHandleSyncMail.cancel()}))),document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("focus",this.refreshIfDateChanged)},mounted:function(){var e,t=this;d.Mail.getMailGptLicenseState().then((function(e){t.setGPTService(e)})),this.fetchSplitConfig(),this.updateZoomRadio(this.scaleRadio),this.showGetStartedModal=this.isFirstLogin&&this.isZmail,this.isZmail&&he.t.listSpammedUsers(),this.scrollPositionY&&setTimeout((function(){var e;null===(e=t.$refs.recycleScroller)||void 0===e||e.scrollToPosition(t.scrollPositionY),t.clearScrollPositionY()})),this.checkIsLabelInit()||(this.setLoadingState(),this.handleRefresh()),oe()(window).on("click",this.handleClickOnWindow=function(){t.showActions=!1,t.selectItem={}}),null===(e=document.getElementById("resizer"))||void 0===e||e.addEventListener("mousedown",this.resizeMouseDownHandler),this.setupMultiSelectHandlers()},beforeDestroy:function(){var e;this.loadTimer&&clearTimeout(this.loadTimer),this.loadTimer=null,oe()(window).off("click",this.handleClickOnWindow),this.cleanupMultiSelectHandlers(),window.removeEventListener("focus",this.refreshIfDateChanged),document.removeEventListener("visibilitychange",this.handleVisibilityChange),null===(e=document.getElementById("resizer"))||void 0===e||e.removeEventListener("mousedown",this.resizeMouseDownHandler)},methods:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.OI)(["setCurrentInboxItem","setCurrentInboxItemThreadId","clearCurrentInboxItemThreadId","setScrollPositionY","clearScrollPositionY","setSplitView","addInstantDraftList","changeShowSplitDefault","setSplitViewSelectedMails","clearSplitViewSelectedMails","changeRecipientInfo","clearRecipientInfo","addGetThreadHead"])),(0,u.OI)("features",["setGPTService"])),(0,u.nv)("inbox",["addSelectedInboxThreadIds","removeSelectedInboxThreadIds","resetSelectedInboxThreadIds","clearSelectedInboxThreadIds","setLastSelectedInboxThreadId","clearLastSelectedInboxThreadId","setLastReadInboxThreadId","clearLastReadInboxThreadId"])),{},{onSettingDropdownOpened:function(){var e,t;null===(e=this.$refs.searchRef)||void 0===e||null===(t=e.closePopover)||void 0===t||t.call(e)},verifySelectInboxes:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isZmail){t.next=2;break}return t.abrupt("return");case 2:e.verifySelectInboxesSpam(e.selectedInboxThreadIds),e.verifySelectInboxesApprove();case 4:case"end":return t.stop()}}),t)})))()},verifySelectInboxesSpam:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.allSelectedInvalidToSpam=!0,t.currentLabelId!==c.Enums.SystemDefinedMailLabelIds.SPAM){i.next=4;break}return t.allSelectedInvalidToSpam=!1,i.abrupt("return");case 4:n=(0,ne.Z)(e),i.prev=5,a=(0,r.Z)().mark((function e(){var i,n,a,o;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=s.value,e.next=3,d.Thread.getThreadMailDetails({labelId:t.currentLabelId,threadId:i});case 3:if(n=e.sent,a=t.userProfile.userEmail,o=n.find((function(e){var t=e.from.emailAddr,i=e.mailHead.isUserScheduled;return a.toLowerCase()===t.toLowerCase()||i})),o){e.next=10;break}t.allSelectedInvalidToSpam=!1,e.next=13;break;case 10:if(!o){e.next=13;break}return t.allSelectedInvalidToSpam=!0,e.abrupt("return","break");case 13:case"end":return e.stop()}}),e)})),n.s();case 8:if((s=n.n()).done){i.next=15;break}return i.delegateYield(a(),"t0",10);case 10:if(o=i.t0,"break"!==o){i.next=13;break}return i.abrupt("break",15);case 13:i.next=8;break;case 15:i.next=20;break;case 17:i.prev=17,i.t1=i["catch"](5),n.e(i.t1);case 20:return i.prev=20,n.f(),i.finish(20);case 23:case"end":return i.stop()}}),i,null,[[5,17,20,23]])})))()},verifySelectInboxesApprove:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectedSenderIsApproved=!0,1!==e.selectedInboxThreadIds.length){t.next=6;break}return t.next=4,he.t.listSpammedUsers();case 4:i=t.sent,e.selectedSenderIsApproved=i.some((function(t){var i=t.email,n=t.status;return n===Et.NW.ALLOWLIST&&i===e.selectedUserEmail.emailAddr}));case 6:case"end":return t.stop()}}),t)})))()},isThreadExist:function(e){return this.GetThreadHead[e]},getAllContextMenuSendersAreSelf:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.selectItem,t.next=3,d.Thread.getThreadMailDetails(i);case 3:return n=t.sent,s=e.userProfile.userEmail,t.abrupt("return",n.find((function(e){var t=e.from.emailAddr,i=e.mailHead.isUserScheduled;return s.toLowerCase()===t.toLowerCase()||i})));case 6:case"end":return t.stop()}}),t)})))()},autoOpenThreadHandler:function(e){var t=this;this.currentLabelId!==Xn.INBOX&&this.switchToInbox();var i=this.mails,n=i.findIndex((function(t){return t.msgIds&&t.msgIds.includes(e)}));n>-1&&(this.$refs.recycleScroller.scrollToItem(n),setTimeout((function(){t.handleShowDetail(i[n],!0,!0)}),200))},resizeMouseDownHandler:function(e){e.preventDefault(),this.xDir=e.clientX,document.addEventListener("mousemove",this.resizeMouseMoveHandler),document.addEventListener("mouseup",this.resizeMouseUpHandler)},resizeMouseMoveHandler:function(e){e.preventDefault();var t=document.getElementById("resizer"),i=t.previousElementSibling,n=e.clientX-this.xDir,s=i.getBoundingClientRect().width,a=100*(s+n)/t.parentNode.getBoundingClientRect().width;a<50&&(i.style.width="".concat(a,"%"),this.xDir=e.clientX)},resizeMouseUpHandler:function(){if(document.removeEventListener("mousemove",this.resizeMouseMoveHandler),document.removeEventListener("mouseup",this.resizeMouseUpHandler),this.isSplitView){var e=document.getElementById("mail-list");this.customPaneMode.mailListWidth=e.style.width,this.setSplitConfig({splitMode:1,mailListWidth:this.customPaneMode.mailListWidth})}},openCreateFilter:function(e){this.selectedMailInThread=e,this.showCreateFilterDialog()},showCreateFilterDialog:function(){this.$refs.addFilterDialog.open(),this.$metric.report("filter_messages_like_these",{msgId:this.filterThreadIds})},onPrivateAction:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showActions=!1,i=[e.selectItem.threadId],e.selectedInboxThreadIds.length&&(i=e.selectedInboxThreadIds),t.prev=3,t.next=6,Promise.all(i.map(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(i){var n,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,y.t.getThreadHead(e.currentLabelId,i);case 2:return n=t.sent,s=n.GetThreadHead,t.abrupt("return",s);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:n=t.sent,s=e.isInPrivateBox?Mt.b_:Mt.OJ,s(n,e.currentLabelId),t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](3);case 14:case"end":return t.stop()}}),t,null,[[3,12]])})))()},setSelectInboxes:function(e){this.resetSelectedInboxThreadIds({threadIds:e})},handleCheckMore:function(e){var t={All:this.selectAllThreads,None:this.unselectAllThreads,Unread:this.selectAllUnreadThreads,Read:this.selectAllReadThreads,Starred:this.selectStarredThreads,Unstarred:this.selectAllUnstarredThreads},i=t[e];i(),this.clearLastSelectedInboxThreadId()},handleMouseWheel:function(e){var t=this.errorStatus||this.searchErrorStatus;if(!this.isPaginated&&!t){if(e.deltaY>0){var i,n=null===(i=this.$refs.recycleScroller)||void 0===i?void 0:i.$_endIndex,s=this.flattenMails(this.groupMails).length;n<=s&&n>s-5&&this.handleRefresh()}this.showActions=!1}},onScrollEnd:function(){this.isPaginated||(this.handleRefresh(),this.showActions=!1)},updateZoomRadio:function(e){var t=this;["headerBar","contextMenu"].forEach((function(i){t.$refs[i]&&(t.$refs[i].style.zoom="".concat(100*e,"%"))})),this.$refs.controlHeader&&(this.$refs.controlHeader.$refs.controlHeader.style.zoom="".concat(100*e,"%"))},setLoadingState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentLabelId,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.loadingState[e]||this.$set(this.loadingState,e,{}),this.$set(this.loadingState[e],"isLoading",t)},switchToInbox:function(){var e=this;this.$store.commit("changeInSearchBox",!1),this.showActions=!1,this.selectItem={};var t=this.mailLabels.find((function(e){return e.id===Xn.INBOX}));this.$router.push({name:"inbox",params:{id:"inbox"}},(function(){e.$store.commit("changeSelectMailLabel",t),e.$store.commit("changeSelectPrevLabel",t),e.$store.commit("changeInSearchBox",!1),e.$store.commit("changeInFilters",!1)}))},handleShowDetail:function(e){var t=arguments,i=this;return(0,o.Z)((0,r.Z)().mark((function n(){var s,a,o,l,u,h,m,p,f,v,b,g,S,I,x,w;return(0,r.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.length>1&&void 0!==t[1]&&t[1],o=t.length>2&&void 0!==t[2]&&t[2],l=t.length>3&&void 0!==t[3]&&t[3],u=t.length>4&&void 0!==t[4]&&t[4],h=t.length>5&&void 0!==t[5]&&t[5],m=(null===(s=i.$store.state.splitViewSelectedMails[i.currentLabelId])||void 0===s?void 0:s.threadId)===e.threadId&&i.currentLabelId!==Xn.DRAFT,!i.isSplitView||!m||l||a){n.next=9;break}return n.abrupt("return");case 9:if((o||i.isSplitView&&!u)&&i.currentLabelId!==Xn.DRAFT&&(i.$store.commit("changeShowDetail",!1),i.$store.commit("changeShowSplitDefault",!1)),e){n.next=13;break}return n.abrupt("return");case 13:if(i.$store.state.isSplitView&&i.$store.commit("setSplitViewSelectedMails",(0,ae.Z)({},i.currentLabelId,e)),p=i.instantDraftList.find((function(t){var i,n;return(null===(i=t.composeItem)||void 0===i||null===(n=i.mailHead)||void 0===n?void 0:n.threadId)===(null===e||void 0===e?void 0:e.threadId)})),!p||i.currentLabelId!==Xn.DRAFT){n.next=20;break}return i.currentLoadingInboxDetailThreadId="",i.$store.state.isSplitView&&(i.$store.commit("changeShowDetail",!1),i.$store.commit("changeShowSplitDefault",!0)),i.$compose({composeItem:p.composeItem,isDraft:!0}),n.abrupt("return");case 20:return i.inboxList.length&&i.inboxList[i.inboxList.length-1].threadId===e.threadId&&i.handleRefresh(),i.currentLoadingInboxDetailThreadId=e.threadId,f=i.getLabelIdByTId(i.currentLabelId,e.threadId),i.setCurrentInboxItemThreadId(e.threadId),i.setCurrentInboxItem(i.getThreadHeadByTId(f,e.threadId)),i.responseItemMailLabels=e.threadHead.showLabelIds,i.currentLabelId!==Xn.OUTBOX&&i.currentLabelId!==Xn.DRAFT&&i.setLastReadInboxThreadId({threadId:e.threadId}),n.next=29,d.Thread.getThreadMailDetails({threadId:e.threadId,labelId:f});case 29:if(v=n.sent,v){n.next=34;break}return i.currentLoadingInboxDetailThreadId="",n.abrupt("return");case 34:if(v.sort((function(e,t){return e.mailHead.date-t.mailHead.date})),e.threadHead.snippet||(g=v[v.length-1],S=(null===g||void 0===g||null===(b=g.mailHead)||void 0===b?void 0:b.snippet)||c.Utils.getMailSnippet(g.content),i.$store.commit("changeGetThreadHead",{labelId:e.labelId,threadId:e.threadId,type:"snippet",status:S})),!i.userProfile.isDelegated){n.next=42;break}if(!e.threadHead.isUnread||h||!i.delegateSettings.markAsRead){n.next=40;break}return n.next=40,i.handleMark(e,"Read");case 40:n.next=45;break;case 42:if(!e.threadHead.isUnread||h){n.next=45;break}return n.next=45,i.handleMark(e,"Read");case 45:if(i.$store.commit("setSelectMailDetail",v),v.forEach((function(e){var t=[e.from].concat((0,se.Z)(e.to),(0,se.Z)(e.cc),(0,se.Z)(e.bcc));t.forEach((function(e){e.emailAddr.includes(Et.aE)||i.$store.commit("changeRecipientInfo",{id:e.emailAddr,displayName:e.displayName})}))})),I="SELECT_MAIL_DETAIL_CHANGED",a&&i.$Bus.$emit(I),1!==v.length||!v[0].mailHead.isDraft){n.next=59;break}return i.currentLoadingInboxDetailThreadId="",i.$store.state.isSplitView&&(i.$store.commit("changeShowDetail",!1),i.$store.commit("changeShowSplitDefault",!0)),x=jn.getInlineImageSrcMap(v[0]),w=(0,zi.Z)(v[0].content,{inlineImageSrcMap:x}),v[0].content=w.sanitize({filterDarkModeStyles:!0,filterThirdPartyLinks:!i.allowMailExternalImg}).process({needFold:!1,injectStyle:!1,injectScript:!1,lazyLoad:!1}).generate(),w.destroy(),w=null,i.$compose({composeItem:v[0],isDraft:!0}),n.abrupt("return");case 59:setTimeout((function(){i.$store.commit("changeShowDetail",!0),i.currentLoadingInboxDetailThreadId=""}),0);case 60:case"end":return n.stop()}}),n)})))()},deSelectItem:function(e){this.selectedInboxThreadIds.indexOf(e.threadId)>=0&&this.resetSelectedInboxThreadIds({threadIds:this.selectedInboxThreadIds.filter((function(t){return t!==e.threadId}))}),this.lastSelectedInboxThreadId===e.threadId&&this.clearLastSelectedInboxThreadId()},handleItemDelete:function(e){this.handleTrash(e),this.deSelectItem(e)},moveThreadsToSpam:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=t.findNextSelection(e),i.next=3,vi.l.moveThreads(e,t.currentLabelId,"SPAM");case 3:s=i.sent,0===s.returnCode?(t.$undoNotice({iconClass:"checkmark",title:t.$t("operation.movedToSpam")}),t.splitViewControlAction(n),t.clearSelectedInboxThreadIds()):t.$msg(t.$t("operation.moveFailed"));case 5:case"end":return i.stop()}}),i)})))()},handleItemMove:function(e){this.handleMove("selected"===e?this.selectedInboxItems:[e]),this.metricItemAction("moveToInbox","selected"===e?this.selectedInboxItems.map((function(e){return e.groupId})):e.threadId)},handleItemArchive:function(e){this.handleArchive("selected"===e?this.selectedInboxItems:[e]),this.metricItemAction("archive","selected"===e?this.selectedInboxItems.map((function(e){return e.groupId})):e.threadId)},handleItemSpam:function(e){this.reportSpam([e.threadId]),this.deSelectItem(e)},handleItemPhishing:function(e){this.reportPhishing([e.threadId]),this.deSelectItem(e)},handleItemMark:function(e){var t=e.item,i=e.type;this.handleMark(t,i)},handleMarkResponse:function(e){var t=e.item,i=e.type;this.handleMark(t,i)},metricItemAction:function(e,t,i){var n={Read:Jn.READ,UnRead:Jn.UNREAD,Starred:Jn.STARRED,UnStarred:Jn.UN_STARRED,moveToInbox:Jn.MOVE_TO_INBOX,delete:Jn.DELETE,spam:Jn.SPAM,notSpam:Jn.NOT_SPAM,archive:Jn.ARCHIVE},s=n[e]||e;i?this.$metric.report("inbox_item_mark",{labelId:this.currentLabelId,mark:s,msgId:t,error:this.$metric.apiError(i)}):this.$metric.report("inbox_item_mark",{labelId:this.currentLabelId,mark:s,msgId:t})},handleMove:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=t.findNextSelection(e),i.next=4,vi.l.moveThreads(e,t.currentLabelId,Xn.INBOX);case 4:s=i.sent,0===s.returnCode?(t.$undoNotice({iconClass:"checkmark",title:t.$t("operation.movedToInbox")}),t.splitViewControlAction(n),t.clearSelectedInboxThreadIds()):t.$msg(t.$t("operation.moveToInboxFailed"));case 6:case"end":return i.stop()}}),i)})))()},handleArchive:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=t.findNextSelection(e),s=t.currentLabelId,i.next=6,window.zoomSdk.postJsMessage({functionName:"mailui_archivemessages",params:{fromLabelId:s,groupMsgsIds:e.map((function(e){return{groupId:e.groupId||e.threadId,msgIds:e.msgIds}}))}});case 6:a=i.sent,0===a.returnCode?(t.$undoNotice({iconClass:"checkmark",title:t.$t("operation.movedToArchive")}),t.splitViewControlAction(n),t.isSplitView&&t.currentLabelId===Xn.STARRED&&t.$store.commit("setSplitViewSelectedMails",(0,ae.Z)({},t.currentLabelId,null)),t.clearSelectedInboxThreadIds()):t.$msg(t.$t("operation.moveToArchiveFailed"));case 8:case"end":return i.stop()}}),i)})))()},splitViewControlAction:function(e){this.isSplitView&&this.isSplitView&&(e>=0?this.handleShowDetail(this.inboxList[e+1],!0,!1,!1,!1,!0):-1===e&&(this.$store.commit("changeShowDetail",!1),this.$store.commit("changeShowSplitDefault",!0)))},findNextSelection:function(e){var t=this;if(this.isSplitView){if("all"===e||e.length>1){var i,n=[];if(!this.selectedInboxThreadIds.includes(null===(i=this.$store.state.splitViewSelectedMails[this.currentLabelId])||void 0===i?void 0:i.threadId))return-2;this.selectedInboxThreadIds.forEach((function(e){var i=t.inboxList.findIndex((function(t){return t.threadId===e}));-1!==i&&n.push({threadId:e,index:i})})),n.sort((function(e,t){return e.index-t.index}));for(var s=n[0].index,a=1;a<n.length;a++){var r=n[a],o=r.index;if(o!==s+1){s+=1;break}s=o}return s===n[n.length-1].index&&(s+=1),this.inboxList.length===this.selectedInboxThreadIds.length?-1:s>=this.inboxList.length?n[0].index-2:s-1}var l,c,d,u,h;return(null===e||void 0===e?void 0:e.threadId)!==(null===(l=this.$store.state.splitViewSelectedMails[this.currentLabelId])||void 0===l?void 0:l.threadId)&&(null===(c=e[0])||void 0===c?void 0:c.threadId)!==(null===(d=this.$store.state.splitViewSelectedMails[this.currentLabelId])||void 0===d?void 0:d.threadId)&&(null===(u=e[0])||void 0===u?void 0:u.groupId)!==(null===(h=this.$store.state.splitViewSelectedMails[this.currentLabelId])||void 0===h?void 0:h.threadId)?-2:this.inboxList.findIndex((function(t){var i,n;return t.threadId===(null===e||void 0===e?void 0:e.threadId)||t.threadId===(null===(i=e[0])||void 0===i?void 0:i.groupId)||t.threadId===(null===(n=e[0])||void 0===n?void 0:n.threadId)}))}},handleTrash:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,l,c,d,u,h,m,p,f,v,b,g;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=t.findNextSelection(e),s=t.currentLabelId===Xn.TRASH,t.showActions=!1,a=1,o=t.isOutlook?"operation.moveToDeletedSuccess":"operation.undoResultMsg",l=t.isOutlook?"operation.moveToDeletedFailed":"operation.moveToTrashFailed","all"!==e){i.next=20;break}for(a=t.selectedInboxThreadIds.length,c=[],d=[],u=0;u<t.selectedInboxThreadIds.length;u++)h=t.selectedInboxThreadIds[u],m=t.GetThreadHead[h],c.push({groupId:m.threadId,msgIds:m.msgIds}),d.push(m.threadId);return p=s?"mailui_deletemessages":"mailui_trashmessages",i.next=16,window.zoomSdk.postJsMessage({functionName:p,params:{fromLabelId:t.currentLabelId,groupMsgsIds:c}});case 16:f=i.sent,0===f.returnCode?(s||t.$undoNotice({title:t.$tc(o,c.length,[c.length])}),t.splitViewControlAction(n),t.clearSelectedInboxThreadIds(),t.$emit("resetInstantDraftsMsgIdByThreadIds",d),t.metricItemAction(s?Jn.DELETE_FOREVER:Jn.DELETE,d)):(t.$msg(t.$t(l)),t.metricItemAction(s?Jn.DELETE_FOREVER:Jn.DELETE,d,f)),i.next=26;break;case 20:return v=s?"mailui_deletemessages":"mailui_trashmessages",b=[{groupId:e.threadId,msgIds:e.msgIds}],i.next=24,window.zoomSdk.postJsMessage({functionName:v,params:{fromLabelId:e.labelId,groupMsgsIds:b}});case 24:g=i.sent,0===g.returnCode?(!s&&t.$undoNotice({title:t.$tc(o,b.length,[b.length])}),t.splitViewControlAction(n),t.$emit("resetInstantDraftsMsgIdByThreadIds",[e.threadId]),t.metricItemAction(s?Jn.DELETE_FOREVER:Jn.DELETE,e.threadId)):(t.$msg(t.$t(l)),t.metricItemAction(s?Jn.DELETE_FOREVER:Jn.DELETE,e.threadId,g));case 26:return a>t.maxNumberMailsPerRequest&&(a=t.maxNumberMailsPerRequest),i.next=30,t.handleRefresh(a);case 30:case"end":return i.stop()}}),i)})))()},handleMark:function(e,t){var i=this;return(0,o.Z)((0,r.Z)().mark((function n(){var s,a,o,l,c,u,h,m,p,f,v,b,g,S;return(0,r.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i.showActions=!1,s=[],"all"===e){for(o=0;o<i.selectedInboxThreadIds.length;o++)l=i.selectedInboxThreadIds[o],c=i.GetThreadHead[l],u=c.labelId,h=c.threadId,m=c.msgIds,s.push({labelId:u,threadId:h,msgIds:m});a=i.currentLabelId}else s.push(e),a=e.labelId;return p=s.map((function(e){return e.threadId})),f=s.map((function(e){var t=e.threadId,i=e.msgIds;return{msgIds:i,groupId:t}})),n.next=7,d.Mail.markMessages({mailMarkType:t,fromLabelId:a,groupMsgsIds:f});case 7:if(v=n.sent,0===v.errorCode){b=(0,ne.Z)(s);try{for(b.s();!(g=b.n()).done;)S=g.value,["Read","UnRead"].includes(t)?i.$store.commit("changeGetThreadHead",{labelId:S.labelId,threadId:S.threadId,type:"isUnread",status:"UnRead"===t}):["Starred","UnStarred"].includes(t)&&i.$store.commit("changeGetThreadHead",{labelId:S.labelId,threadId:S.threadId,type:"isStarred",status:"Starred"===t})}catch(r){b.e(r)}finally{b.f()}"all"===e&&i.clearSelectedInboxThreadIds(),["Read","UnRead","Starred","UnStarred"].includes(t)&&i.metricItemAction(t,p)}else i.$msg(i.$t("operation.markFailed")),["Read","UnRead","Starred","UnStarred"].includes(t)&&i.metricItemAction(t,p,v);case 9:case"end":return n.stop()}}),n)})))()},handleCheckAllChange:function(e){e?this.resetSelectedInboxThreadIds({threadIds:this.inboxList.filter((function(e){return!e.threadHead.showLabelIds.some((function(e){return[c.Enums.SystemDefinedMailLabelIds.ESCROW,c.Enums.SystemDefinedMailLabelIds.GROUP_APPROVAL].includes(e)}))})).map((function(e){return e.threadId}))}):this.clearSelectedInboxThreadIds(),this.clearLastSelectedInboxThreadId()},setupMultiSelectHandlers:function(){var e=this;window.addEventListener("keydown",this.trackShiftPressed=function(t){"Shift"===t.key&&(e.shiftModifier=!0)}),window.addEventListener("keyup",this.trackShiftReleased=function(t){"Shift"===t.key&&(e.shiftModifier=!1)}),window.addEventListener("blur",this.trackWindowBlurred=function(){e.shiftModifier=!1})},cleanupMultiSelectHandlers:function(){window.removeEventListener("keydown",this.trackShiftPressed),window.removeEventListener("keyup",this.trackShiftReleased),window.removeEventListener("blur",this.trackWindowBlurred)},handleCheckedItemsChange:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,l,c,d,u;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.threadId,s=e.status,t.lastSelectedInboxThreadId&&t.shiftModifier&&(o=t.inboxList.findIndex((function(e){return e.threadId===t.lastSelectedInboxThreadId})),o>=0&&(l=t.inboxList.findIndex((function(e){return e.threadId===n})),l>=0&&(a=[Math.min(o,l),Math.max(o,l)+1]))),c=[n],a&&(c=(d=t.inboxList).slice.apply(d,(0,se.Z)(a)).filter((function(e){return e.threadId&&!e.isPlain})).map((function(e){return e.threadId}))),u=new Set(t.selectedInboxThreadIds),i.next=9,t.setLastSelectedInboxThreadId({threadId:n});case 9:s?u.has(n)?t.removeSelectedInboxThreadIds({threadIds:c}):t.addSelectedInboxThreadIds({threadIds:c}):t.removeSelectedInboxThreadIds({threadIds:c});case 10:case"end":return i.stop()}}),i)})))()},handleSync:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.handleSyncAllLabelMails();case 2:case"end":return t.stop()}}),t)})))()},handleSyncAllLabelMails:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.refreshRun=!0,!window.zoomSdk){t.next=7;break}return t.next=4,window.zoomSdk.postJsMessage({functionName:"mailui_syncmails",params:{}});case 4:setTimeout((function(){e.refreshRun=!1}),3e3),t.next=8;break;case 7:setTimeout((function(){e.refreshRun=!1}),3e3);case 8:case"end":return t.stop()}}),t)})))()},goToSettings:function(){var e;this.setScrollPositionY(null===(e=this.$refs.recycleScroller)||void 0===e?void 0:e.getScroll().start),this.$router.push({path:"/group",params:{path:this.$route.path}})},instantFetchThreadHeads:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];i.forEach((function(i){y.t.queryThreadHead(e,i,!1).then((function(e){var i=e.result;if(t.isZmail){var n=!c.Utils.isDecrypted(i.GetThreadHead.threadHead.decryptionStatus);n&&(i.GetThreadHead.threadHead.subject=t.$t("operation.emailLocked"),i.GetThreadHead.threadHead.snippet=t.$t(c.Utils.getDecryptErrorInfo(i.GetThreadHead.threadHead.originalCode).wording))}t.$store.commit("addGetThreadHead",i)}))}))},fetchSplitConfig:function(){var e=this;d.Setting.getPersistentSetting({key:"CustomPaneMode"}).then((function(t){if(0===t.errorCode){"string"===typeof t.data.value&&(e.customPaneMode=JSON.parse(t.data.value));var i=document.getElementById("mail-list");1===e.customPaneMode.splitMode?(i.style.width=e.customPaneMode.mailListWidth,e.$store.commit("setSplitView",!0),e.$store.commit("changeShowSplitDefault",!0)):(i.style.width="100%",e.$store.commit("setSplitView",!1))}}))["catch"]((function(e){}))},setSplitConfig:function(e){var t=arguments,i=this;return(0,o.Z)((0,r.Z)().mark((function n(){var s;return(0,r.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s=t.length>1&&void 0!==t[1]&&t[1],n.next=3,d.Setting.setPersistentSetting({key:"CustomPaneMode",value:JSON.stringify(e)}).then((function(e){0===e.errorCode&&s&&i.$store.commit("setSplitView",!i.isSplitView)}))["catch"]((function(e){}));case 3:case"end":return n.stop()}}),n)})))()},handleSplitToggle:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a,o,l;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={splitMode:e.isSplitView?0:1,mailListWidth:e.customPaneMode.mailListWidth},t.next=3,e.setSplitConfig(i,!0);case 3:n=document.getElementById("mail-list"),e.isSplitView?(n.style.width=e.customPaneMode.mailListWidth,e.$store.commit("clearSplitViewSelectedMail"),e.$store.commit("changeShowSplitDefault",!0),null===(o=e.$refs.recycleScroller)||void 0===o||o.scrollToPosition(2*(null===(l=e.$refs.recycleScroller)||void 0===l?void 0:l.getScroll().start))):(null===(s=e.$refs.recycleScroller)||void 0===s||s.scrollToPosition((null===(a=e.$refs.recycleScroller)||void 0===a?void 0:a.getScroll().start)/2),n.style.width="100%",e.$store.commit("changeShowDetail",!1),e.$store.commit("changeShowSplitDefault",!1));case 5:case"end":return t.stop()}}),t)})))()},flattenMails:function(e){var t=this,i=["Upcoming","Today","All"],n=Object.keys(e).sort((function(e,t){var n=i.indexOf(e),s=i.indexOf(t),a=n>-1&&s>-1;return a?n-s:-1===n&&-1===s?t-e:n>-1?-1:s>-1?1:0})),s=n.reduce((function(i,n){var s=e[n],a=40*t.scaleRadio,r=80*t.scaleRadio;if(s.length){i.push({threadId:n,isPlain:!0,value:n,height:a});var o="Upcoming"===n?function(e,t){return e.threadHead.date-t.threadHead.date}:function(e,t){return t.threadHead.date-e.threadHead.date};i.push.apply(i,(0,se.Z)(s.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{height:t.isSplitView?r:a})})).sort(o)))}return i}),[]);return s},checkIsLabelInit:function(){return Object.keys(this.GetThreadHead).length>=this.maxNumberMailsPerRequest},handleRefresh:function(){var e=arguments,t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,l,d,u,h,m,p,f,v,b,g,S;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.length>0&&void 0!==e[0]?e[0]:t.maxNumberMailsPerRequest,s=e.length>1&&void 0!==e[1]&&e[1],t.loadTimer&&clearTimeout(t.loadTimer),!t.inboxSectionVisible){i.next=5;break}return i.abrupt("return");case 5:if(a=t.currentLabelId,!t.isLastPage.get(a)){i.next=13;break}return t.isLocalLastPage=!0,t.setLoadingState(a,!1),i.abrupt("return");case 13:t.isLocalLastPage=!1;case 14:if(!t.isLoading){i.next=18;break}return t.loadTimer=setTimeout((function(){return t.handleRefresh(n,s)}),1e3),i.abrupt("return");case 18:if(t.setLoadingState(a,!0),!t.inSearching){i.next=24;break}return s&&t.$store.commit("changeSearchStatus",!0),null===(o=t.$refs)||void 0===o||null===(l=o.searchRef)||void 0===l||l.search(),i.abrupt("return");case 24:if(!t.inFilters){i.next=28;break}return s&&t.$store.commit("changeFilterStatus",!0),t.$nextTick((function(){var e;t.$store.commit("changeFilterRefresh",!0),null===(e=t.$refs.controlHeader.$refs.inboxFilters)||void 0===e||e.filterSearch()})),i.abrupt("return");case 28:return d=[],u=[],i.prev=30,i.next=33,window.zoomSdk.postJsMessage({functionName:"mailui_listthreads",params:{label:a,count:n}});case 33:if(h=i.sent,m=h.result,p=h.returnCode,0===p){i.next=40;break}return t.errorStatus=!0,i.abrupt("return");case 40:return i.next=42,t.$store.dispatch("addListThreads",m);case 42:if(f=m.ListThreads,v=f.threadIds,b=f.labelId,g=f.isLastPage,g||t.inSearching||t.inFilters||t.currentThreadList.length<t.maxNumberMailsPerRequest&&setTimeout((function(){t.handleRefresh()}),t.errorStatus||t.isOffline?1e4:1e3),!(v.length>0)){i.next=55;break}if(t.checkIsLabelInit()){i.next=49;break}t.instantFetchThreadHeads(b,v),i.next=55;break;case 49:return i.next=51,y.t.getAllThreadHead(b,v,t.isOutlook);case 51:S=i.sent,t.isZmail?S.forEach((function(e){return c.Utils.isDecrypted(e.GetThreadHead.threadHead.decryptionStatus)?d.push(e):u.push(e)})):d=S,u.forEach((function(e){e.GetThreadHead.threadHead.subject=t.$t("operation.emailLocked"),e.GetThreadHead.threadHead.snippet=t.$t(c.Utils.getDecryptErrorInfo(e.GetThreadHead.threadHead.originalCode).wording)})),[].concat((0,se.Z)(d),u).forEach((function(e){t.$store.commit("addGetThreadHead",e)}));case 55:t.$store.commit("changeIsLastPage",{type:b,result:g}),t.errorStatus=!1,i.next=64;break;case 59:i.prev=59,i.t0=i["catch"](30),t.errorStatus=!0,t.$store.commit("changeIsLastPage",{type:a,result:!1});case 64:return i.prev=64,t.setLoadingState(a,!1),i.finish(64);case 67:case"end":return i.stop()}}),i,null,[[30,59,64,67]])})))()},handleShowActions:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.e,s=e.item,t.currentLabelId!==Xn.OUTBOX){i.next=4;break}return i.abrupt("return");case 4:return t.selectItem=s,t.showActions=!0,t.calculateContextMenuPosition(n),t.allContextMenuSendersAreSelf=!0,i.next=10,t.getAllContextMenuSendersAreSelf();case 10:t.allContextMenuSendersAreSelf=i.sent;case 11:case"end":return i.stop()}}),i)})))()},setSelectItem:function(e){this.selectItem=e},calculateContextMenuPosition:function(e){var t=this;this.$nextTick((function(){var i=t.scaleRadio||1,n=window.innerWidth,s=window.innerHeight,a=document.getElementById("mail-right"),r=((null===a||void 0===a?void 0:a.scrollLeft)||0)/i,o=((null===a||void 0===a?void 0:a.scrollTop)||0)/i,l=(e.clientX-t.sidebarMenuWidth)/i,c=e.clientY/i,d=document.getElementById("mail-list-actions-menu").getBoundingClientRect(),u=d.height/i,h=d.width/i;t.actionX=(e.clientX>n-h-20?l-h:l)+r,t.actionY=(e.clientY>s-u-20?c-u:c)+o}))},handleHideActions:function(){this.showActions=!1},handleTrashToggle:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=t.selectItem,s=t.findNextSelection(n),!e){i.next=12;break}return a=Xn.INBOX,i.next=7,vi.l.moveThreads([n],n.labelId,a);case 7:o=i.sent,0===o.returnCode?(t.$store.commit("changeGetThreadHeadLabel",{threadId:n.threadId,oldLabelId:n.labelId,newLabelId:a}),t.$undoNotice({iconClass:"checkmark",title:t.$t("operation.movedToInbox")}),t.splitViewControlAction(s),t.metricItemAction("moveToInbox",n.threadId)):(t.$msg(t.$t("operation.moveToInboxFailed")),t.metricItemAction("moveToInbox",n.threadId,o)),i.next=14;break;case 12:t.handleTrash(n);case 14:t.showActions=!1;case 15:case"end":return i.stop()}}),i)})))()},handleReadToggle:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.selectItem,n=i.threadHead.isUnread?"Read":"UnRead",t.next=4,window.zoomSdk.postJsMessage({functionName:"mailui_markmessages",params:{mailMarkType:n,fromLabelId:i.labelId,groupMsgsIds:[{groupId:i.threadId,msgIds:i.msgIds}]}});case 4:s=t.sent,0===s.returnCode?(e.$store.commit("changeGetThreadHead",{labelId:i.labelId,threadId:i.threadId,type:"isUnread",status:"UnRead"===n}),e.metricItemAction(n,i.threadId)):e.metricItemAction(n,i.threadId,s),e.showActions=!1;case 7:case"end":return t.stop()}}),t)})))()},handleDiscardDrafts:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=t.selectItem,i.next=4,window.zoomSdk.postJsMessage({functionName:"mailui_discarddrafts",params:{fromLabelId:e?c.Enums.SystemDefinedMailLabelIds.DRAFT:n.labelId,groupMsgsIds:e?t.selectedInboxItems:[{groupId:n.threadId}]}});case 4:s=i.sent,0===s.returnCode?(t.$undoNotice({title:t.$t("operation.draftsDiscarded")}),e?(t.selectedInboxItems.forEach((function(e){t.$store.commit("removeInstantDraftsForThreads",e.msgIds),t.$emit("resetInstantDraftsMsgIdByThreadIds",e.msgIds)})),t.metricItemAction("delete",t.selectedInboxItems.map((function(e){return e.groupId})))):(t.$store.commit("removeInstantDraftsForThreads",[n.threadId]),t.$emit("resetInstantDraftsMsgIdByThreadIds",[n.threadId]),t.metricItemAction("delete",n.threadId)),t.clearSelectedInboxThreadIds()):(t.$msg(t.$t("operation.failedToDiscardDrafts")),e?t.metricItemAction("delete",t.selectedInboxItems.map((function(e){return e.groupId})),s):t.metricItemAction("delete",n.threadId,s)),t.showActions=!1;case 8:case"end":return i.stop()}}),i)})))()},markAsSpam:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,o,l,c;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.labelId,s=e.threadId,a=e.msgIds,o=e.type,l=o===Et.NW.NOT_JUNK?"INBOX":"SPAM",i.prev=2,i.next=5,window.zoomSdk.postJsMessage({functionName:"mailui_movemessages",params:{fromLabelId:n,toLabelId:l,groupMsgsIds:[{groupId:s,msgIds:a}]}});case 5:if(c=i.sent,0!==c.returnCode){i.next=11;break}t.$store.commit("changeGetThreadHeadLabel",{threadId:s,oldLabelId:n,newLabelId:l}),t.metricItemAction(o===Et.NW.NOT_JUNK?"notSpam":"spam",s),i.next=13;break;case 11:throw t.metricItemAction(o===Et.NW.NOT_JUNK?"notSpam":"spam",s,c),Error("Move failed");case 13:i.next=18;break;case 15:throw i.prev=15,i.t0=i["catch"](2),Error();case 18:case"end":return i.stop()}}),i,null,[[2,15]])})))()},handleReportPhishing:function(){this.showReportPhishingDialog=!0},handleSpamToggle:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.handleSpamForSelectionNRightClick(!0);case 1:case"end":return t.stop()}}),t)})))()},handleArchiveToggle:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a,o;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.selectItem,n=1,s=e.findNextSelection([i]),e.selectedInboxThreadIds.indexOf(i.threadId)>=0&&e.resetSelectedInboxThreadIds({threadIds:e.selectedInboxThreadIds.filter((function(e){return e!==i.threadId}))}),!x.Z.isArchive(i.labelId)){t.next=13;break}return t.next=8,vi.l.moveThreads([i],i.labelId,Xn.INBOX);case 8:a=t.sent,0===a.returnCode?(e.$store.commit("changeGetThreadHeadLabel",{threadId:i.threadId,oldLabelId:i.labelId,newLabelId:Xn.INBOX}),e.metricItemAction("moveToInbox",i.threadId)):(e.$msg(e.$t("operation.moveToInboxFailed")),e.metricItemAction("moveToInbox",i.threadId,a)),t.next=18;break;case 13:return t.next=15,window.zoomSdk.postJsMessage({functionName:"mailui_archivemessages",params:{fromLabelId:e.selectItem.labelId,groupMsgsIds:[{groupId:e.selectItem.threadId,msgIds:e.selectItem.msgIds}]}});case 15:o=t.sent,0===o.returnCode?(e.$store.commit("changeGetThreadHeadLabel",{threadId:i.threadId,oldLabelId:i.labelId,newLabelId:c.Enums.SystemDefinedMailLabelIds.ARCHIVE}),e.splitViewControlAction(s),e.metricItemAction("archive",i.threadId)):(e.$msg(e.$t("operation.moveToArchiveFailed")),e.metricItemAction("archive",i.threadId,o));case 18:return e.showActions=!1,t.next=22,e.handleRefresh(n);case 22:case"end":return t.stop()}}),t)})))()},handleDeleteTrash:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.selectItem,t.next=3,window.zoomSdk.postJsMessage({functionName:"mailui_deletemessages",params:{fromLabelId:i.labelId,groupMsgsIds:[{groupId:i.threadId,msgIds:i.msgIds}]}});case 3:n=t.sent,0===n.returnCode?(e.$store.dispatch("moveGetThreadHead",{threadId:i.threadId,id:i.labelId}),e.$undoNotice({title:e.$t("operation.mailDeleted")}),e.$emit("resetInstantDraftsMsgIdByThreadIds",[i.threadId])):e.$msg(e.$t("operation.deleteFailed")),e.showActions=!1;case 6:case"end":return t.stop()}}),t)})))()},handleDeleteResponse:function(e){this.clearCurrentInboxItemThreadId(),this.setCurrentInboxItem(null),this.handleTrash(e),this.deSelectItem(e)},handleSpamResponse:function(e){this.clearCurrentInboxItemThreadId(),this.setCurrentInboxItem(null),e.labelId===Xn.SPAM?this.handleMove([e]):this.moveThreadsToSpam([e])},handleCancelScheduledSend:function(e){var t=arguments,i=this;return(0,o.Z)((0,r.Z)().mark((function n(){var s,a;return(0,r.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s=t.length>1&&void 0!==t[1]&&t[1],i.clearCurrentInboxItemThreadId(),i.setCurrentInboxItem(null),a=e.reduce((function(e,t){return e.concat(i.$store.getters.getReportSpamInfoByThreadId(t))}),[]),n.prev=4,n.next=7,Promise.all(a.map(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,a,o,c,u,h,m;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.threadId,a=t.msgIds,o=t.labelId,e.next=3,d.Thread.getThreadMailDetails({threadId:n,labelId:o});case 3:return c=e.sent,c.sort((function(e,t){return e.mailHead.date-t.mailHead.date})),u=c[c.length-1],e.next=8,vi.l.cancelSendingMail(a[a.length-1]);case 8:if(h=e.sent,0!==h.returnCode||!s){e.next=18;break}return m={key:(0,bi.Z)(),composeItem:(0,l.Z)({},u),isDraft:!0},i.$store.commit("addInstantDraftList",m),i.$compose({composeItem:m.composeItem}),i.$undoNotice({iconClass:"checkmark",title:i.$t("operation.cancelledScheduledSendAndRevertedToDraft")}),i.clearSelectedInboxThreadIds(),e.abrupt("return");case 18:if(0!==h.returnCode||s){e.next=21;break}return i.$undoNotice({iconClass:"checkmark",title:i.$t("operation.cancelledScheduledSendAndRevertedToDraft")}),e.abrupt("return");case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](4),i.$undoNotice({iconClass:"crossmark",title:i.$t("common.failedToCancel")});case 12:case"end":return n.stop()}}),n,null,[[4,9]])})))()},resetLastInboxRefreshDate:function(){var e=(0,de.YZ)();return(!this.LastInboxRefreshDate||this.LastInboxRefreshDate.getTime()!==e.getTime())&&(this.$store.commit("setLastInboxRefreshDate",e),!0)},refreshIfDateChanged:function(){this.resetLastInboxRefreshDate()&&this.handleRefresh()},setIsLastPage:function(e){this.isLocalLastPage=e},changeSearchErrorStatus:function(e){this.searchErrorStatus=e},redirect2Thread:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.threadId,s=e.thread,n&&s){i.next=3;break}return i.abrupt("return");case 3:t.addGetThreadHead({GetThreadHead:s}),t.handleShowDetail(s,!0,!0);case 5:case"end":return i.stop()}}),i)})))()},reportPhishing:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.reduce((function(e,i){return e.concat(t.$store.getters.getReportSpamInfoByThreadId(i))}),[]),i.prev=1,i.next=4,Promise.all(n.map(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var i,n,s,a,o,l,c;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.threadId,n=t.msgIds,s=t.labelId,e.next=3,d.Thread.getThreadMailDetails({threadId:i,labelId:s});case 3:if(a=e.sent,a.sort((function(e,t){return e.mailHead.date-t.mailHead.date})),o=a[0],!o){e.next=9;break}return c=he.t.reportSpam({threadId:i,msgIds:n,sender:null===o||void 0===o||null===(l=o.from)||void 0===l?void 0:l.emailAddr,type:"phishing"}),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:t.$undoNotice({iconClass:"checkmark",title:t.$t("operation.moveToSpamSuccess",[n.length>1?"s":""])}),t.clearSelectedInboxThreadIds(),i.next=12;break;case 8:i.prev=8,i.t0=i["catch"](1),t.$undoNotice({iconClass:"crossmark",title:t.$t("common.failedToReportPhishing")});case 12:case"end":return i.stop()}}),i,null,[[1,8]])})))()},handleSpamForSelectionNRightClick:function(){var e=arguments,t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=!(e.length>0&&void 0!==e[0])||e[0],!t.isGmail){i.next=5;break}t.reportSpam(n?[t.selectItem.threadId]:t.selectedInboxThreadIds),i.next=9;break;case 5:if(!t.isZmail){i.next=9;break}if(!t.allSelectedInvalidToSpam||n){i.next=8;break}return i.abrupt("return");case 8:t.currentLabelId===Xn.SPAM?(t.reportSpam(n?[t.selectItem.threadId]:t.selectedInboxThreadIds),t.clearSelectedInboxThreadIds()):(t.moveThreadsToSpam(n?[{groupId:t.selectItem.threadId,msgIds:t.selectItem.msgIds}]:t.selectedInboxItems),t.showActions=!1);case 9:case"end":return i.stop()}}),i)})))()},reportSpam:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n,s,a,c,u,h,m;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.reduce((function(e,i){return e.concat(t.$store.getters.getReportSpamInfoByThreadId(i))}),[]),s=t.isSpammed?function(e){return"SPAM"===e}:function(e){return"SPAM"!==e},n=n.filter((function(e){var t=e.labelId;return s(t)})),a=t.isSpammed?Et.NW.NOT_JUNK:Et.NW.JUNK,c=[],u=t.findNextSelection(n),i.prev=6,!t.isGmail){i.next=13;break}return t.splitViewControlAction(u),i.next=11,Promise.all(n.map((function(e){var i=(0,l.Z)((0,l.Z)({},e),{},{type:a});return c.push((0,l.Z)((0,l.Z)({},i),{},{type:Et.NW.JUNK})),t.markAsSpam(i)})));case 11:i.next=17;break;case 13:return t.splitViewControlAction(u),i.next=16,Promise.all(n.map(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var i,n,s,o,l,u,h;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.threadId,n=t.msgIds,s=t.labelId,e.next=3,d.Thread.getThreadMailDetails({threadId:i,labelId:s});case 3:if(o=e.sent,o.sort((function(e,t){return e.mailHead.date-t.mailHead.date})),l=o[o.length-1],!l){e.next=9;break}return c.push({threadId:i,msgIds:n,sender:null===l||void 0===l||null===(u=l.from)||void 0===u?void 0:u.emailAddr,type:Et.NW.JUNK}),e.abrupt("return",he.t.reportSpam({threadId:i,msgIds:n,sender:null===l||void 0===l||null===(h=l.from)||void 0===h?void 0:h.emailAddr,type:a}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 16:case 17:t.clearSelectedInboxThreadIds(),i.next=23;break;case 20:i.prev=20,i.t0=i["catch"](6),t.$undoNotice({iconClass:"crossmark",title:t.$t("common.failedToReportSpam")});case 23:return i.prev=23,h=c.length===n.length,a===Et.NW.NOT_JUNK&&h&&(m=function(){c.forEach((function(e){t.isGmail?t.markAsSpam(e):he.t.reportSpam(e)}))},t.$undoNotice({iconClass:"checkmark",title:t.$t("operation.movedToInboxTitle",[c.length,c.length>1?"s":""]),action:t.$t("operation.undo"),actionCallback:m})),t.showActions=!1,i.finish(23);case 28:case"end":return i.stop()}}),i,null,[[6,20,23,28]])})))()},showApproveDialog:function(){this.showApproveUserDialog=!0,this.hasBold={key:"operation.approveDialogInfo",email:"".concat(this.selectedUserEmail.displayName," <").concat(this.selectedUserEmail.emailAddr,">")}},cancelApprove:function(){this.showApproveUserDialog=!1},approveUser:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a,l;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.selectedUserEmail.emailAddr,e.showApproveUserDialog=!1,!i){t.next=19;break}return t.prev=3,t.next=6,he.t.listSpammedUsers();case 6:return s=t.sent,a=(null===(n=s.find((function(e){var t=e.email;return t===i})))||void 0===n?void 0:n.status)||Et.NW.NOT_ALLOWLIST,t.next=10,he.t.reportSpam({sender:i,type:Et.NW.ALLOWLIST});case 10:l=function(){var t=(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.t.reportSpam({sender:i,type:a});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),e.$msg({type:"Error",content:e.$t("detail.undoFailed")});case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),e.$undoNotice({iconClass:"checkmark",title:e.$t("operation.emailAddressApproved"),action:e.$t("operation.undo"),actionCallback:l}),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](3),e.$msg({type:"Error",content:e.$t("operation.approveFailedContent",[e.selectedUserEmail.displayName])});case 18:e.clearSelectedInboxThreadIds();case 19:case"end":return t.stop()}}),t,null,[[3,14]])})))()},handleVisibilityChange:function(){document.hidden||this.refreshIfDateChanged();var e=Tt.ou.now();if(document.hidden)this.storedTime=e;else{var t=Tt.ou.now().diff(this.storedTime,"hours");t.toObject().hours>6&&this.clearLastReadInboxThreadId()}},closeGetStartedModal:function(){this.showGetStartedModal=!1,this.$store.commit("auth/setIsFirstLogin",!1)},getThreadHeadByTId:function(e,t){var i=this.$store.state.GetThreadHead[e];return i&&i[t]},handDevInfo:function(e){this.showDevJIRA=e},retry:function(){this.errorStatus&&(this.errorStatus=!1),this.searchErrorStatus&&(this.errorStatus=!1),this.handleRefresh(void 0,!0)}})},Qn=qn,es=(0,D.Z)(Qn,te,ie,!1,null,"7ea167f6",null),ts=es.exports,is=function(){var e=this,t=e._self._c;return t("div",{ref:"composeContainer",staticClass:"compose-container"},[t("div",{ref:"composeListWrap",class:["compose-list-wrap",{"single-draft":e.isComposeShouldOnEdge||e.hideShortcuts}]},[t("transition-group",{attrs:{name:"compose-list"}},e._l(e.composeList,(function(i){return t("Compose",{key:i.key,ref:"composeRef_".concat(i.key),refInFor:!0,attrs:{id:i.key,isCurrent:e.currentCompose&&e.currentCompose.key===i.key,composeItem:i.composeItem,isDraft:i.isDraft,isForward:i.isForward,isReply:i.isReply,fromPopOut:i.fromPopOut,preTo:i.preTo},on:{triggerClose:e.handleComposeClose,minimize:e.handleComposeMinimize,updateSubject:e.handleComposeUpdate,creatingOrUpdating:e.creatingOrUpdating}})})),1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showComposeShortCut,expression:"showComposeShortCut"}],ref:"shortcutListRef",staticClass:"compose-shortcut-list-wrap"},[t("transition-group",{attrs:{name:"compose-shortcut-list"}},e._l(e.composeShortcutList,(function(i){return t("ComposeShortcut",{key:i.key,ref:"composeShortcut_".concat(i.key),refInFor:!0,attrs:{id:i.key,isCurrent:e.currentCompose&&e.currentCompose.key===i.key,composeItem:i.composeItem,isDraft:i.isDraft,isForward:i.isForward,isReply:i.isReply,preTo:i.preTo,creatingOrUpdatingLists:e.creatingOrUpdatingLists,isAllowCompose:e.allowComposeFromShortcut},on:{close:e.handleShortcutClose,onShowCompose:function(t){return e.onShowCompose(i.key)}}})})),1)],1)])},ns=[],ss=function(){var e=this,t=e._self._c;return t("div",{ref:"root",class:["force-light","compose-wrap",{hide:!e.isCurrent,"fullscreen-size":e.fullScreen,"is-locked":e.isLocked}],style:{minHeight:e.fullScreen?"auto":"".concat(e.composeHeight,"px"),maxHeight:e.fullScreen?"".concat(e.maxHeight,"px"):"".concat(e.maxHeight-50,"px"),width:e.fullScreen?"auto":"".concat(e.composeWidth,"px")},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.handleFocusTrap.apply(null,arguments)}}},[t("div",{staticClass:"compose-title-bar"},[t("div",{staticClass:"compose-resize-bar-horizontal",on:{mousedown:function(t){return t.preventDefault(),t.stopPropagation(),e.handleResizeMouseDown(t,"horizontal")}}}),t("div",{staticClass:"compose-title-text"},[e._v(" "+e._s(e.composeTitle)+" ")]),t("div",{staticClass:"caption-button-wrap"},[t("zm-tooltip",{attrs:{content:e.$t("common.minimize"),placement:"bottom",enterable:!1}},[t("zm-button",{ref:"minimizeButton",staticClass:"caption-button",attrs:{"tab-index":"1","aria-label":e.$t("common.minimize"),"aria-expanded":void 0,"zm-ta":"new-compose-minimize"},on:{click:e.handleMini}},[t("SvgIcon",{attrs:{iconClass:"minus"}})],1)],1),t("zm-tooltip",{attrs:{content:e.$t("common.fullScreen"),placement:"bottom",enterable:!1}},[t("zm-button",{staticClass:"caption-button",attrs:{"tab-index":"1","aria-label":e.$t("common.fullScreen"),"aria-expanded":void 0,"zm-ta":"new-compose-maximize"},on:{click:e.handleFullScreen}},[t("SvgIcon",{attrs:{iconClass:e.fullScreen?"minimize":"maximize"}})],1)],1),t("zm-tooltip",{attrs:{content:e.$t("common.saveAndClose"),placement:"bottom",enterable:!1}},[t("zm-button",{staticClass:"caption-button",attrs:{"tab-index":"1","aria-label":e.$t("common.saveAndClose"),"aria-expanded":void 0,"zm-ta":"new-compose-close"},on:{click:e.triggerClose}},[t("SvgIcon",{attrs:{iconClass:"close"}})],1)],1)],1)]),t("div",{staticClass:"compose-header"},[t("div",{staticClass:"recipients-line"},[t("span",{staticClass:"recipients-line-label"},[e._v(e._s(e.$t("filter.to")))]),t("contactsSelector",{ref:"toContactRef",attrs:{label:e.$t("filter.to"),value:e.to,type:"to",toSelectList:e.toSelectList,ccSelectList:e.ccSelectList,bccSelectList:e.bccSelectList,toExternalList:e.toExternalList,ccExternalList:e.ccExternalList,bccExternalList:e.bccExternalList,toGroupList:e.toGroupList,ccGroupList:e.ccGroupList,bccGroupList:e.bccGroupList,disableAllActions:e.isLocked},on:{change:function(t){e.to=t},focus:function(t){return t.stopPropagation(),e.handleFocus(t,"recipients")},resetShowActions:e.resetShowActions,appendRecipient:e.appendRecipient,handleHasExternal:e.handleHasExternal,handleAddExternalUser:e.handleAddExternalUser,handleRemoveExternalUser:e.handleRemoveExternalUser,handleHasGroup:e.handleHasGroup,handleAddGroupEmail:e.handleAddGroupEmail,handleRemoveGroupEmail:e.handleRemoveGroupEmail,selectMultiRecipients:e.selectMultiRecipients,shiftSelect:e.shiftSelect,resetRecipients:e.resetRecipients,resetCurrentRecipientSelect:e.resetCurrentRecipientSelect}}),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.showCc,expression:"!showCc"}],class:["showToAction","tab-focus",{disabled:e.isLocked}],attrs:{tabindex:"0",role:"button","aria-label":e.$t("accessibility.addCc")},on:{click:function(t){return t.stopPropagation(),e.handleCc.apply(null,arguments)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCc.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.handleCc.apply(null,arguments)}]}},[e._v(" "+e._s(e.$t("editor.cc"))+" ")]),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.showBcc,expression:"!showBcc"}],class:["showToAction","tab-focus",{disabled:e.isLocked}],attrs:{tabindex:"0",role:"button","aria-label":e.$t("accessibility.addBcc")},on:{click:function(t){return t.stopPropagation(),e.handleBcc.apply(null,arguments)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleBcc.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.handleBcc.apply(null,arguments)}]}},[e._v(" "+e._s(e.$t("editor.bcc"))+" ")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showCc,expression:"showCc"}],staticClass:"recipients-line"},[t("span",{staticClass:"recipients-line-label"},[e._v(e._s(e.$t("editor.cc")))]),t("contactsSelector",{ref:"ccContactRef",attrs:{label:e.$t("editor.cc"),value:e.cc,type:"cc",toSelectList:e.toSelectList,ccSelectList:e.ccSelectList,bccSelectList:e.bccSelectList,toExternalList:e.toExternalList,ccExternalList:e.ccExternalList,bccExternalList:e.bccExternalList,toGroupList:e.toGroupList,ccGroupList:e.ccGroupList,bccGroupList:e.bccGroupList,disableAllActions:e.isLocked},on:{change:function(t){e.cc=t},focus:function(t){return t.stopPropagation(),e.handleFocus(t,"recipients")},resetShowActions:e.resetShowActions,appendRecipient:e.appendRecipient,handleHasExternal:e.handleHasExternal,handleAddExternalUser:e.handleAddExternalUser,handleRemoveExternalUser:e.handleRemoveExternalUser,handleHasGroup:e.handleHasGroup,handleAddGroupEmail:e.handleAddGroupEmail,handleRemoveGroupEmail:e.handleRemoveGroupEmail,selectMultiRecipients:e.selectMultiRecipients,shiftSelect:e.shiftSelect,resetRecipients:e.resetRecipients,resetCurrentRecipientSelect:e.resetCurrentRecipientSelect}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showBcc,expression:"showBcc"}],staticClass:"recipients-line"},[t("span",{staticClass:"recipients-line-label"},[e._v(e._s(e.$t("editor.bcc")))]),t("contactsSelector",{ref:"bccContactRef",attrs:{label:e.$t("editor.bcc"),value:e.bcc,type:"bcc",toSelectList:e.toSelectList,ccSelectList:e.ccSelectList,bccSelectList:e.bccSelectList,toExternalList:e.toExternalList,ccExternalList:e.ccExternalList,bccExternalList:e.bccExternalList,toGroupList:e.toGroupList,ccGroupList:e.ccGroupList,bccGroupList:e.bccGroupList,disableAllActions:e.isLocked},on:{change:function(t){e.bcc=t},focus:function(t){return t.stopPropagation(),e.handleFocus(t,"recipients")},resetShowActions:e.resetShowActions,appendRecipient:e.appendRecipient,handleHasExternal:e.handleHasExternal,handleAddExternalUser:e.handleAddExternalUser,handleRemoveExternalUser:e.handleRemoveExternalUser,handleHasGroup:e.handleHasGroup,handleAddGroupEmail:e.handleAddGroupEmail,handleRemoveGroupEmail:e.handleRemoveGroupEmail,selectMultiRecipients:e.selectMultiRecipients,shiftSelect:e.shiftSelect,resetRecipients:e.resetRecipients,resetCurrentRecipientSelect:e.resetCurrentRecipientSelect}})],1),t("div",{staticClass:"subject"},[t("zm-input",{ref:"input",attrs:{disabled:e.isLocked,placeholder:e.$t("filter.subject"),"zm-ta":"new-compose-subject"},on:{focus:function(t){return e.handleFocus(t,"subject")},blur:function(t){return e.handleBlur(t,"subject")}},model:{value:e.subject,callback:function(t){e.subject=t},expression:"subject"}})],1),e.showSmartSubject&&e.smartSubject?t("div",{staticClass:"smart-subject"},[e._v(" "+e._s(e.$t("GPT.suggestion"))+" "),t("span",[e._v(e._s(e.smartSubject))]),t("div",{staticClass:"actions"},[t("zm-button",{attrs:{type:"plain"},on:{click:e.selectSmartCompose}},[e._v(e._s(e.$t("GPT.replace")))]),t("zm-tooltip",{staticClass:"item",attrs:{placement:"bottom-start"}},[t("span",{staticClass:"discard",on:{click:e.discardSubject}},[t("svg-icon",{attrs:{iconClass:"close"}})],1),t("div",{staticClass:"tooltip",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.$t("common.dismiss")))])])],1)]):e._e()]),e.isLocked?t("div",{ref:"editorBody",staticClass:"compose-body"},[t("div",{staticClass:"locked-draft"},[t("locked-draft-content",{attrs:{draftDetail:e.composeItem,labelId:e.currentLabelId},on:{updateDraftContent:e.handleUpdateDraftContent}}),t("toolbar",{attrs:{disableAllActions:!0,msgId:e.msgId}})],1)]):t("div",{ref:"editorBody",staticClass:"compose-body"},[t("drop-zone",{attrs:{onDragEnter:e.debouncedPositionUploader,onLeaveWindow:e.onLeaveWindow,filesOnly:""}},[t("editor",{ref:"editor",attrs:{inlineImages:e.inlineImages,options:e.editorOptions,to2Contacts:e.to2Contacts,noPadding:"",hideToolbarByDefault:"",isFloatingToolbar:"","zm-ta":"new-compose-editor"},on:{"hook:mounted":e.editorMounted,focus:function(t){return e.handleFocus(t,"editor")},blur:function(t){return e.handleBlur(t,"editor")},input:e.handleEditorContentUpdate,immediateUpdate:e.handleImmediateUpdate,showFileSelector:e.showFileSelector,pasteFiles:e.uploadFiles,imageInserted:e.removeInsertedImage,addContact:e.handleAddContact,removeContact:e.handleRemoveContact},scopedSlots:e._u([e.hasExternalRecipient&&!e.showExpirationBanner||e.showScheduledSend||e.hasAttachments||e.hasGroupEmail||e.showExpirationBanner||e.showOOO||e.isDelegated||e.isOfflineByDisconection?{key:"selectList",fn:function(){return[t("div",{staticClass:"editor-select-list-container"},[e.isOfflineByDisconection?t("offline-mode-compose-banner"):e._e(),e.hasExternalRecipient&&!e.showExpirationBanner?t("external-user-warning-banner",{on:{handleHasExternal:e.handleHasExternal,handleUserDismissExternal:e.handleUserDismissExternal}}):e._e(),e.hasGroupEmail?t("group-email-banner",{on:{handleHasGroup:e.handleHasGroup,handleUserDismissGroup:e.handleUserDismissGroup}}):e._e(),e.showOOO?t("OOOStatusBanner",{attrs:{recipientsStatus:e.recipientsStatus},on:{hide:e.forceHide}}):e._e(),e.showExpirationBanner||e.showScheduledSend?t("div",{class:[{subitems:e.hasComposeSubItems}]},[e.showExpirationBanner?t("expiration-banner",{attrs:{showExpirationBanner:e.showExpirationBanner,expirationSeconds:e.expirationSeconds,hasComposeSubItems:e.hasComposeSubItems},on:{edit:e.handleSetSecurity,closed:e.handleCloseExpirationBanner}}):e._e(),e.showScheduledSend?t("scheduled-send-banner",{ref:"scheduledSend",attrs:{showScheduledSend:e.showScheduledSend,scheduledTime:e.scheduledTime,isEdit:!0,hasComposeSubItems:e.hasComposeSubItems},on:{handleCustomTimeVisible:e.handleCustomTimeVisible,handleEditScheduledSend:e.handleEditScheduledSend,handleScheduledSend:e.handleScheduledSend,setScheduledTime:e.setScheduledTime}}):e._e()],1):e._e(),e.hasAttachments?t("AttachmentsList",{attrs:{attachments:e.availableAttachmentList,showDelete:!0,fromPopOut:e.fromPopOut},on:{deleteItem:e.handleDeleteItem}}):e._e(),e.isDelegated?t("delegate-banner",{attrs:{showDelegateBanner:e.isDelegated}}):e._e()],1)]},proxy:!0}:null],null,!0)},[t("toolbar",{ref:"toolbar",attrs:{isCompose:!0,hasDraftContent:e.hasDraftContent,disableSent:e.isSentDisabled,isSecure:e.passwordProtected,customTimeVisible:e.customTimeVisible,isEditScheduledSend:e.isEditScheduledSend,showScheduledSend:e.showScheduledSend,showScheduledSendActions:e.showScheduledSendActions,scheduledTime:e.scheduledTime,externalListLength:e.externalListLength,groupListLength:e.groupListLength,msgId:e.msgId,isPromptEditorVisible:e.isPromptEditorVisible},on:{handleScheduledSend:e.handleScheduledSend,handleEditScheduledSend:e.handleEditScheduledSend,handleShowScheduledSendActions:e.handleShowScheduledSendActions,handleCustomTimeVisible:e.handleCustomTimeVisible,setScheduledTime:e.setScheduledTime,send:e.handleSend,selectedFiles:e.handleSelectedFiles,setSecurity:e.handleSetSecurity,delete:e.handleDraftDelete,openPromptEditor:e.openPromptEditor,insertTemplate:e.handleInsertTemplate}})],1)],1),e.isPromptEditorVisible?t("prompt-editor",{attrs:{"preset-draft":e.plainDraftContent,recipients:e.publicRecipients},on:{closePromptEditor:function(t){e.isPromptEditorVisible=!1},onInsertContent:e.insertNewCompose,onHasGeneratedContent:e.onHasGeneratedContent}}):e._e()],1),t("expiration-dialog",{attrs:{show:e.showExpirationModal,title:e.$t("detail.passwordProtection"),defaultExpiration:e.expirationSeconds,ruleActive:e.passwordProtected,"zm-ta":"password-protection-expiration-dialog"},on:{onCancel:e.handleExpirationCancel,onOk:e.handleExpirationSelect,onRemove:e.handleExpirationRemove}})],1)},as=[],rs=i(8751),os=i(68783),ls=i(48641),cs=i(70918),ds=i(44721),us=i(43368),hs=i(24616),ms=i(18276),ps=i(97714),fs=i(44280),vs=i(42915),bs=i(25655),gs=i(53744),Ss=i(19030),Is=i(35682),xs=i(22168),ws={DEFAULT_WIDTH:600,DEFAULT_HEIGHT:550},ys=i(96713),Cs=i(54565),Ls=i(1679),ks=c.Enums.SystemDefinedMailLabelIds,$s=c.Components.LockedDraftContent,Ts="<div><br></div>",_s={name:"Compose",components:{Editor:rs["default"],Toolbar:os["default"],SvgIcon:g.Z,contactsSelector:bs.Z,DropZone:xs["default"],ExpirationDialog:fs["default"],ExpirationBanner:vs["default"],ScheduledSendBanner:ls.Z,ExternalUserWarningBanner:cs.Z,LockedDraftContent:$s,GroupEmailBanner:us.Z,OOOStatusBanner:hs.Z,AttachmentsList:ps.Z,DelegateBanner:ms.Z,OfflineModeComposeBanner:ds.Z,PromptEditor:Cs.Z},mixins:[Ss.b,Is.v7,Is.go,Ls.Z],props:{id:{type:String,default:""},isCurrent:{type:Boolean,default:!1},composeItem:{type:Object,default:function(){}},isDraft:{type:Boolean,default:!1},isForward:{type:Boolean,default:!1},isReply:{type:Boolean,default:!1},preTo:{type:Array,default:function(){return[]}},fromPopOut:{type:Boolean,default:!1}},data:function(){return{clientHeight:window.innerHeight,originalComposeHeight:ws.DEFAULT_HEIGHT,originalComposeWidth:ws.DEFAULT_WIDTH,composeHeight:ws.DEFAULT_HEIGHT,composeWidth:ws.DEFAULT_WIDTH,minComposeHeight:ws.DEFAULT_HEIGHT,bannerAdjustHeight:300,resizing:!1,resizeOriginalPos:{offsetX:0,offsetY:0},resizeOri:"",to:[],cc:[],bcc:[],subject:"",content:"",showCc:!1,showBcc:!1,inReplyTo:"",fullScreen:!1,options:[],passwordProtected:!1,showExpirationModal:!1,showExpirationBanner:!1,expirationSeconds:2592e3,composePrepared:!1,isComposeDirty:!1,isSending:!1,creatingOrUpdating:!1,isEditorMounted:!1,msgId:"",threadId:"",totalMessageSize:0,updatedContent:!1,isEditingMailRecipients:!1,isEditingMailSubject:!1,isEditingMailContent:!1,editorOptions:{isComposeEditor:!0},showScheduledSend:!1,customTimeVisible:!1,isEditScheduledSend:!1,showScheduledSendActions:!1,scheduledTime:null,isPromptEditorVisible:!1,showSmartSubject:!1,smartSubject:"",hasGeneratedContent:!1,plainDraftContent:""}},computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)({userTimeZone:function(e){return e.userProfile.userTimeZone},typeOfEmail:function(e){return e.typeOfEmail},inboxItem:function(e){return e.currentInboxItem},undoDuration:function(e){return e.undoDuration},mailLabels:function(e){return e.mailLabels},allowMailExternalImg:function(e){return e.allowMailExternalImg},isDelegated:function(e){return e.userProfile.isDelegated}})),(0,u.rn)("auth",["defaultAccountLists"])),(0,u.Se)(["isZmail","currentLabelId","isOfflineByDisconection"])),{},{canConsumeUploadedFile:function(){return!0},maxHeight:function(){return this.clientHeight},isLocked:function(){var e;return c.Utils.isDecryptFailed(null===(e=this.composeItem)||void 0===e?void 0:e.decryptionStatus)},composeTitle:function(){var e;return(null===(e=this.composeItem)||void 0===e?void 0:e.mailHead.subject)||this.$t("editor.newMail")},publicRecipients:function(){return[].concat((0,se.Z)(this.to),(0,se.Z)(this.cc))},recipients:function(){return[].concat((0,se.Z)(this.to),(0,se.Z)(this.cc),(0,se.Z)(this.bcc))},hasMore:function(){return this.recipients.length>5},hasInvalidContactInMoreContact:function(){var e=this;return!!this.hasMore&&this.recipients.slice(5).some((function(t){return!e.isValidateMail(t)}))},hasComposeSubItems:function(){return this.showExpirationBanner&&this.showScheduledSend},hasAttachments:function(){return this.availableAttachmentList.length>0},isSentDisabled:function(){return"Uploading"===this.attachmentsStatus},metricContext:function(){var e="new_email";return this.isForward&&(e="forward"),this.isReply&&(e="reply"),e},hasDraftContent:function(){return!!this.plainDraftContent}}),watch:{maxHeight:function(){this.composeHeight>this.maxHeight-50&&(this.composeHeight=this.maxHeight-50)},isCurrent:function(e){e&&this.autofocus()},subject:function(e){this.$emit("updateSubject",{id:this.id,subject:e})},cc:function(e,t){ce().isEqual(e,t)||(this.showCc=!0)},bcc:function(e,t){ce().isEqual(e,t)||(this.showBcc=!0)},externalListLength:function(e){0===e&&this.handleExpirationRemove()},activeKeyBinding:function(e){var t=e.action,i=e.event;switch(t){case"editor-send":i.preventDefault(),this.isCurrent&&(this.isEditingMailRecipients||this.isEditingMailSubject||this.isEditingMailContent)&&"Uploading"!=this.attachmentsStatus&&this.handleSend();break;case"editor-add-cc":i.preventDefault(),this.isEditingMailRecipients&&this.handleCc();break;case"editor-add-bcc":i.preventDefault(),this.isEditingMailRecipients&&this.handleBcc();break;default:break}},isPromptEditorVisible:function(e){e||(this.hasGeneratedContent=!1)},hasGeneratedContent:function(e){e&&this.$refs.root?this.$refs.root.style.height=this.fullScreen?"".concat(this.maxHeight,"px"):"".concat(this.maxHeight-50,"px"):!e&&this.$refs.root&&(this.$refs.root.style.height="auto")}},created:function(){var e=this;this.debouncedHandleResizeMouseMove=ce().throttle(this.handleResizeMouseMove,16),this.$once("hook:beforeDestroy",(function(){e.debouncedHandleResizeMouseMove.cancel()})),window.addEventListener("resize",this.resizedWindow),this.$nextTick((0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a,l,d,u,h,m,p,f,v,b,g,S,I,x,w,y,C,L,k;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i="",t.prev=2,t.next=5,e.$store.dispatch("mail/loadMailSignature",{useCache:!1});case 5:n=t.sent,n&&(s=(0,zi.Z)((0,ue.mM)(n)),i=s.sanitize({filterDarkModeStyles:!0,filterThirdPartyLinks:!e.allowMailExternalImg}).process({needFold:!1,injectStyle:!1,injectScript:!1,lazyLoad:!1}).generate(),s.destroy(),s=null),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](2),e.$msg(e.$t("generalSettings.failedToGetSignature"));case 13:e.composeItem?(a=e.composeItem,l=a.bcc,d=a.from,u=a.cc,h=a.content,m=a.mailHead,p=a.to,f=a.attachments,v=(0,ue.mM)(c.Utils.sanitizeHTML2String(null===m||void 0===m?void 0:m.subject)),b=(0,ue.mM)(h,{WHOLE_DOCUMENT:!0}),g=c.Utils.sanitizeHTML2String(null===d||void 0===d?void 0:d.displayName),S=c.Utils.sanitizeHTML2String(null===d||void 0===d?void 0:d.emailAddr),e.isForward?(I=m&&m.subject?m.subject:"",e.subject="Fwd: "+I,e.attachments=f&&f.length>0?f.map((function(t){return t.msgId=e.composeItem.mailHead.msgId,t})):[],e.to=[],e.bcc=[],e.cc=[],x=(0,ue.mM)(p.map((function(e){return"".concat(c.Utils.sanitizeHTML2String(e.displayName),'&lt;<a href="mailto:').concat(c.Utils.sanitizeHTML2String(e.emailAddr),'">').concat(c.Utils.sanitizeHTML2String(e.emailAddr),"</a>&gt;")})).join(", ")),w=(0,ue.mM)(u.length>0?"<div>Cc: "+u.map((function(e){return"".concat(c.Utils.sanitizeHTML2String(e.displayName),'&lt;<a href="mailto:').concat(c.Utils.sanitizeHTML2String(e.emailAddr),'">').concat(c.Utils.sanitizeHTML2String(e.emailAddr),"</a>&gt;")})).join(", ")+"</div>":""),y='\n              <div class="gmail_quote">\n                <div class="gmail_attr">\n                  <div>---------- Forwarded message ---------- </div>\n                  <div>\n                    From: <b>'.concat(g,'</b>&lt;<a href="mailto:').concat(S,'">').concat(S,"</a>&gt;\n                  </div>\n                  <div>Date: ").concat(e.formatTime(m.date),"</div>\n                  <div>Subject: ").concat(v,"</div>\n                  <div>To: ").concat(x,"\n                  </div>\n                  ").concat(w,"\n                </div>\n                <br/>\n                ").concat(b,"\n              </div>\n            ")+'\n              <div class="gmail_signature">\n                '.concat(i,"\n              </div>\n            "),e.setEditorContent(y),e.setEditorEllipsisContent("")):e.isReply||(e.isDraft?(e.initComposeContentWithDraft(e.composeItem),e.inReplyTo=e.composeItem.inReplyTo):(e.to=p?p.map((function(e){return e.emailAddr})):[],e.bcc=l?l.map((function(e){return e.emailAddr})):[],e.cc=u?u.map((function(e){return e.emailAddr})):[],C="\n            <div>".concat(b,"</div>\n          "),L="\n              ".concat(Ts,'\n              <div class="gmail_signature">\n                ').concat(i,"\n              </div>\n            "),e.setEditorContent(b?C+L:L),e.subject=m&&m.subject?m.subject:"",e.attachments=f&&f.length>0?f:[]))):(i.length>0?(k="\n            ".concat(Ts,'\n            <div class="gmail_signature">\n              ').concat(i,"\n            </div>\n          "),e.setEditorContent(k),e.setEditorEllipsisContent("")):e.setEditorContent(""),e.preTo.length>0&&(e.to=e.preTo)),e.debounceComposeChange=ce().debounce((function(){e.doCreateOrUpdate()}),gs.Z.composeChangedFrequency,{leading:!0,trailing:!0}),e.monitorComposeChange=function(){e.composePrepared&&(e.isComposeDirty=!0,e.debounceComposeChange())},e.updateImmediately=(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.composePrepared){t.next=4;break}e.isComposeDirty=!0,t.next=5;break;case 4:return t.abrupt("return");case 5:if(e.msgId){t.next=10;break}return t.next=8,e.createDraft();case 8:t.next=13;break;case 10:if(!e.msgId){t.next=13;break}return t.next=13,e.updateDraft();case 13:case"end":return t.stop()}}),t)}))),e.$watch("to",e.monitorComposeChange),e.$watch("cc",e.monitorComposeChange),e.$watch("bcc",e.monitorComposeChange),e.$watch("subject",e.monitorComposeChange),e.$watch("attachments",e.updateImmediately),e.$watch("expirationSeconds",e.monitorComposeChange),e.$watch("passwordProtected",e.monitorComposeChange),e.$watch("scheduledTime",e.monitorComposeChange),e.composePrepared=!0,e.recipients.length&&(e.isEditingMailContent=!0),e.autofocus();case 28:case"end":return t.stop()}}),t,null,[[2,9]])}))))},mounted:function(){oe()(document).on("mousemove",this.debouncedHandleResizeMouseMove),oe()(document).on("mouseup",this.handleResizeMouseUp),oe()(document).on("mouseleave",this.handleResizeMouseLeave)},beforeDestroy:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(oe()(document).off("mousemove",e.debouncedHandleResizeMouseMove),oe()(document).off("mouseup",e.handleResizeMouseUp),oe()(document).off("mouseleave",e.handleResizeMouseLeave),window.removeEventListener("resize",e.resizedWindow),!e.fromPopOut){t.next=7;break}return t.next=7,e.updateDraft();case 7:case"end":return t.stop()}}),t)})))()},methods:{handleFocusTrap:function(e){var t,i,n,s=document.activeElement,a=null===(t=this.$refs.toolbar)||void 0===t||null===(i=t.$refs.discardButton)||void 0===i?void 0:i.$el,r=null===(n=this.$refs.minimizeButton)||void 0===n?void 0:n.$el;switch(s){case a:e.shiftKey||(e.preventDefault(),r.focus());break;case r:e.shiftKey&&(e.preventDefault(),a.focus());break}},openPromptEditor:function(){this.isPromptEditorVisible=!0},resizedWindow:function(){this.clientHeight=window.innerHeight},handleEditScheduledSend:function(e){this.isEditScheduledSend=e},handleCustomTimeVisible:function(e){this.customTimeVisible=e},handleScheduledSend:function(e){this.showScheduledSend=e},handleShowScheduledSendActions:function(e){this.showScheduledSendActions=e},handleInsertTemplate:function(e){""===this.subject&&(this.subject=e.name)},handleUpdateDraftContent:function(e){var t=this,i={key:this.id,isDraft:!0,composeItem:(0,l.Z)({},e)};this.$store.commit("updateInstantDraft",i),this.$store.commit("setCurrentInstantDraft",i),this.composePrepared=!1,this.$nextTick((function(){t.initComposeContentWithDraft(e),t.$nextTick((function(){t.composePrepared=!0}))})),window.zoomSdk.postJsMessage({functionName:"mailui_getthreadhead",params:{labelId:this.currentLabelId,threadId:e.mailHead.threadId}}).then((function(e){0===(null===e||void 0===e?void 0:e.returnCode)&&t.$store.commit("addGetThreadHead",e.result)}))["catch"]((function(e){}))},getPlainDraft:function(e){var t=document.createElement("p");return t.innerHTML=e,t.innerText},initComposeContentWithDraft:function(e){var t,i=e.bcc,n=e.cc,s=e.content,a=e.mailHead,r=e.to,o=e.attachments;if(this.msgId=e.mailHead.msgId,this.threadId=e.mailHead.threadId,this.to=r?r.map((function(e){return e.emailAddr})):[],this.bcc=i?i.map((function(e){return e.emailAddr})):[],this.cc=n?n.map((function(e){return e.emailAddr})):[],c.Utils.isDecryptFailed(null===e||void 0===e?void 0:e.decryptionStatus)?this.subject=this.$t("operation.draftLocked"):this.subject=a.subject||"",c.Utils.isDecrypted(null===e||void 0===e?void 0:e.decryptionStatus)&&s.length>0){var l=(0,ue.mM)(s,{WHOLE_DOCUMENT:!0});if(this.plainDraftContent=this.getPlainDraft(l),"Reply"===e.mailHead.mDraftType){this.setEditorContent(l);var d=oe()("<div/>");d.html(l);var u=d.clone();u.find(".gmail_quote:first").prevAll(":not(.gmail_quote)").remove(),d.find(".gmail_quote").remove(),this.setEditorContent(d.html()),this.setEditorEllipsisContent(u.html())}else this.setEditorContent(l)}this.attachments=o&&o.length>0?o:[];var h=this.isZmail&&"PasswordProtect"===(null===e||void 0===e||null===(t=e.sendMailEncryptOption)||void 0===t?void 0:t.Mode);if(h){var m=e.sendMailEncryptOption;this.expirationSeconds=m.passwordExpireSeconds?m.passwordExpireSeconds:2592e3,this.showExpirationBanner=!!m.passwordExpireSeconds,this.passwordProtected=!0}var p=Tt.ou.now().toISO(),f=Tt.ou.fromSeconds(a.date).toISO();this.isZmail&&f&&p<f&&(this.showScheduledSend=!0,this.scheduledTime=Tt.ou.fromSeconds(a.date))},setScheduledTime:function(e){this.scheduledTime=e},autofocus:function(){try{if(!this.to.length)return void this.focusToSelector("to");if(!this.subject.length)return void this.$refs.input.focus();this.getEditorInstance().focus()}catch(e){}},handleResizeMouseDown:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$refs.toContactRef.hide(),this.$refs.ccContactRef.hide(),this.$refs.bccContactRef.hide();var i=e.pageX,n=e.pageY;this.resizeOriginalPos={pageX:i,pageY:n},this.originalComposeHeight=this.composeHeight,this.originalComposeWidth=this.composeWidth,this.resizing=!0,this.resizeOri=t},handleResizeMouseMove:function(e){if(this.resizing){e.preventDefault();var t=e.originalEvent,i=t.pageY,n=t.pageX;i<20&&(i=20),n<20&&(n=20);var s=this.resizeOriginalPos.pageY,a=s-i,r=this.originalComposeHeight+a;this.composeHeight=r<this.minComposeHeight?this.minComposeHeight:r}},handleResizeMouseUp:function(){this.resizing=!1,this.resizeOri="",this.resizeOriginalPos={pageX:0,pageY:0},this.originalComposeHeight=this.composeHeight,this.originalComposeWidth=this.composeWidth},handleResizeMouseLeave:function(){this.resizing=!1,this.resizeOri="",this.resizeOriginalPos={pageX:0,pageY:0},this.originalComposeHeight=this.composeHeight,this.originalComposeWidth=this.composeWidth},handleEditorContentUpdate:function(){this.monitorComposeChange&&this.monitorComposeChange()},handleDraftDelete:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.msgId){t.next=3;break}return t.next=3,window.zoomSdk.postJsMessage({functionName:"mailui_deletedraft",params:{draftId:e.msgId}});case 3:e.creatingOrUpdating=!0,e.resetInfo(),e.creatingOrUpdating=!1,e.$undoNotice({title:e.$t("operation.draftDiscarded")}),e.$emit("triggerClose",e.id);case 8:case"end":return t.stop()}}),t)})))()},formatTime:function(e){return Tt.ou.fromSeconds(e).setZone(this.userTimeZone).toLocaleString(Tt.ou.DATETIME_MED)},handleMini:function(){this.recipients.length>0&&(this.isEditingMailContent=!0),this.$Bus.$emit("disableLinkPopoverVisible"),this.doCreateOrUpdate(),this.$emit("minimize"),this.$metric.report("editor_minimize",{msgId:this.msgId})},resetInfo:function(){this.to=[],this.cc=[],this.bcc=[],this.setEditorContent(Ts),this.subject="",this.attachments=[],this.passwordProtected=!1,this.totalMessageSize=0},handleFullScreen:function(){this.$Bus.$emit("disableLinkPopoverVisible"),this.fullScreen=!this.fullScreen,this.$metric.report(this.fullScreen?"editor_maximize":"editor_minimize",{msgId:this.msgId})},resetEditingMailRecipientsState:function(e){this.isEditingMailRecipients=!1},handleFocus:function(e,t){"recipients"===t?(this.isEditingMailRecipients=!0,this.showScheduledSendActions=!1,this.preventCollapseRecipients()):("editor"===t?(this.isEditingMailContent=!0,this.isEditingMailRecipients=!1):"subject"===t&&(this.isEditingMailSubject=!0,this.isEditingMailRecipients=!1,this.showScheduledSendActions=!1),this.hideCcBccIfEmpty(),this.collapseRecipients())},hideCcBccIfEmpty:function(){this.showBcc=Boolean(this.bcc.length),this.showCc=Boolean(this.cc.length)},handleBlur:function(e,t){"editor"===t?this.isEditingMailContent=!1:"subject"===t&&(this.isEditingMailSubject=!1)},handleCc:function(){var e=this;this.isLocked||(this.showCc=!0,this.$nextTick((function(){return e.$refs.ccContactRef.focus()})))},handleBcc:function(){var e=this;this.isLocked||(this.showBcc=!0,this.$nextTick((function(){return e.$refs.bccContactRef.focus()})))},triggerClose:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$Bus.$emit("disableLinkPopoverVisible"),e.$emit("triggerClose",e.id),e.doCreateOrUpdate(),e.$metric.report("editor_close",{msgId:e.msgId});case 4:case"end":return t.stop()}}),t)})))()},updateDraft:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isLocked){t.next=2;break}return t.abrupt("return");case 2:return i={subject:e.subject,content:(0,ue.mM)(e.getEditorContent()),snippet:"",inReplyTo:e.inReplyTo,forwardMsgZid:e.isForward&&e.composeItem&&e.composeItem.mailHead.msgId?e.composeItem.mailHead.msgId:"",draftId:"",msgId:e.msgId,mailEncryptionMode:e.detectMailEncryptionMode(),passwordExpireSeconds:e.passwordProtected?e.expirationSeconds:void 0,scheduledSendTime:e.scheduledTime?e.convertTime(e.scheduledTime):null,toUserEmail:e.to.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),ccUserEmail:e.cc.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),bccUserEmail:e.bcc.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),atListUserEmail:[],attachments:e.attachments},i.snippet=c.Utils.getMailSnippet(i.content),t.next=6,d.Draft.updateDraft({mailSendInfo:i});case 6:e.$emit("creatingOrUpdating",e.id),e.getThreadHeadAllLabels();case 8:case"end":return t.stop()}}),t)})))()},getThreadHeadAllLabels:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){var i,n,s,a,o;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=ks.DRAFT,s){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,(0,ue.vA)(y.t.getThreadHead(s,e.threadId),(function(t){e.$store.commit("addGetThreadHead",t)}));case 6:a=t.sent,o=(null===a||void 0===a||null===(i=a.GetThreadHead)||void 0===i||null===(n=i.threadHead)||void 0===n?void 0:n.showLabelIds)||[],Promise.all(null===o||void 0===o?void 0:o.map((function(t){return(0,ue.vA)(y.t.getThreadHead(t,e.threadId),(function(t){e.$store.commit("addGetThreadHead",t)}))})));case 9:case"end":return t.stop()}}),t)})))()},createDraft:function(){var e=this,t={subject:this.subject,content:(0,ue.mM)(this.getEditorContent()),snippet:"",inReplyTo:"",forwardMsgZid:this.isForward&&this.composeItem&&this.composeItem.mailHead.msgId?this.composeItem.mailHead.msgId:"",msgId:"",mailEncryptionMode:this.detectMailEncryptionMode(),passwordExpireSeconds:this.passwordProtected?this.expirationSeconds:void 0,scheduledSendTime:this.scheduledTime?this.convertTime(this.scheduledTime):null,toUserEmail:this.to.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),ccUserEmail:this.cc.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),bccUserEmail:this.bcc.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),atListUserEmail:[],attachments:this.attachments};return t.snippet=c.Utils.getMailSnippet(t.content),d.Draft.createDraft({mailSendInfo:t}).then((function(t){return 0===t.errorCode?(e.$emit("creatingOrUpdating",e.id),e.msgId=t.data.CreateDraft.msgId,e.threadId=t.data.CreateDraft.threadId,e.$store.commit("updateInstantDraft",{key:e.id,threadId:e.threadId,msgId:e.msgId}),e.$metric.report("sidebar_new_mail",{msgId:e.msgId})):(e.$msg(e.$t("detail.createDraftFailed")),e.$metric.report("sidebar_new_mail",{error:e.$metric.apiError("mailui_createdraft",t)})),t}))["catch"]((function(t){e.$metric.report("sidebar_new_mail",{msgId:e.msgId,error:e.$metric.jsError("mailui_createdraft",t)})}))},doCreateOrUpdate:function(){var e=this;return(0,o.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isComposeDirty){t.next=2;break}return t.abrupt("return");case 2:if(!e.isSending){t.next=4;break}return t.abrupt("return");case 4:if(!e.creatingOrUpdating){t.next=6;break}return t.abrupt("return");case 6:if(e.creatingOrUpdating=!0,e.msgId){t.next=12;break}return t.next=10,e.createDraft();case 10:t.next=15;break;case 12:if(!e.msgId){t.next=15;break}return t.next=15,e.updateDraft();case 15:e.creatingOrUpdating=!1;case 16:case"end":return t.stop()}}),t)})))()},handleShowCompose:function(){this.$store.commit("setCurrentSend",""),this.$store.commit("setCurrentInstantDraft",{key:this.id,composeItem:this.composeItem,isDraft:this.isDraft,isForward:this.isForward,isReply:this.isReply,preTo:this.preTo})},handleSend:function(){var e=this,t=[];if(this.attachments.forEach((function(e){"Error"!==e.downloadStatus&&t.push(e)})),this.attachments.length>t.length){var i=this.$t("editor.attachmentsFailedToLoad"),n=this.$t("editor.confirmSendContent");this.$confirm(n,i,{confirmButtonText:this.$t("editor.sendEmail"),cancelButtonText:this.$t("operation.cancel"),closeOnClickModal:!1,callback:function(i){"confirm"===i&&e.delayedSend(t,!0)}})}else this.delayedSend()},delayedSend:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isDisable)this.$msg(this.$t("editor.emailContentCannotBeEmpty"));else if(0!==this.to.length||0!==this.bcc.length||0!==this.cc.length){var n=this.validateEmails([].concat((0,se.Z)(this.to),(0,se.Z)(this.bcc),(0,se.Z)(this.cc)));if(n.length>0)this.$msg(n.length>1?this.$t("compose.emailNotValid",[n.join(", ")]):this.$t("compose.emailIsInvalid"));else{this.handleMini(),this.$store.commit("setCurrentSend",this.id),this.$store.commit("changeSendingFlag",{key:this.id,status:!0});var s={subject:this.subject,content:(0,ue.mM)(this.getEditorContent()),snippet:"",inReplyTo:this.inReplyTo,forwardMsgZid:this.isForward&&this.composeItem&&this.composeItem.mailHead.msgId?this.composeItem.mailHead.msgId:"",msgId:this.msgId,mailEncryptionMode:this.detectMailEncryptionMode(),passwordExpireSeconds:this.passwordProtected?this.expirationSeconds:void 0,scheduledSendTime:this.scheduledTime?this.convertTime(this.scheduledTime):null,toUserEmail:this.to.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),ccUserEmail:this.cc.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),bccUserEmail:this.bcc.map((function(e){return{emailAddr:e,displayName:e.split("@")[0]}})),atListUserEmail:[],ignoreFailedAttachments:i,attachments:i?t:this.attachments};s.snippet=c.Utils.getMailSnippet(s.content),this.isSending=!0,(0,ys.Y)({el:this.$root,mailSendInfo:s,undoDuration:this.undoDuration,onSendSuccessfully:function(){e.$emit("triggerClose",e.id),e.isSending=!1,e.$metric.report("send_mail",{event_context:e.metricContext,msgId:e.msgId})},onCancel:function(){e.isSending=!1,e.$store.commit("changeSendingFlag",{key:e.id,status:!1}),e.handleShowCompose()},onSendMailFailed:function(t){e.$metric.report("send_mail",{event_context:e.metricContext,msgId:e.msgId,error:e.$metric.apiError("mailui_senddraft",t)})},onSendMailError:function(t){e.$metric.report("send_mail",{event_context:e.metricContext,msgId:e.msgId,error:e.$metric.jsError("mailui_senddraft",t)})}},this.typeOfEmail)}}else this.$msg(this.$t("compose.toIsEmpty"))},handleSelectedFiles:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.checkMsgId();case 2:return i.prev=2,i.next=5,t.isValidateFilesSize(e);case 5:n=i.sent,n&&e.forEach((function(e){var i=t.attachments.findIndex((function(t){return t.filePath===e.filePath}));-1===i&&t.attachments.push(e)})),i.next=12;break;case 9:i.prev=9,i.t0=i["catch"](2);case 12:case"end":return i.stop()}}),i,null,[[2,9]])})))()},handleSetSecurity:function(){this.showExpirationModal=!0},handleExpirationCancel:function(){this.showExpirationModal=!1},handleExpirationRemove:function(){this.passwordProtected=!1,this.expirationSeconds=2592e3,this.showExpirationBanner=!1,this.showExpirationModal=!1},handleSetSecurityExpiration:function(e){this.expirationSeconds=e},handleExpirationSelect:function(e){this.showExpirationModal=!1,this.expirationSeconds=e,this.passwordProtected=!0,this.showExpirationBanner=!0},handleCloseExpirationBanner:function(){this.showExpirationBanner=!1,this.hasExternalRecipient=!1},validateEmails:function(e){var t=this,i=[];return e.forEach((function(e){t.validateEmail(e)||i.push(e)})),(0,se.Z)(new Set(i))},validateEmail:function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},getEditorComponent:function(){if(this.isEditorMounted)return this.$refs.editor.$refs.squireEditor},getEditorInstance:function(){return this.$refs.editor.$refs.squireEditor.editorInstance},getEditorContent:function(){var e=this.getEditorComponent();if(e){var t=e.getContent();return t===Ts?"":t}return""},setEditorContent:function(e){var t=this.getEditorComponent();t&&t.setContent(e||Ts)},setEditorEllipsisContent:function(e){var t=this.getEditorComponent();t&&t.setEllipsisContent(e)},isEditorEmpty:function(){var e=this.getEditorContent();return!oe()(e).text()},editorMounted:function(){this.isEditorMounted=!0},setWidth:function(e){this.composeWidth=e},setHeight:function(e){this.composeHeight=e},getPosition:function(){var e=this.$refs.root.getBoundingClientRect();return{left:e.left,top:e.top,width:e.width,height:e.height}},isFullScreen:function(){return this.fullScreen},focusToSelector:function(e){this.isEditingMailRecipients=!0;var t={to:this.$refs.toContactRef,cc:this.$refs.ccContactRef,bcc:this.$refs.bccContactRef};this.$nextTick((function(){var i;return null===(i=t[e])||void 0===i?void 0:i.focus()}))},key:function(e){return"".concat(e," + ").concat((0,bi.Z)())},isValidateMail:function(e){return(0,ue.Xt)(e)},needAttachBccIndicator:function(e,t){return e===this.publicRecipients.length&&this.bcc.includes(t)},dragEnter:function(e){this.$emit("onDragEnter",e)},resetShowActions:function(){this.$refs.toContactRef&&(this.$refs.toContactRef.showActions=!1,this.$refs.toContactRef.targetContact=null),this.$refs.ccContactRef&&(this.$refs.ccContactRef.showActions=!1,this.$refs.ccContactRef.targetContact=null),this.$refs.bccContactRef&&(this.$refs.bccContactRef.showActions=!1,this.$refs.bccContactRef.targetContact=null)},convertTime:function(e){return Math.floor(e.toSeconds())},detectMailEncryptionMode:function(){return this.passwordProtected?"PasswordProtect":this.externalListLength?"Plaintext":"ExternalDisAllowed"},appendRecipient:function(e,t){switch(t){case"to":this.to.push(e);break;case"cc":this.cc.push(e);break;case"bcc":this.bcc.push(e);break;default:break}},insertNewCompose:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.isPromptEditorVisible=!1,e){var i=(0,ue.mM)(e,{WHOLE_DOCUMENT:!0});this.setEditorContent(i),this.handleEditorContentUpdate(),this.subject?(this.showSmartSubject=!0,this.smartSubject=t):this.subject=t}},selectSmartCompose:function(){this.subject=this.smartSubject,this.showSmartSubject=!1},onHasGeneratedContent:function(e){e&&!this.hasGeneratedContent&&(this.hasGeneratedContent=!0)},discardSubject:function(){this.smartSubject="",this.showSmartSubject=!1}}},Ds=_s,Es=(0,D.Z)(Ds,ss,as,!1,null,"7e3f0b1c",null),Ms=Es.exports,As=function(){var e=this,t=e._self._c;return t("transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isHide,expression:"isHide"}],class:["compose-shortcut-wrap",{active:e.isCurrent}],attrs:{title:e.isAllowCompose?"":e.$t("editor.resizeYourWindowToHaveMoreSpace")}},[t("div",{staticClass:"title"},[e.creatingOrUpdatingLists[e.id]?t("i",[e._v(" ["+e._s(e.$t("label.draft"))+"]  ")]):e._e(),t("span",[e._v(e._s(e.title))])]),t("div",{staticClass:"caption-button-wrap"},[t("zm-tooltip",{directives:[{name:"show",rawName:"v-show",value:!e.isCurrent&&e.isAllowCompose,expression:"!isCurrent && isAllowCompose"}],attrs:{content:e.$t("common.maximize"),placement:"bottom",enterable:!1}},[t("zm-button",{staticClass:"caption-button",attrs:{"zm-ta":"compose-shortcut-maximize","aria-label":e.$t("common.maximize"),"aria-expanded":void 0},on:{click:e.handleShowCompose}},[t("SvgIcon",{attrs:{iconClass:"maximize"}})],1)],1),t("zm-tooltip",{attrs:{content:e.$t("common.saveAndClose"),placement:"bottom",enterable:!1}},[t("zm-button",{staticClass:"caption-button",attrs:{"zm-ta":"compose-shortcut-close","aria-label":e.$t("common.saveAndClose"),"aria-expanded":void 0},on:{click:e.handleCloseCompose}},[t("SvgIcon",{attrs:{iconClass:"close"}})],1)],1)],1)])])},Rs=[],Zs={name:"ComposeShortcut",props:{id:{type:String,default:""},isCurrent:{type:Boolean,default:!1},composeItem:{type:Object,default:function(){}},isDraft:{type:Boolean,default:!1},isForward:{type:Boolean,default:!1},isReply:{type:Boolean,default:!1},preTo:{type:Array,default:function(){return[]}},creatingOrUpdatingLists:{type:Object,default:function(){}},isAllowCompose:{type:Boolean,default:!0}},data:function(){return{snippet:""}},computed:(0,l.Z)((0,l.Z)({},(0,u.rn)(["isCurrentSent","instantDraftList"])),{},{title:function(e){var t=e.snippet,i=e.composeItem;return t||(i&&i.plainText?i.plainText:this.$t("editor.newMail"))},isHide:function(e){var t=e.id,i=e.isCurrentSent;return!(i&&i===t)}}),methods:{handleShowCompose:function(){var e,t,i,n=this;this.$store.commit("setCurrentInstantDraft",{key:this.id,composeItem:this.composeItem,isDraft:this.isDraft,isForward:this.isForward,isReply:this.isReply,preTo:this.preTo}),this.$Bus.$emit("disableLinkPopoverVisible"),this.$emit("onShowCompose"),this.$metric.report("editor_maximize",{msgId:(null===(e=this.instantDraftList.find((function(e){return e.key===n.id})))||void 0===e||null===(t=e.composeItem)||void 0===t||null===(i=t.mailHead)||void 0===i?void 0:i.msgId)||this.id})},handleCloseCompose:function(){this.$emit("close",this.id)},setComposeSinippet:function(e){this.snippet=e}}},zs=Zs,Os=(0,D.Z)(zs,As,Rs,!1,null,"32af2f50",null),Hs=Os.exports,Ps={name:"ComposeContainer",components:{Compose:Ms,ComposeShortcut:Hs},props:{composeItem:{type:Object,default:function(){}}},data:function(){return{creatingOrUpdatingLists:{},lastWindowWidth:window.innerWidth,lastWindowHeight:window.innerHeight,hideShortcuts:!1,allowComposeFromShortcut:!0}},computed:(0,l.Z)((0,l.Z)({},(0,u.rn)({currentCompose:"currentInstantDraft",composeList:"instantDraftList"})),{},{composeShortcutList:function(e){var t=e.composeList;return t.filter((function(e){return!e.status}))},isComposeShouldOnEdge:function(e){var t=e.composeShortcutList,i=e.currentCompose;return t.length<1||!(t.length>1)&&!!i},hasMultiShortcuts:function(e){var t=e.composeShortcutList;return t.length>1},showComposeShortCut:function(e){var t=e.composeShortcutList,i=e.currentCompose;return 0!==t.length&&(t.length>1||!i)},activeCompose:function(e){var t=e.currentCompose;return t?this.$refs["composeRef_".concat(t.key)][0]:null}}),watch:{currentCompose:function(e){e&&(e.isDraft&&this.creatingOrUpdating(e.key),this.hideShortcuts=!1)}},created:function(){var e=this;this.debouncedAutoLayoutCompose=ce().throttle(this.$autoLayoutCompose,16),this.$once("hook:beforeDestroy",(function(){e.debouncedAutoLayoutCompose.cancel()})),this.handleComposeUpdate=ce().throttle((function(t){var i=t.id,n=t.subject,s=e.$refs["composeShortcut_".concat(i)][0];s&&(null===s||void 0===s||s.setComposeSinippet(n.slice(0,20)))}),200)},mounted:function(){window.addEventListener("resize",this.debouncedAutoLayoutCompose)},beforeDestroy:function(){window.removeEventListener("resize",this.debouncedAutoLayoutCompose)},methods:{creatingOrUpdating:function(e){this.$set(this.creatingOrUpdatingLists,e,!0)},handleComposeClose:function(e){this.doComposeClose(e)},handleComposeMinimize:function(){this.$store.commit("setCurrentInstantDraft",null)},handleShortcutClose:function(e){var t=this.$refs["composeRef_".concat(e)][0];null===t||void 0===t||t.triggerClose()},doComposeClose:function(e){this.currentCompose&&this.currentCompose.key===e&&this.$store.commit("setCurrentInstantDraft",null);var t=this.$store.state.instantDraftList.filter((function(t){return e!==t.key}));this.$store.commit("setInstantDraftList",t)},resetInstantDraftsMsgIdByThreadIds:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.composeList.length&&this.composeList.forEach((function(i){var n,s,a=i.threadId||(null===(n=i.composeItem)||void 0===n||null===(s=n.mailHead)||void 0===s?void 0:s.threadId);if(a&&t.includes(a)){var r=e.$refs["composeRef_".concat(i.key)][0];r&&(r.msgId="")}}))},isDecreasingWindow:function(){return this.lastWindowWidth>window.innerWidth||this.lastWindowHeight>window.innerHeight},isIncreasingWindow:function(){return this.lastWindowWidth<window.innerWidth||this.lastWindowHeight<window.innerHeight},need2HideShortcutsForCompose:function(){if(this.hasMultiShortcuts&&this.currentCompose){var e,t,i=null===(e=this.activeCompose)||void 0===e?void 0:e.composeWidth,n=null===(t=this.$refs.shortcutListRef)||void 0===t?void 0:t.getBoundingClientRect();if(n)return n.right-n.width>i+10}return!1},allowComposeByShortcuts:function(){var e,t=null===(e=this.$refs.shortcutListRef)||void 0===e?void 0:e.getBoundingClientRect();if(t&&this.hasMultiShortcuts)return t.right-t.width>ws.DEFAULT_WIDTH+10;if(!this.hasMultiShortcuts){var i=0===t.width;return t.right>ws.DEFAULT_WIDTH+10||i}return!1},$autoLayoutCompose:function(){var e,t=60,i=10,n=.7*ws.DEFAULT_HEIGHT;if(!this.currentCompose||null===(e=this.activeCompose)||void 0===e||!e.isFullScreen()){if(this.isDecreasingWindow()&&this.currentCompose){var s,a=this.activeCompose.getPosition(),r=a.left,o=null===(s=this.activeCompose)||void 0===s?void 0:s.composeHeight;if(r<t){var l,c=o-i,d=c<n||r<=10;if(d){if(!this.hideShortcuts){var u=this.need2HideShortcutsForCompose();if(u)return void(this.hideShortcuts=!0)}this.handleComposeMinimize(),this.allowComposeFromShortcut=!1}null===(l=this.activeCompose)||void 0===l||l.setHeight(c)}}if(this.isIncreasingWindow()){if(this.currentCompose){var h,m,p=null===(h=this.activeCompose)||void 0===h?void 0:h.composeHeight,f=p<ws.DEFAULT_WIDTH;if(f)null===(m=this.activeCompose)||void 0===m||m.setHeight(p+10>ws.DEFAULT_HEIGHT?ws.DEFAULT_HEIGHT:p+10)}this.hasMultiShortcuts&&this.hideShortcuts&&(this.hideShortcuts=!this.need2HideShortcutsForCompose())}this.allowComposeFromShortcut=this.allowComposeByShortcuts(),this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight}},onShowCompose:function(e){var t=this.$refs["composeRef_".concat(e)]?this.$refs["composeRef_".concat(e)][0]:null;t&&t.syncRecipientsStatus()}}},Ns=Ps,Fs=(0,D.Z)(Ns,is,ns,!1,null,"5809ea13",null),Us=Fs.exports,Vs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vacation-banner"},[t("span",{staticClass:"text"},[e._v(e._s(e.vacationResponder.responseSubject))]),t("span",{staticClass:"button-wrap"},[t("zm-button",{attrs:{type:"link"},on:{click:e.disableVacationAutoReply}},[e._v(e._s(e.$t("vacationSettings.endNow")))]),t("zm-button",{attrs:{type:"link"},on:{click:e.goVacationSetting}},[e._v(e._s(e.$t("vacationSettings.vacationSettings")))])],1)])},Bs=[],Gs={name:"VacationResponderBanner",components:{},props:{},data:function(){return{}},computed:(0,l.Z)({},(0,u.rn)(["vacationResponder"])),methods:{disableVacationAutoReply:function(){var e=this,t=this.vacationResponder;t.enableAutoReply=!1;var i=JSON.stringify(t);window.zoomSdk.postJsMessage({functionName:"mailui_updatevacationresponder",params:{vacationResponder:i}}).then((function(t){if(0===t.returnCode)try{var i=JSON.parse(t.result.UpdateVacationResponder.vacationResponder);e.$store.commit("setVacationResponder",i),e.$undoNotice({title:e.$t("vacationSettings.vacationResponderUpdated")})}catch(n){e.$msg(e.$t("vacationSettings.failedToUpdateVacationResponder"))}else e.$msg(e.$t("vacationSettings.failedToUpdateVacationResponder"))}))},goVacationSetting:function(){this.$router.push({name:"Groups",path:"/group",params:{tab:"vacation",path:this.$route.path}})}}},Ws=Gs,js=(0,D.Z)(Ws,Vs,Bs,!1,null,"95beb610",null),Xs=js.exports,Ks=function(){var e=this,t=e._self._c;return e.showDragImage?t("div",{staticClass:"drag-image-wrap",style:e.coordsStyles},[t("div",{staticClass:"drag-image"},[t("svg-label",{attrs:{iconClass:"stroke-label",labelColor:"var(--zoom-blue)"}}),e._v(" "+e._s(e.$tc("operation.moveNumMessage",e.numDraggedEmails,[e.numDraggedEmails]))+" ")],1)]):e._e()},Js=[],Ys={name:"ThreadDragImage",computed:(0,l.Z)((0,l.Z)({},(0,u.rn)(["draggedEmails","dragImageCoords"])),{},{numDraggedEmails:function(){return this.draggedEmails.length},showDragImage:function(){return this.numDraggedEmails>0&&this.dragImageCoords[0]>=0&&this.dragImageCoords[1]>=0},coordsStyles:function(){return{left:"".concat(this.dragImageCoords[0],"px"),top:"".concat(this.dragImageCoords[1],"px")}}})},qs=Ys,Qs=(0,D.Z)(qs,Ks,Js,!1,null,null,null),ea=Qs.exports,ta=function(){var e=this,t=e._self._c;return t("span",{staticClass:"mail-service"},[e.isGmail?t("svg-icon",{attrs:{"aria-label":"Gmail",iconClass:"Google_logo","class-name":"mail-service-logo"}}):e._e(),e.isOutlook?t("svg-icon",{attrs:{"aria-label":"Outlook",iconClass:"Outlook_logo","class-name":"mail-service-logo"}}):e._e(),e.isZmail&&!e.isDelegated?t("svg-icon",{attrs:{"aria-label":"Zmail",iconClass:"Zoom_logo","class-name":"mail-service-logo"}}):e._e(),e.isZmail&&e.isDelegated?t("svg-icon",{attrs:{"aria-label":"Zmail",iconClass:"delegated_logo","class-name":"mail-service-logo-delegated"}}):e._e(),t("span",{class:["mail-service-name",{delegated:e.isDelegated}]},[e._v(" "+e._s(e.mailServiceName)+" ")])],1)},ia=[],na={name:"MailLogo",computed:(0,l.Z)((0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["typeOfEmail"])),(0,u.rn)({isDelegated:function(e){return e.userProfile.isDelegated}})),(0,u.Se)(["isGmail","isZmail","isOutlook"])),{},{mailServiceName:function(){var e,t=(e={},(0,ae.Z)(e,c.Enums.EMAIL_PROVIDER.GMAIL,"Gmail"),(0,ae.Z)(e,c.Enums.EMAIL_PROVIDER.OFFICE365,"Outlook"),(0,ae.Z)(e,c.Enums.EMAIL_PROVIDER.ZMAIL,"Zmail"),e);return t[this.typeOfEmail]||"Mail"}})},sa=na,aa=(0,D.Z)(sa,ta,ia,!1,null,"ab7b00ea",null),ra=aa.exports,oa={name:"NewUIView",components:{MailLogo:ra,SystemLabels:B,UserLabels:ee,inbox:ts,ComposeContainer:Us,ShortcutReminder:A.Z,VacationResponderBanner:Xs,ThreadDragImage:ea},data:function(){return{tabed:!1}},computed:(0,l.Z)((0,l.Z)((0,l.Z)({},(0,u.rn)(["mailLabels","selectMailLabel","isSidebarMinimized","vacationResponder","isSplitView","userProfile","isFilteringMails"])),(0,u.Se)(["sidebarMenuWidth","isZmail","isOutlook","isGmail"])),{},{isMinimized:function(e){var t=e.isSidebarMinimized;return t},showBanner:function(e){var t=e.vacationResponder;if(!t.startTime||!t.enableAutoReply)return!1;var i=Number(t.startTime),n=t.endTime?Number(t.endTime):Number.POSITIVE_INFINITY,s=Number(new Date);return t.enableAutoReply&&s>=i&&s<=n}}),watch:{activeKeyBinding:function(e){var t=e.action,i=e.event;if(i&&!(0,ue.LJ)(i))switch(t){case"compose":i.preventDefault(),this.openCompose();break;default:break}}},created:function(){var e=this;this.fetchSliderWidth(),window.zoomSdk.postJsMessage({functionName:"mailui_getvacationresponder",params:{}}).then((function(t){if(0===t.returnCode){var i=JSON.parse(t.result.GetVacationResponder.vacationResponder);e.$store.commit("setVacationResponder",i)}}))},mounted:function(){var e=this;document.addEventListener("keydown",this.holdScroll),this.$once("hook:beforeDestroy",(function(){document.removeEventListener("keydown",e.holdScroll),e.$Bus.$off("selectInboxLabel")})),this.$Bus.$on("selectInboxLabel",(function(){var t=e.mailLabels.find((function(e){return e.id===c.Enums.SystemDefinedMailLabelIds.INBOX}));e.handleSelectLabel(t)}))},methods:{holdScroll:function(e){if(e&&!(0,ue.LJ)(e))if("ArrowUp"===e.key)e.preventDefault(),this.mimicScroll("up");else{if("ArrowDown"!==e.key)return;e.preventDefault(),this.mimicScroll("down")}},mimicScroll:function(e){var t=this.$refs.inboxRef.$refs.recycleScroller.getScroll().start;switch(e){case"up":this.$refs.inboxRef.$refs.recycleScroller.scrollToPosition(t-50);break;case"down":this.$refs.inboxRef.$refs.recycleScroller.scrollToPosition(t+50);break;default:break}},handleTab:function(){this.tabed=!0},closeInboxContextMenu:function(){var e=this.$children.find((function(e){return e.showActions}));e&&(e.showActions=!1,e.selectItem={})},openCompose:function(){this.$Bus.$emit("disableLinkPopoverVisible"),this.$compose()},handleSelectLabel:function(e){var t=this;return(0,o.Z)((0,r.Z)().mark((function i(){var n;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:if(n=t.$store.state.showDetail,t.$store.state.isSplitView||t.$store.commit("changeShowDetail",!1),t.closeInboxContextMenu(),t.selectMailLabel.id!==e.id){i.next=8;break}return t.$nextTick((function(){var e;n||(null===(e=t.$refs.inboxRef.$refs.recycleScroller)||void 0===e||e.scrollToPosition(0))})),i.abrupt("return");case 8:t.$store.commit("setCurSearchHash",""),t.$store.commit("changeInSearchBox",!1),t.$store.commit("changeInFilters",!1),t.$router.push({name:"inbox",params:{id:e["id"].toLowerCase()}},(function(){t.$store.commit("changeSelectMailLabel",e),t.$store.commit("changeSelectPrevLabel",e),t.$store.commit("changeInSearchBox",!1),t.$store.commit("changeInFilters",!1)}));case 13:case"end":return i.stop()}}),i)})))()},fetchSliderWidth:function(){var e=this;d.Setting.getPersistentSetting({key:"CustomSliderWidth"}).then((function(t){if(0===t.errorCode){var i="string"===typeof t.data.value&&JSON.parse(t.data.value).isMinimized;e.$store.commit("changeSidebarMinimized",i)}}))},toggleMinimize:function(e){var t=this;d.Setting.setPersistentSetting({key:"CustomSliderWidth",value:JSON.stringify({isMinimized:!this.isMinimized})}).then((function(e){0===e.errorCode&&t.$store.commit("changeSidebarMinimized",!t.isMinimized)}))},resetInstantDraftsMsgIdByThreadIds:function(e){var t;null===(t=this.$refs.composeContainer)||void 0===t||t.resetInstantDraftsMsgIdByThreadIds(e)}}},la=oa,ca=(0,D.Z)(la,s,a,!1,null,"2a24b35c",null),da=ca.exports},22168:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var n=function(){var e=this,t=e._self._c;return t("div",{ref:"container",staticClass:"mc-drop-zone-container",on:{dragenter:e.$onDragEnter,dragover:e.debouncedDragOver,dragleave:e.$onDragLeave}},[e._t("default"),e.canDrop?t("div",{staticClass:"mc-drop-zone-overlay"},[e._t("mc-drop-zone-place-holder",(function(){return[t("span",{staticClass:"mc-drop-zone-place-holder"},[e._v(e._s(e.$t("editor.dropFilesHere")))])]}))],2):e._e()],2)},s=[],a=i(37761),r=i.n(a),o={name:"DropZone",props:{onDragEnter:{type:Function},onDragOver:{type:Function},onDrop:{type:Function},onLeaveWindow:{type:Function},filesOnly:{type:Boolean,default:!1}},data:function(){return{canDrop:!1,isDraggingLeave:!0,lastEnterElement:null}},watch:{canDrop:{handler:function(e){!e&&this.debouncedCanDrop(),e&&this.$onDragEnter()}}},created:function(){var e=this;this.debouncedDragOver=r().debounce(this.$onDragOver,16),this.debouncedCanDrop=r().debounce(this.$canDrop,100),this.$once("hook:beforeDestroy",(function(){e.debouncedDragOver.cancel(),e.debouncedCanDrop.cancel()}))},mounted:function(){var e=this;window.addEventListener("dragenter",this.$setCanDrop),window.addEventListener("dragover",this.$setCanDrop),window.addEventListener("dragleave",this.$unsetCanDrop),window.addEventListener("mouseout",this.$unsetCanDrop),window.addEventListener("drop",this.$unsetCanDrop),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("dragenter",e.$setCanDrop),window.removeEventListener("dragover",e.$setCanDrop),window.removeEventListener("dragleave",e.$unsetCanDrop),window.removeEventListener("drop",e.$unsetCanDrop),window.removeEventListener("mouseout",e.$unsetCanDrop)}))},methods:{$canDrop:function(){this.onLeaveWindow&&this.onLeaveWindow()},$onDragEnter:function(){if(this.onDragEnter&&this.canDrop){var e=this.$refs.container.getBoundingClientRect();return this.onDragEnter(e)}},$onDragOver:function(){if(this.onDragOver)return this.onDragOver()},$onDragLeave:function(){this.onDragLeave&&this.onDragLeave()},$setCanDrop:function(e){this.lastEnterElement=e.target,e.preventDefault(),this.filesOnly&&!e.dataTransfer.types.includes("Files")||(this.canDrop=!0)},$unsetCanDrop:function(e){e.preventDefault(),this.canDrop&&e.target===this.lastEnterElement&&(this.canDrop=!1)}}},l=o,c=i(93483),d=(0,c.Z)(l,n,s,!1,null,"49f00b24",null),u=d.exports,h=u},66311:function(e,t,i){var n,s,a;i(76716)["default"];i(77950),i(77950),function(i,r){s=[],n=r,a="function"===typeof n?n.apply(t,s):n,void 0===a||(e.exports=a)}(0,(function(){var e=/(auto|scroll)/,t=function e(t,i){return null===t.parentNode?i:e(t.parentNode,i.concat([t]))},i=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},n=function(e){return i(e,"overflow")+i(e,"overflow-y")+i(e,"overflow-x")},s=function(t){return e.test(n(t))},a=function(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var i=t(e.parentNode,[]),n=0;n<i.length;n+=1)if(s(i[n]))return i[n];return document.scrollingElement||document.documentElement}};return a}))},99391:function(e,t,i){"use strict";e.exports=i.p+"static/img/search-files.4487810a.svg"},66813:function(e,t,i){"use strict";e.exports=i.p+"static/img/splash.77bac1b7.svg"}}]);
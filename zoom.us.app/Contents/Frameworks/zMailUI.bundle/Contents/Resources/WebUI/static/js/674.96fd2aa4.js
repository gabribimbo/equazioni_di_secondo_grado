"use strict";(self["webpackChunk_zoom_client_email_desktop"]=self["webpackChunk_zoom_client_email_desktop"]||[]).push([[674],{42674:function(e,i,a){a.r(i),a.d(i,{default:function(){return _}});var n=function(){var e=this,i=e._self._c;return i("div",{staticClass:"email-provider"},[e.loading?i("LoadingScreen"):e._e(),e.loading||e.isFirstLogin?e._e():i("z-landing",{directives:[{name:"customize-language",rawName:"v-customize-language",value:e.customizeWording,expression:"customizeWording"},{name:"async-locale",rawName:"v-async-locale",value:e.asyncLocale,expression:"asyncLocale"}],attrs:{isDarkMode:"dark"===e.prefersColorScheme,loginType:"mail"},on:{agreeTermOfUse:e.agreeAndGetStarted}}),i("z-login",{directives:[{name:"customize-language",rawName:"v-customize-language",value:e.customizeWording,expression:"customizeWording"},{name:"async-locale",rawName:"v-async-locale",value:e.asyncLocale,expression:"asyncLocale"}],ref:"zLogin",attrs:{visible:!e.loading&&!e.isFirstLogin&&e.isUserAgreeTermOfUse,modal:!1,showClose:!1,isDarkMode:"dark"===e.prefersColorScheme,loginType:"mail",isZoomTokenValid:e.isZmailTokenValid,supportSigninTypes:e.supportSigninTypes},on:{selectProvider:e.selectProvider}}),e.loading||!e.isFirstLogin||e.isDelegated?e._e():i("div",{staticClass:"escrow-consent"},[i("escrow-consent",{on:{backToLogin:function(i){return e.$store.commit("auth/setIsFirstLogin",!1)}}})],1),i("zm-dialog",{staticClass:"landing-page-modal",attrs:{width:"490px",visible:!e.loading&&e.showModal,"append-to-body":"","aria-label":e.$t("accessibility.upgradeZoomPro")}},[i("div",{staticClass:"view-plan"},[i("div",{staticClass:"logo",attrs:{"aria-label":e.$t("landing.zoomLogo"),role:"text"}},[i("svg-icon",{attrs:{"aria-hidden":!0,iconClass:"logo"}})],1),i("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("landing.updateToZoomPro"))+" "),i("svg-icon",{staticClass:"license_icon",attrs:{"aria-label":e.$t("landing.licensed"),role:"image",iconClass:"license_icon"}})],1),i("div",{staticClass:"description"},[e._v(" "+e._s(e.upgradeLink?e.$t("landing.youHaveAFreeZoomAccount"):e.$t("landing.askLicense"))+" ")]),e.upgradeLink?i("zm-button",{staticClass:"view-plan__button",attrs:{href:e.upgradeLink,type:"primary"}},[e._v(" "+e._s(e.$t("landing.viewPlans"))+" ")]):e._e(),e.upgradeLink?i("zm-button",{staticClass:"view-plan__button",on:{click:e.handleClose}},[e._v(" "+e._s(e.$t("landing.maybeLater"))+" ")]):e._e(),i("zm-button",{staticClass:"view-plan__button",attrs:{type:"primary"},on:{click:e.handleClose}},[e._v(" "+e._s(e.$t("landing.gotit"))+" ")])],1)])],1)},t=[],s=a(70021),o=a(56706),r=a(34948),l=(a(71372),a(29648)),c=a(63012),d=a(87693),u=a(12546),g=a(61676),m=a(38963),h=a(3346),p=h.Enums.EMAIL_PROVIDER,f=h.Enums.MailOriginalCode,v={name:"EmailProvider",components:{EscrowConsent:g.Z,LoadingScreen:m.Z},data:function(){return{loading:!1,messageInstance:null,showModal:!1,ZLOGIN_PROVIDER:{},loadingTimer:null}},computed:(0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({},(0,l.rn)("auth",["authConfigUrl","clientLanguage","isFirstLogin","isGmailTokenValid","isOffice365TokenValid","isPaidUser","isUserAgreeTermOfUse","isZmailTokenValid","upgradeLink","supportMailTypes","zmailConfigUrl"])),(0,l.rn)(["prefersColorScheme"])),(0,l.rn)({isDelegated:function(e){return e.userProfile.isDelegated}})),{},{asyncLocale:function(){return(0,u.XF)(this.clientLanguage,!0)},customizeWording:function(){return{landing:{clickingAccept:this.$t("landing.clickingAccept2"),here:this.$t("landing.here")}}},supportSigninTypes:function(){var e=[],i=this.supportMailTypes;return i.includes(p.ZMAIL)&&e.push(this.ZLOGIN_PROVIDER.ZOOM),i.includes(p.GMAIL)&&e.push(this.ZLOGIN_PROVIDER.GOOGLE),i.includes(p.OFFICE365)&&e.push(this.ZLOGIN_PROVIDER.OFFICE365),e}}),created:function(){var e,i=this;null!==(e=this.$route.params)&&void 0!==e&&e.reAuth&&(this.loading=!0,this.loadingTimer=setTimeout((function(){i.loading=!1}),5e3))},mounted:function(){var e=this;this.$Bus.$on("ZMailUINotif_OnMailAuthDone",this.authDoneHandler),this.$nextTick((function(){var i,a;e.ZLOGIN_PROVIDER=(null===(i=e.$refs)||void 0===i||null===(a=i.zLogin)||void 0===a?void 0:a.PROVIDER)||{}}))},beforeDestroy:function(){this.loadingTimer&&clearTimeout(this.loadingTimer),this.$Bus.$off("ZMailUINotif_OnMailAuthDone",this.authDoneHandler)},methods:(0,r.Z)((0,r.Z)({},(0,l.OI)("auth",["setZmailTokenValid","setGmailTokenValid","setOffice365TokenValid"])),{},{selectProvider:function(e){var i=this;return(0,o.Z)((0,s.Z)().mark((function a(){var n,t,o,r,l,u,g,m,v,k,C,L,_,O,Z;return(0,s.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=function(e){return h.Utils.getErrMsgWithCode(e.originalCode===f.Network_Connect_Failed?i.$t("common.loginFailedCheckNetwork"):i.$t("common.loginFailed"),e.errorCode?e.error:e,!0)},i.loading){a.next=64;break}t="",a.prev=3,i.loading=!0,null===(o=i.$parent)||void 0===o||null===(r=o.messageInstance)||void 0===r||r.hide(),null===(l=i.messageInstance)||void 0===l||l.hide(),a.t0=e,a.next=a.t0===i.ZLOGIN_PROVIDER.ZOOM?10:a.t0===i.ZLOGIN_PROVIDER.GOOGLE?22:a.t0===i.ZLOGIN_PROVIDER.OFFICE365?35:48;break;case 10:if(!i.isZmailTokenValid){a.next=20;break}return a.next=13,c.Auth.startZmailLogin();case 13:if(m=a.sent,!m.errorCode&&null!==m&&void 0!==m&&null!==(u=m.data)&&void 0!==u&&null!==(g=u.StartZmailLogin)&&void 0!==g&&g.success){a.next=18;break}throw i.setZmailTokenValid(!1),t=n(m),new Error("startZmailLogin not success");case 18:a.next=21;break;case 20:i.isPaidUser?(i.$store.commit("auth/setClickedExtraMail",p.ZMAIL),(0,d.ZC)(i.zmailConfigUrl)):(i.showModal=!0,i.loading=!1);case 21:return a.abrupt("break",51);case 22:if(!i.isGmailTokenValid){a.next=32;break}return a.next=25,c.Auth.startGmailLogin(i.isFromCalendar);case 25:if(C=a.sent,!C.errorCode&&null!==C&&void 0!==C&&null!==(v=C.data)&&void 0!==v&&null!==(k=v.StartGmailLogin)&&void 0!==k&&k.success){a.next=30;break}throw i.setGmailTokenValid(!1),t=n(C),new Error("startGmailLogin not success");case 30:a.next=34;break;case 32:i.$store.commit("auth/setClickedExtraMail",p.GMAIL),(0,d.ZC)(i.authConfigUrl);case 34:return a.abrupt("break",51);case 35:if(!i.isOffice365TokenValid){a.next=45;break}return a.next=38,c.Auth.startOffice365Login(i.isFromCalendar);case 38:if(O=a.sent,!O.errorCode&&null!==O&&void 0!==O&&null!==(L=O.data)&&void 0!==L&&null!==(_=L.LoginOffice365)&&void 0!==_&&_.success){a.next=43;break}throw i.setOffice365TokenValid(!1),t=n(O),new Error("startOutlookLogin not success");case 43:a.next=47;break;case 45:i.$store.commit("auth/setClickedExtraMail",p.OFFICE365),(0,d.ZC)(i.authConfigUrl);case 47:return a.abrupt("break",51);case 48:return i.loading=!1,a.abrupt("break",51);case 51:a.next=59;break;case 53:a.prev=53,a.t1=a["catch"](3),null===(Z=i.messageInstance)||void 0===Z||Z.hide(),i.messageInstance=i.$msg({content:t,duration:0}),i.loading=!1;case 59:return a.prev=59,i.loadingTimer&&clearTimeout(i.loadingTimer),i.loadingTimer=setTimeout((function(){i.loading=!1}),3e4),a.finish(59);case 64:case"end":return a.stop()}}),a,null,[[3,53,59,64]])})))()},agreeAndGetStarted:function(){c.Auth.confirmAgreeTheUserAgreement(),this.$store.commit("auth/setIsUserAgreeTermOfUse",!0)},handleClose:function(){this.showModal=!1},authDoneHandler:function(e){var i,a=null===(i=e.result)||void 0===i?void 0:i.authStatus;"fail"===a&&(this.loading=!1)}})},k=v,C=a(93483),L=(0,C.Z)(k,n,t,!1,null,"3615c68c",null),_=L.exports}}]);